"use strict";var ti=Object.defineProperty,ei=Object.defineProperties,ni=Object.getOwnPropertyDescriptors,Oo=Object.getOwnPropertySymbols,Vo=Object.prototype.hasOwnProperty,Qo=Object.prototype.propertyIsEnumerable,Go=(Gt,yt,a)=>yt in Gt?ti(Gt,yt,{enumerable:!0,configurable:!0,writable:!0,value:a}):Gt[yt]=a,Xt=(Gt,yt)=>{for(var a in yt||(yt={}))Vo.call(yt,a)&&Go(Gt,a,yt[a]);if(Oo)for(var a of Oo(yt))Qo.call(yt,a)&&Go(Gt,a,yt[a]);return Gt},ye=(Gt,yt)=>ei(Gt,ni(yt)),Xo=(Gt,yt)=>{var a={};for(var s in Gt)Vo.call(Gt,s)&&yt.indexOf(s)<0&&(a[s]=Gt[s]);if(null!=Gt&&Oo)for(var s of Oo(Gt))yt.indexOf(s)<0&&Qo.call(Gt,s)&&(a[s]=Gt[s]);return a};(self.webpackChunktui_editor=self.webpackChunktui_editor||[]).push([[7841],{49294:(Gt,yt,a)=>{a.d(yt,{$:()=>Y});var s=a(64762),c=a(74788),$=a(91211),I=a(2330),_=a(85648),j=a(44358),F=a(79012),nt=a(74331);class Y{constructor(et){this.sanitizer=et,this.colorChange=new c.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color(et){if(this.currentColor.every((st,Q)=>st===et[Q])&&et[3]===this.opacity)return;const[pt,Ot,ft]=(0,I.bD)(et[0],et[1],et[2]);this.opacity=et[3],this.hue=pt/360,this.point=[Ot,1-ft/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,I.qZ)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange(et){this.point=et,this.updateColor()}onHueChange(et){this.hue=et,this.updateColor()}onOpacityChange(et){this.opacity=(0,_.FG)(et,2),this.updateColor()}getCurrentColor(et,pt){return(0,I.qZ)(360*et,pt[0],255*(1-pt[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}Y.\u0275fac=function(et){return new(et||Y)(c.Y36($.H7))},Y.\u0275cmp=c.Xpm({type:Y,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function(et,pt){1&et&&(c.TgZ(0,"tui-flat-picker",0),c.NdJ("valueChange",function(ft){return pt.onPointChange(ft)}),c.qZA(),c.TgZ(1,"div",1),c.TgZ(2,"tui-linear-picker",2),c.NdJ("valueChange",function(ft){return pt.onHueChange(ft)}),c.qZA(),c.qZA(),c.TgZ(3,"div",3),c.TgZ(4,"tui-linear-picker",4),c.NdJ("valueChange",function(ft){return pt.onOpacityChange(ft)}),c.qZA(),c.qZA()),2&et&&(c.Udp("background-color",pt.base),c.Q6J("value",pt.point),c.xp6(2),c.Q6J("value",pt.hue),c.xp6(1),c.Udp("background",pt.gradient),c.xp6(1),c.Q6J("value",pt.opacity))},directives:[F.J,nt.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,s.gn)([j.UM],Y.prototype,"getCurrentColor",null)},44691:(Gt,yt,a)=>{a.d(yt,{s:()=>fe});var s=a(64762),c=a(74788),$=a(91211),I=a(11927),_=a(2330),j=a(44358),F=a(71831),nt=a(88320),Y=a(23917),q=a(12628),et=a(54789),pt=a(75111),Ot=a(90022),ft=a(95974),st=a(12057),Q=a(49294),W=a(7176),tt=a(74337),ut=a(28858),ot=a(75093),xt=a(79588),bt=a(98952),lt=a(52697),Rt=a(24751),Yt=a(45642);function Zt(ee,Wt){if(1&ee&&(c.TgZ(0,"button",7),c._uU(1),c.qZA()),2&ee){const Nt=Wt.$implicit;c.Q6J("value",Nt),c.xp6(1),c.hij(" ",Nt," ")}}function Ht(ee,Wt){if(1&ee&&(c.TgZ(0,"tui-data-list",5),c.YNc(1,Zt,2,2,"button",6),c.qZA()),2&ee){const Nt=c.oxw();c.xp6(1),c.Q6J("ngForOf",Nt.modes)}}function At(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"tui-primitive-textfield",8),c.NdJ("valueChange",function(kt){return c.CHM(Nt),c.oxw().onHexChange(kt)}),c.qZA()}if(2&ee){const Nt=c.oxw();c.Q6J("maskito",Nt.hexMask)("tuiTextfieldLabelOutside",!0)("value",Nt.hex)}}function Et(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"tui-input-count",9),c.NdJ("ngModelChange",function(kt){c.CHM(Nt);const jt=c.oxw();return jt.onRgbChange(kt,jt.color[1],jt.color[2],jt.color[3])}),c.qZA(),c.TgZ(1,"tui-input-count",9),c.NdJ("ngModelChange",function(kt){c.CHM(Nt);const jt=c.oxw();return jt.onRgbChange(jt.color[0],kt,jt.color[2],jt.color[3])}),c.qZA(),c.TgZ(2,"tui-input-count",9),c.NdJ("ngModelChange",function(kt){c.CHM(Nt);const jt=c.oxw();return jt.onRgbChange(jt.color[0],jt.color[1],kt,jt.color[3])}),c.qZA()}if(2&ee){const Nt=c.oxw();c.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[0]),c.xp6(1),c.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[1]),c.xp6(1),c.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[2])}}let P=(()=>{class ee{constructor(){this.color=[0,0,0,1],this.colorChange=new c.vpe,this.hexMask={mask:new RegExp("^[A-F\\d]{0,6}$","gi")},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,_.WS)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(Nt){if(6!==Nt.length)return;const qt=(0,_.RO)(Nt);this.updateColor([qt[0],qt[1],qt[2],this.color[3]])}onRgbChange(...Nt){this.updateColor(Nt)}updateColor(Nt){this.color=Nt,this.colorChange.emit(Nt)}}return ee.\u0275fac=function(Nt){return new(Nt||ee)},ee.\u0275cmp=c.Xpm({type:ee,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],["size","s",4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"maskito","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["tuiTextfieldPostfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","s"],["tuiOption","",3,"value",4,"ngFor","ngForOf"],["tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"maskito","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(Nt,qt){if(1&Nt&&(c.TgZ(0,"tui-select",0),c.NdJ("ngModelChange",function(jt){return qt.mode=jt}),c.YNc(1,Ht,2,1,"tui-data-list",1),c.qZA(),c.YNc(2,At,1,3,"tui-primitive-textfield",2),c.YNc(3,Et,3,12,"ng-template",null,3,c.W1O),c.TgZ(5,"tui-input-count",4),c.NdJ("ngModelChange",function(jt){return qt.onRgbChange(qt.color[0],qt.color[1],qt.color[2],jt/100)}),c.qZA()),2&Nt){const kt=c.MAs(4);c.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",qt.mode),c.xp6(2),c.Q6J("ngIf",qt.isHex)("ngIfElse",kt),c.xp6(3),c.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",qt.opacity)}},directives:[tt.uJ,tt.OI,xt.sz,bt.Ek,xt.xT,Rt.JJ,Rt.On,pt.gX,st.O5,ut.EA,ut.aQ,xt.Tq,pt.qi,st.sg,pt.vK,lt.yc,lt.B1,ot.n,Yt.ro],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),ee})();var H=a(59113);function K(ee,Wt){if(1&ee&&c._UZ(0,"tui-svg",9),2&ee){c.oxw();const Nt=c.MAs(1);c.ekj("t-arrow_rotated",Nt.open)}}function Mt(ee,Wt){1&ee&&c._UZ(0,"tui-svg",14)}function Pt(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"button",12),c.NdJ("keydown.enter.prevent",function(){const jt=c.CHM(Nt).$implicit,re=c.oxw(2),ae=c.MAs(1);return re.onModeSelect(jt,ae)})("keydown.space.prevent",function(){const jt=c.CHM(Nt).$implicit,re=c.oxw(2),ae=c.MAs(1);return re.onModeSelect(jt,ae)})("click",function(){const jt=c.CHM(Nt).$implicit,re=c.oxw(2),ae=c.MAs(1);return re.onModeSelect(jt,ae)}),c._uU(1),c.YNc(2,Mt,1,0,"tui-svg",13),c.qZA()}if(2&ee){const Nt=Wt.$implicit,qt=c.oxw(2);c.uIk("aria-checked",qt.isModeActive(Nt)),c.xp6(1),c.hij(" ",Nt," "),c.xp6(1),c.Q6J("ngIf",qt.isModeActive(Nt))}}function Kt(ee,Wt){if(1&ee&&(c.TgZ(0,"tui-data-list",10),c.YNc(1,Pt,3,3,"button",11),c.qZA()),2&ee){const Nt=c.oxw();c.xp6(1),c.Q6J("ngForOf",Nt.modes)}}function oe(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"button",20),c.NdJ("click",function(){const jt=c.CHM(Nt).$implicit;return c.oxw(2).onDirectionChange(jt)}),c.qZA()}if(2&ee){const Nt=Wt.$implicit,qt=c.oxw(2);c.ekj("t-direction_active",qt.isDirectionActive(Nt)),c.Q6J("icon",qt.getIcon(Nt))("tuiHint",Nt)}}function Jt(ee,Wt){if(1&ee){const Nt=c.EpF();c.ynx(0),c._UZ(1,"hr",15),c.TgZ(2,"div",16),c.TgZ(3,"tui-linear-multi-picker",17),c.NdJ("valueChange",function(kt){return c.CHM(Nt),c.oxw().onStopsChange(kt)})("indexChange",function(kt){return c.CHM(Nt),c.oxw().onIndexChange(kt)}),c.qZA(),c.qZA(),c.TgZ(4,"div",18),c.YNc(5,oe,1,4,"button",19),c.qZA(),c.BQk()}if(2&ee){const Nt=c.oxw();c.xp6(2),c.Udp("background",Nt.gradient),c.xp6(1),c.Q6J("value",Nt.stopsKeys),c.xp6(2),c.Q6J("ngForOf",Nt.buttons)}}function se(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"tui-color-edit",21),c.NdJ("colorChange",function(kt){return c.CHM(Nt),c.oxw().onColorChange(kt)}),c.qZA()}if(2&ee){const Nt=c.oxw();c.Q6J("color",Nt.color)}}function rt(ee,Wt){if(1&ee){const Nt=c.EpF();c.TgZ(0,"tui-palette",22),c.NdJ("selectedColor",function(kt){return c.CHM(Nt),c.oxw().onPalettePick(kt)}),c.qZA()}if(2&ee){const Nt=c.oxw();c.Q6J("colors",Nt.palette)}}const It=[0,0,0,0],Ut=[[0,[0,0,0,1]],[1,[255,255,255,1]]],me={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class fe{constructor(Wt,Nt){this.sanitizer=Wt,this.modes=Nt,this.stops=new Map(Ut),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new c.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(Wt){this.parse(Wt)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(Wt){return me[Wt]}isModeActive(Wt){return this.currentMode===Wt}isDirectionActive(Wt){return this.direction===Wt}onPalettePick(Wt){this.updateColor(Wt)}onDirectionChange(Wt){this.direction=Wt,this.updateColor(this.getGradient(Wt))}onModeSelect(Wt,Nt){this.currentMode=Wt,Nt.open=!1,this.updateColor(Wt===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(Wt){this.currentStop=this.stopsKeys[Wt]}onColorChange(Wt){this.isGradient?(this.stops.set(this.currentStop,Wt),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${Wt.join(", ")})`)}onStopsChange(Wt){const Nt=this.stopsKeys.find(kt=>!Wt.includes(kt)),qt=Wt.find(kt=>!this.stopsKeys.includes(kt));void 0===Nt&&void 0!==qt&&this.addStop(qt),void 0!==Nt&&void 0===qt&&this.removeStop(Nt),void 0!==Nt&&void 0!==qt&&this.replaceStop(Nt,qt),this.updateColor(this.getGradient(this.direction))}getStopsKeys(Wt){return Array.from(Wt.keys())}filterPalette(Wt,Nt){const qt=new Map(Wt);return qt.forEach((kt,jt)=>{(kt.startsWith("linear-gradient")&&!Nt||!kt.startsWith("linear-gradient")&&Nt)&&qt.delete(jt)}),qt}updateColor(Wt){this.colorChange.emit(Wt)}getGradient(Wt){return`linear-gradient(${Wt}, ${[...this.stopsKeys].sort(I.A2).map(Nt=>`rgba(${this.getStop(Nt).join(", ")}) ${100*Nt}%`).join(", ")})`}getStop(Wt){return this.stops.get(Wt)||It}addStop(Wt){const Nt=this.stopsKeys.reduce((qt,kt)=>Math.abs(kt-Wt)<Math.abs(qt-Wt)?kt:qt,this.stopsKeys[0]);this.stops.set(Wt,this.getStop(Nt)),this.stops=new Map(this.stops),this.currentStop=Wt}removeStop(Wt){this.stops.delete(Wt),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(Wt,Nt){const qt=this.getStop(Wt);this.currentStop=Nt,this.stops=new Map(this.stopsKeys.map(kt=>kt===Wt?[Nt,qt]:[kt,this.getStop(kt)]))}parse(Wt){Wt.startsWith("linear-gradient")?this.parseGradient(Wt):this.parseColor(Wt)}parseGradient(Wt){if(Wt===this.getGradient(this.direction))return;const Nt=(0,nt._N)((0,nt.U5)(Wt));this.currentMode=this.modes[1],this.direction=Nt.side,this.currentStop=0,this.stops=new Map(Nt.stops.length?Nt.stops.map(({color:qt,position:kt})=>[parseFloat(kt)/100,(0,_.Mp)(qt)]):Ut)}parseColor(Wt){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,_.Mp)(Wt)}}fe.\u0275fac=function(Wt){return new(Wt||fe)(c.Y36($.H7),c.Y36(F.dj))},fe.\u0275cmp=c.Xpm({type:fe,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu","size","s",1,"t-menu"],["tuiOption","","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","tuiHintDescribe","","class","t-direction",3,"t-direction_active","icon","tuiHint","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","","tuiHintDescribe","",1,"t-direction",3,"icon","tuiHint","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(Wt,Nt){if(1&Wt&&(c.TgZ(0,"tui-hosted-dropdown",0,1),c.TgZ(2,"button",2),c._uU(3),c.qZA(),c.YNc(4,K,1,2,"ng-template",null,3,c.W1O),c.YNc(6,Kt,2,1,"ng-template",null,4,c.W1O),c.qZA(),c.YNc(8,Jt,6,4,"ng-container",5),c.TgZ(9,"tui-color-picker",6),c.NdJ("colorChange",function(kt){return Nt.onColorChange(kt)}),c.qZA(),c.YNc(10,se,1,1,"tui-color-edit",7),c.YNc(11,rt,1,1,"tui-palette",8)),2&Wt){const qt=c.MAs(5),kt=c.MAs(7);c.Q6J("content",kt),c.xp6(2),c.Q6J("iconRight",qt),c.xp6(1),c.hij(" ",Nt.currentMode," "),c.xp6(5),c.Q6J("ngIf",Nt.isGradient),c.xp6(1),c.Q6J("color",Nt.currentColor),c.xp6(1),c.Q6J("ngIf",!Nt.isGradient),c.xp6(1),c.Q6J("ngIf",Nt.palette.size)}},directives:[Y.o1,q.v0,st.O5,Q.$,et.PN,pt.qi,st.sg,pt.vK,W.e,Ot.$o,Ot.D,Ot.xn,Ot.t6,Ot.DM,P,ft.gZ,H.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:22.6rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,s.gn)([j.UM],fe.prototype,"getStopsKeys",null),(0,s.gn)([j.UM],fe.prototype,"filterPalette",null)},79012:(Gt,yt,a)=>{a.d(yt,{J:()=>I});var s=a(74788),c=a(27103),$=a(20755);let I=(()=>{class _{constructor(F){this.value=[0,0],this.valueChange=new s.vpe,F.subscribe(nt=>{this.value=nt,this.valueChange.emit([nt[0],nt[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}return _.\u0275fac=function(F){return new(F||_)(s.Y36($.i))},_.\u0275cmp=s.Xpm({type:_,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([c.a3,$.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(F,nt){1&F&&s._UZ(0,"div",0),2&F&&s.Udp("left",nt.left,"%")("top",nt.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),_})()},96472:(Gt,yt,a)=>{a.d(yt,{H9:()=>j,wl:()=>Zt,VM:()=>Yt}),a(49294);var c=a(12057),$=a(74788);let I=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez]]}),X})(),_=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez]]}),X})(),j=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez,I,_]]}),X})();a(44691);var nt=a(221),Y=a(12628),q=a(23917),et=a(90022),pt=a(54789),Ot=a(75111),ft=a(95974),st=a(24751),Q=a(45642),W=a(52697),tt=a(79588),ut=a(98952),ot=a(75093),xt=a(74337),bt=a(28858);let lt=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez,st.u5,Q.U5,ot.S,xt.Jy,W.KW,tt.cn,ut.dp,bt.$H,Ot.pc]]}),X})(),Rt=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez]]}),X})(),Yt=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez,et.go]]}),X})(),Zt=(()=>{class X{}return X.\u0275fac=function(H){return new(H||X)},X.\u0275mod=$.oAB({type:X}),X.\u0275inj=$.cJS({imports:[[c.ez,Y.fN,q.jh,j,Rt,et.go,pt.EI,Ot.pc,nt.A,lt,ft.n6,Yt]]}),X})();a(79012),a(7176),a(74331)},7176:(Gt,yt,a)=>{a.d(yt,{e:()=>j});var s=a(74788),c=a(27103),$=a(20755),I=a(12057);function _(F,nt){if(1&F){const Y=s.EpF();s.TgZ(0,"div",1),s.NdJ("mousedown",function(){const pt=s.CHM(Y).index;return s.oxw().onMouseDown(pt)})("dblclick",function(){const pt=s.CHM(Y).index;return s.oxw().onClick(pt)}),s.qZA()}2&F&&s.Udp("left",100*nt.$implicit,"%")}let j=(()=>{class F{constructor(Y){this.value=[0,1],this.valueChange=new s.vpe,this.indexChange=new s.vpe,this.index=NaN,Y.subscribe(([q])=>{this.onPicker(q)})}onMouseUp(){this.index=NaN}onMouseDown(Y){this.updateIndex(Y)}onClick(Y){this.value.length>2&&this.updateValue(this.value.filter((q,et)=>et!==Y))}onPicker(Y){Number.isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((q,et)=>q===Y&&et!==this.index)&&this.updateValue(this.value.map((q,et)=>et===this.index?Y:q))}updateIndex(Y){this.index=Y,this.indexChange.emit(Y)}updateValue(Y){this.value=Y,this.valueChange.emit(Y)}}return F.\u0275fac=function(Y){return new(Y||F)(s.Y36($.i))},F.\u0275cmp=s.Xpm({type:F,selectors:[["tui-linear-multi-picker"]],hostBindings:function(Y,q){1&Y&&s.NdJ("mouseup",function(){return q.onMouseUp()},!1,s.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[s._Bn([c.a3,$.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function(Y,q){1&Y&&s.YNc(0,_,1,2,"div",0),2&Y&&s.Q6J("ngForOf",q.value)},directives:[I.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),F})()},74331:(Gt,yt,a)=>{a.d(yt,{P:()=>I});var s=a(74788),c=a(27103),$=a(20755);let I=(()=>{class _{constructor(F){this.value=0,this.valueChange=new s.vpe,F.subscribe(([nt])=>{this.value=nt,this.valueChange.emit(nt)})}get left(){return 100*this.value}}return _.\u0275fac=function(F){return new(F||_)(s.Y36($.i))},_.\u0275cmp=s.Xpm({type:_,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([c.a3,$.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(F,nt){1&F&&s._UZ(0,"div",0),2&F&&s.Udp("left",nt.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),_})()},59113:(Gt,yt,a)=>{a.d(yt,{R:()=>_});var s=a(74788),c=a(12057),$=a(90022);function I(j,F){if(1&j){const nt=s.EpF();s.TgZ(0,"button",1),s.NdJ("click",function(){const et=s.CHM(nt).$implicit;return s.oxw().selectedColor.emit(et.value)}),s.qZA()}if(2&j){const nt=F.$implicit;s.Udp("background",nt.value),s.Q6J("tuiHint",nt.key)("tuiHintDescribe",nt.key)("id",nt.key)}}let _=(()=>{class j{constructor(){this.colors=new Map,this.selectedColor=new s.vpe,this.originalOrder=(nt,Y)=>0}}return j.\u0275fac=function(nt){return new(nt||j)},j.\u0275cmp=s.Xpm({type:j,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:4,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(nt,Y){1&nt&&(s.YNc(0,I,1,5,"button",0),s.ALo(1,"keyvalue")),2&nt&&s.Q6J("ngForOf",s.xi3(1,1,Y.colors,Y.originalOrder))},directives:[c.sg,$.D,$.xn,$.t6,$.DM,$.$o],pipes:[c.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),j})()},41039:(Gt,yt,a)=>{a.d(yt,{l:()=>Zt});var s=a(12057),c=a(74788),$=a(64493),I=a(18892),_=a(86114),j=a(71831),F=a(68838),nt=a(92815),Y=a(37801),q=a(24751),et=a(54789),pt=a(12628),Ot=a(82847),ft=a(80134),st=a(79550);let Q=(()=>{class Ht{transform(Et,X,P){return"#"===X?Et.filter(H=>H!==P):Et}}return Ht.\u0275fac=function(Et){return new(Et||Ht)},Ht.\u0275pipe=c.Yjl({name:"tuiFilterAnchors",type:Ht,pure:!0}),Ht})();function W(Ht,At){1&Ht&&(c.ynx(0),c._uU(1," Edit anchor "),c.BQk())}function tt(Ht,At){1&Ht&&(c.TgZ(0,"span"),c._uU(1," Link to anchor "),c.qZA())}function ut(Ht,At){1&Ht&&(c.TgZ(0,"span"),c._uU(1,"URL"),c.qZA())}function ot(Ht,At){if(1&Ht&&(c.YNc(0,tt,2,0,"span",1),c.YNc(1,ut,2,0,"ng-template",null,12,c.W1O)),2&Ht){const Et=c.MAs(2),X=c.oxw(2);c.Q6J("ngIf",X.prefixIsHashMode)("ngIfElse",Et)}}function xt(Ht,At){if(1&Ht&&(c.ynx(0),c._uU(1),c.BQk()),2&Ht){const Et=At.ngIf,X=c.oxw(2);c.xp6(1),c.hij(" ",X.prefixIsHashMode?Et.anchorExample:Et.urlExample," ")}}function bt(Ht,At){if(1&Ht){const Et=c.EpF();c.ynx(0),c.TgZ(1,"label",4),c.TgZ(2,"div",5),c.YNc(3,W,2,0,"ng-container",1),c.YNc(4,ot,3,2,"ng-template",null,6,c.W1O),c.qZA(),c.TgZ(6,"div",7),c.TgZ(7,"div",8),c._uU(8),c.qZA(),c.TgZ(9,"tui-input-inline",9),c.NdJ("ngModelChange",function(P){return c.CHM(Et),c.oxw().url=P})("input",function(P){let K;return c.CHM(Et),c.oxw().onChange(null==(K=P.target)?null:K.value)})("keydown.prevent.enter",function(){return c.CHM(Et),c.oxw().onSave()})("keydown.backspace",function(){return c.CHM(Et),c.oxw().onBackspace()}),c.YNc(10,xt,2,1,"ng-container",3),c.ALo(11,"async"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(12,"tui-svg",10),c.NdJ("click",function(){return c.CHM(Et),c.oxw().onClear()}),c.qZA(),c.TgZ(13,"button",11),c.NdJ("click",function(){return c.CHM(Et),c.oxw().onSave()}),c.qZA(),c.BQk()}if(2&Ht){const Et=c.MAs(5),X=c.oxw();c.xp6(3),c.Q6J("ngIf",X.anchorMode)("ngIfElse",Et),c.xp6(5),c.Oqu(X.prefix),c.xp6(1),c.ekj("t-input_filled",X.hasUrl),c.Q6J("ngModel",X.url),c.xp6(1),c.Q6J("ngIf",c.lcZ(11,9,X.texts$)),c.xp6(2),c.ekj("t-cleaner_hidden",!X.hasUrl)}}function lt(Ht,At){if(1&Ht){const Et=c.EpF();c.TgZ(0,"a",13),c._uU(1),c.ALo(2,"tuiShortUrl"),c.qZA(),c.TgZ(3,"button",14),c.NdJ("click",function(){return c.CHM(Et),c.oxw().onEdit()}),c.qZA(),c.TgZ(4,"button",15),c.NdJ("click",function(){return c.CHM(Et),c.oxw().onRemove()}),c.qZA()}if(2&Ht){const Et=c.oxw();c.Q6J("href",Et.href,c.LSH)("icon",Et.prefixIsHashMode?"tuiIconHash":"tuiIconExternalLink"),c.xp6(1),c.hij(" ",c.lcZ(2,3,Et.url)," ")}}function Rt(Ht,At){if(1&Ht){const Et=c.EpF();c.TgZ(0,"button",19),c.NdJ("click",function(){const H=c.CHM(Et).$implicit;return c.oxw(2).setAnchor(H)}),c._uU(1),c.qZA()}if(2&Ht){const Et=At.$implicit;c.xp6(1),c.hij(" #",Et," ")}}function Yt(Ht,At){if(1&Ht&&(c.ynx(0),c._UZ(1,"hr",16),c.TgZ(2,"tui-scrollbar"),c.TgZ(3,"div",17),c.YNc(4,Rt,2,1,"button",18),c.ALo(5,"tuiFilterAnchors"),c.qZA(),c.qZA(),c.BQk()),2&Ht){const Et=c.oxw();c.xp6(4),c.Q6J("ngForOf",c.Dn7(5,1,Et.anchorIds,Et.prefix,Et.url))}}let Zt=(()=>{class Ht{constructor(Et,X,P,H){this.doc=Et,this.texts$=X,this.editor=P,this.options=H,this.isOnlyAnchorMode=this.detectAnchorMode(),this.addLink=new c.vpe,this.removeLink=new c.vpe,this.url=this.getHrefOrAnchorId(),this.edit=!this.url,this.prefix=this.makeDefaultPrefix(),this.anchorIds=this.getAllAnchorsIds()}get defaultProtocol(){var Et,X;return null!==(X=null===(Et=this.options.linkOptions)||void 0===Et?void 0:Et.protocol)&&void 0!==X?X:I.Ci}set anchorMode(Et){this.isOnlyAnchorMode=Et,this.prefix=Et?I._s:this.makeDefaultPrefix()}get anchorMode(){return this.isOnlyAnchorMode}get prefixIsHashMode(){return this.prefix===I._s}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get showAnchorsList(){return!this.anchorMode&&this.edit&&this.anchorIds.length>0}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.getHrefOrAnchorId(),this.anchorMode=this.detectAnchorMode())}onMouseDown(Et){(0,$.ve)(Et.target)&&!Et.target.matches("a, button, input")&&Et.preventDefault()}setAnchor(Et){this.url=Et,this.changePrefix(!0)}changePrefix(Et){this.prefix=Et?I._s:this.defaultProtocol}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix=this.isOnlyAnchorMode?I._s:this.defaultProtocol)}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(Et){this.url=this.removePrefix(Et)}onClear(){this.url=""}makeDefaultPrefix(){var Et,X;const P=this.getAnchorElement(),H=(0,F.$)(null!==(Et=null==P?void 0:P.getAttribute("href"))&&void 0!==Et?Et:"").prefix||this.defaultProtocol;return P&&(!P.getAttribute("href")&&P.getAttribute("id")||(null===(X=P.getAttribute("href"))||void 0===X?void 0:X.startsWith(I._s)))?I._s:H}detectAnchorMode(){const Et=this.getAnchorElement();return!(null==Et?void 0:Et.href)&&!!(null==Et?void 0:Et.getAttribute("id"))}getFocusedParentElement(){var Et,X;return(null===(X=null===(Et=this.doc.getSelection())||void 0===Et?void 0:Et.focusNode)||void 0===X?void 0:X.parentElement)||null}getAnchorElement(){var Et,X,P;const H=this.getFocusedParentElement();return null!==(P=null!==(Et=null==H?void 0:H.closest("a"))&&void 0!==Et?Et:null===(X=null==H?void 0:H.querySelector("img"))||void 0===X?void 0:X.closest("a"))&&void 0!==P?P:null}getHrefOrAnchorId(){const Et=this.getAnchorElement();return Et?this.removePrefix(Et.getAttribute("href")||Et.getAttribute("id")||""):this.url}removePrefix(Et){var X;const P=Et.startsWith(I._s)||this.prefix===I._s?Et:`${null!==(X=this.prefix)&&void 0!==X?X:""}${Et}`,{prefix:H,path:K}=(0,F.$)(P);return this.prefix=this.isOnlyAnchorMode||H===I._s||""===H&&this.prefix===I._s?I._s:""===H?this.defaultProtocol:H,K}getAllAnchorsIds(){var Et;const X=Array.from(null!==(Et=this.editor.getOriginTiptapEditor().view.dom.querySelectorAll('[data-type="jump-anchor"]'))&&void 0!==Et?Et:[]);return Array.from(X).map(P=>P.getAttribute("id")||"").filter(Boolean)}}return Ht.\u0275fac=function(Et){return new(Et||Ht)(c.Y36(s.K0),c.Y36(j.b$),c.Y36(_.$3),c.Y36(j.mJ))},Ht.\u0275cmp=c.Xpm({type:Ht,selectors:[["tui-edit-link"]],hostBindings:function(Et,X){1&Et&&c.NdJ("selectionchange",function(){return X.onSelectionChange()},!1,c.evT)("mousedown",function(H){return X.onMouseDown(H)})},inputs:{anchorMode:"anchorMode"},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:5,vars:3,consts:[[1,"t-edit-link"],[4,"ngIf","ngIfElse"],["view",""],[4,"ngIf"],[1,"t-label"],[1,"t-label-properties"],["fullOptions",""],[1,"t-url"],[1,"t-prefix"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","input","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["urlTitle",""],["tuiLink","","target","_blank","iconAlign","left",1,"t-link",3,"href","icon"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEdit2Large","shape","rounded","appearance","icon",1,"t-button","t-edit-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconUnlinkLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],[1,"t-hr"],[1,"t-anchor-list"],["type","button","class","t-anchor",3,"click",4,"ngFor","ngForOf"],["type","button",1,"t-anchor",3,"click"]],template:function(Et,X){if(1&Et&&(c.TgZ(0,"div",0),c.YNc(1,bt,14,11,"ng-container",1),c.YNc(2,lt,5,5,"ng-template",null,2,c.W1O),c.qZA(),c.YNc(4,Yt,6,5,"ng-container",3)),2&Et){const P=c.MAs(3);c.xp6(1),c.Q6J("ngIf",X.edit)("ngIfElse",P),c.xp6(3),c.Q6J("ngIf",X.showAnchorsList)}},directives:[s.O5,nt.l,Y.k,q.JJ,q.On,et.PN,pt.v0,Ot.V,ft.IB,s.sg],pipes:[s.Ov,st.X,Q],styles:["[_nghost-%COMP%]{display:block;min-width:18.75rem}.t-edit-link[_ngcontent-%COMP%]{display:flex;min-height:4rem;align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem;width:100%}.t-label-properties[_ngcontent-%COMP%]{display:flex;align-items:center;max-width:8.375rem;justify-content:space-between}.t-property_inactive[_ngcontent-%COMP%]{opacity:.5}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-edit-button[_ngcontent-%COMP%]{margin-left:auto}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer;margin-left:auto}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}.t-anchor-list[_ngcontent-%COMP%]{display:flex;max-height:12.5rem;flex-direction:column}.t-anchor[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;background:none;font-size:inherit;line-height:inherit;min-height:2.75rem;padding:.375rem .5rem;margin:.125rem .5rem;border-radius:var(--tui-radius-m);text-align:left}.t-anchor[_ngcontent-%COMP%]:hover{background:var(--tui-base-02);cursor:pointer}"],changeDetection:0}),Ht})()},8674:(Gt,yt,a)=>{a.d(yt,{Fu:()=>pt}),a(41039);var c=a(12057),$=a(24751),I=a(37801),_=a(12628),j=a(54789),F=a(82847),nt=a(80134),Y=a(92815),q=a(25470),et=a(74788);let pt=(()=>{class st{}return st.\u0275fac=function(W){return new(W||st)},st.\u0275mod=et.oAB({type:st}),st.\u0275inj=et.cJS({imports:[[c.ez,$.u5,I.Q7,_.fN,j.EI,F.j,Y.z,q.YM,nt.Jy]]}),st})();a(79550),a(68838)},79550:(Gt,yt,a)=>{a.d(yt,{X:()=>_});var s=a(74788);let _=(()=>{class j{transform(nt){return nt.length<60?nt:`${nt.slice(0,Math.max(0,40))}...${nt.slice(nt.length-10)}`}}return j.\u0275fac=function(nt){return new(nt||j)},j.\u0275pipe=s.Yjl({name:"tuiShortUrl",type:j,pure:!0}),j})()},68838:(Gt,yt,a)=>{a.d(yt,{$:()=>$});var s=a(11927),c=a(18892);function $(j=""){if(j.startsWith(c._s))return{prefix:c._s,path:j.slice(1)};const[F="",nt=""]=j.includes(c.jU)?I(j):_(j);if(nt.includes(c.DN)){const[Y,q]=_(nt);if(Y&&q)return{prefix:Y,path:q}}return{prefix:F,path:""===F?j:nt}}function I(j=""){var F;const nt=null!==(F=j.indexOf(c.jU))&&void 0!==F?F:-1,[Y,q]=nt>-1?[j.slice(0,nt+c.jU.length),j.slice(nt+c.jU.length,j.length)]:["",j],et=[Y,q].filter(Boolean);return(null==q?void 0:q.includes("://"))&&et.length>1?I(q):et}function _(j=""){const[F,nt]=j.split(/:/).slice(-2).filter(Boolean);return F&&nt&&!(0,s.lj)(j)?[`${F}:`,nt]:[]}},33703:(Gt,yt,a)=>{a.d(yt,{_:()=>F});var s=a(66749),c=a(87187),$=a(66682),I=a(46782),_=a(74788),j=a(27103);let F=(()=>{class nt extends c.d{constructor(q,et){super(),this.doc=q,this.destroy$=et,this._height=0,this._width=0,(0,$.T)((0,s.mL)(q,"touchend"),(0,s.mL)(q,"mouseup")).pipe((0,I.R)(et)).subscribe(()=>this.updateAttributes({width:this.width,height:this.height}))}get attrs(){var q;return(null===(q=this.node)||void 0===q?void 0:q.attrs)||{src:""}}get width(){return this._width||this.attrs.width||null}get height(){return this._height||this.attrs.height||null}}return nt.\u0275fac=function(q){return new(q||nt)(_.Y36(Document),_.Y36(j.a3))},nt.\u0275dir=_.lG2({type:nt,features:[_.qOj]}),nt})()},61732:(Gt,yt,a)=>{a.d(yt,{V:()=>et});var s=a(74788),c=a(11927),$=a(75675),I=a(46732),_=a(12057);const j=function(){return[0,1]};function F(pt,Ot){if(1&pt){const ft=s.EpF();s.TgZ(0,"div",4),s.NdJ("tuiSizeChange",function(Q){return s.CHM(ft),s.oxw().sizeChange.emit(Q)}),s.qZA()}2&pt&&s.Q6J("tuiResizer",s.DdM(1,j))}const nt=function(pt){return[pt,0]},Y=function(){return[1,0]},q=["*"];let et=(()=>{class pt{constructor(){this.autoHeight=!1,this.width=null,this.height=null,this.sizeChange=new s.vpe}get hostWidth(){return(0,c.dt)(this.width)?(0,$.O)(this.width):this.width}get hostHeight(){return this.autoHeight?null:(0,c.dt)(this.height)?(0,$.O)(this.height):this.height}}return pt.\u0275fac=function(ft){return new(ft||pt)},pt.\u0275cmp=s.Xpm({type:pt,selectors:[["tui-editor-resizable"]],hostVars:4,hostBindings:function(ft,st){2&ft&&s.Udp("width",st.hostWidth)("height",st.hostHeight)},inputs:{autoHeight:"autoHeight",width:"width",height:"height"},outputs:{sizeChange:"sizeChange"},ngContentSelectors:q,decls:5,vars:8,consts:[["tuiResizeable","",1,"t-resizable"],[1,"t-handle","t-handle-left-side",3,"tuiResizer","tuiSizeChange"],["class","t-handle t-handle-bottom-side",3,"tuiResizer","tuiSizeChange",4,"ngIf"],[1,"t-handle","t-handle-right-side",3,"tuiResizer","tuiSizeChange"],[1,"t-handle","t-handle-bottom-side",3,"tuiResizer","tuiSizeChange"]],template:function(ft,st){1&ft&&(s.F$t(),s.TgZ(0,"div",0),s.Hsn(1),s.TgZ(2,"div",1),s.NdJ("tuiSizeChange",function(W){return st.sizeChange.emit(W)}),s.qZA(),s.YNc(3,F,1,2,"div",2),s.TgZ(4,"div",3),s.NdJ("tuiSizeChange",function(W){return st.sizeChange.emit(W)}),s.qZA(),s.qZA()),2&ft&&(s.ekj("t-resizable-auto-height",st.autoHeight),s.xp6(2),s.Q6J("tuiResizer",s.VKq(5,nt,-1)),s.xp6(1),s.Q6J("ngIf",!st.autoHeight),s.xp6(1),s.Q6J("tuiResizer",s.DdM(7,Y)))},directives:[I.U_,I.L$,_.O5],styles:['[_nghost-%COMP%]{position:relative;display:inline-block;box-sizing:border-box}[_nghost-%COMP%]   .t-resizable[_ngcontent-%COMP%]{box-sizing:border-box}[_nghost-%COMP%]   .t-resizable-auto-height[_ngcontent-%COMP%]{height:auto!important}[_nghost-%COMP%]   iframe[_ngcontent-%COMP%]{display:inline;pointer-events:none}[_nghost-%COMP%]:hover   .t-handle[_ngcontent-%COMP%]:after{opacity:1}.t-handle[_ngcontent-%COMP%]{position:absolute;top:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center;height:100%}.t-handle[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}.t-handle-left-side[_ngcontent-%COMP%]{left:0}.t-handle-bottom-side[_ngcontent-%COMP%]{top:unset;bottom:.3125rem;height:.95rem;width:100%}.t-handle-right-side[_ngcontent-%COMP%]{right:0}'],changeDetection:0}),pt})()},36807:(Gt,yt,a)=>{a.d(yt,{S:()=>_});var s=a(12057),c=a(5962),$=a(46732),I=a(74788);let _=(()=>{class j{}return j.\u0275fac=function(nt){return new(nt||j)},j.\u0275mod=I.oAB({type:j}),j.\u0275inj=I.cJS({imports:[[s.ez,c.k,$.gj]]}),j})()},96152:(Gt,yt,a)=>{a.d(yt,{D:()=>j});var s=a(12057),c=a(74788),$=a(64493),I=a(79456),_=a(79698);let j=(()=>{class F{constructor(Y,q,et,pt,Ot,ft){this.el=Y,this.renderer=q,this.sanitizer=et,this.tuiSanitizer=pt,this.document=Ot,this.editor=ft}set content(Y){this.renderer.setProperty(this.el.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(c.q3G.HTML,Y.replace(/colwidth/g,"width")):this.sanitizer.sanitize(c.q3G.HTML,Y))}click(Y){var q,et;if(this.editor||!(0,$.ve)(Y.target))return;const pt=(null===(et=null===(q=Y.target)||void 0===q?void 0:q.closest("a"))||void 0===et?void 0:et.getAttribute("href"))||"";!pt.startsWith("#")||(this.document.location.hash=pt.replace("#",""),Y.preventDefault())}}return F.\u0275fac=function(Y){return new(Y||F)(c.Y36(c.SBq),c.Y36(c.Qsj),c.Y36(c.Tiy),c.Y36(I.hm,8),c.Y36(s.K0),c.Y36(_.JU,8))},F.\u0275cmp=c.Xpm({type:F,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],hostBindings:function(Y,q){1&Y&&c.NdJ("click",function(pt){return q.click(pt)})},inputs:{content:"content"},decls:0,vars:0,template:function(Y,q){},styles:['.tui-editor-socket{display:block;margin:0;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket[tuiTiptapEditor]{overflow:hidden}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:.2rem 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket h1:first-child,.tui-editor-socket h2:first-child,.tui-editor-socket p:last-child{margin-bottom:0}.tui-editor-socket p:last-child,.tui-editor-socket pre:last-child{margin-bottom:0}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket p>span{line-height:normal;line-height:initial}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket mark{background:unset;color:inherit}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket a:not([data-type="jump-anchor"]){color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:not([data-type="jump-anchor"]):hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:not([data-type="jump-anchor"]):active{color:var(--tui-primary-active)}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]{text-decoration:underline;-webkit-text-decoration-color:var(--tui-link);text-decoration-color:var(--tui-link)}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]:before{content:"#"}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]:hover{color:var(--tui-link)}.tui-editor-socket .ProseMirror a:hover img[contenteditable=false]{cursor:pointer;outline:.25rem solid var(--tui-link)}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li>p{display:inline;margin:0 auto;word-break:break-word}.tui-editor-socket ul li>p{display:block}.tui-editor-socket li:before{unicode-bidi:-webkit-isolate;unicode-bidi:isolate;font-feature-settings:"tnum";font-variant-numeric:tabular-nums;text-transform:none;text-indent:0;text-align:start;text-align-last:start}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box;float:left}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:item}.tui-editor-socket ol>li:before{content:counters(item,".") ".";display:block;margin:0 .75rem 0 -1.5rem;counter-increment:item;color:var(--tui-base-05);vertical-align:top;float:left;white-space:nowrap}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket .ProseMirror video,.tui-editor-socket .ProseMirror audio{pointer-events:none}.tui-editor-socket img.ProseMirror-selectednode{outline:.25rem solid var(--tui-primary-hover)}.tui-editor-socket .t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .tableWrapper,.tui-editor-socket .tui-table-wrapper{overflow-x:auto}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none;outline:none}.tui-editor-socket summary:focus-visible{outline:2px solid var(--tui-link)}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket .details-arrow,.tui-editor-socket .t-details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer;outline:none}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket div[data-type=details-content] h1:first-child,.tui-editor-socket div[data-type=details-content] h2:first-child,.tui-editor-socket div[data-type=details-content] pre:first-child,.tui-editor-socket div[data-type=details-content] ul:first-child,.tui-editor-socket div[data-type=details-content] ol:first-child,.tui-editor-socket div[data-type=details-content] ol li:first-child,.tui-editor-socket div[data-type=details-content] ul li:first-child{margin-top:0}.tui-editor-socket .details-wrapper,.tui-editor-socket .t-details-wrapper{margin-bottom:.5rem;position:relative;display:flex}.tui-editor-socket .details-wrapper_rendered .details-arrow,.tui-editor-socket .t-details-wrapper_rendered .details-arrow,.tui-editor-socket .details-wrapper_rendered .t-details-arrow,.tui-editor-socket .t-details-wrapper_rendered .t-details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary,.tui-editor-socket .t-details-wrapper_rendered summary{transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover,.tui-editor-socket .t-details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow,.tui-editor-socket details[open]+.t-details-arrow{top:1.75rem;transform:rotate(225deg)}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket .tui-group-node{display:flex;flex-direction:row}.tui-editor-socket .tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-editor-socket .tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}.tui-editor-socket [data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),F})()},10215:(Gt,yt,a)=>{a.d(yt,{a:()=>oe});var s=a(12057),c=a(74788),$=a(24751),I=a(76480),_=a(33770),j=a(99434),F=a(37801),nt=a(79456),Y=a(51618),q=a(18892),et=a(86114),pt=a(71831),Ot=a(88320),ft=a(87874),st=a(46782),Q=a(46015),W=a(91489),tt=a(80134),ut=a(98952),ot=a(221),xt=a(22580),bt=a(75122),lt=a(43631),Rt=a(22648);let Yt=(()=>{class Jt extends lt.O4{constructor(rt){super(),this.el=rt,this.type="viewport"}getClientRect(){return this.el.nativeElement.getBoundingClientRect()}}return Jt.\u0275fac=function(rt){return new(rt||Jt)(c.Y36(c.SBq))},Jt.\u0275dir=c.lG2({type:Jt,selectors:[["","tuiEditorPortal",""]],features:[c._Bn([{provide:bt.ae,useExisting:Rt.Y},(0,nt.ck)(Jt)]),c.qOj]}),Jt})();var Zt=a(96152),Ht=a(87429);let At=(()=>{class Jt extends I.Er{}return Jt.\u0275fac=function(){let se;return function(It){return(se||(se=c.n5z(Jt)))(It||Jt)}}(),Jt.\u0275cmp=c.Xpm({type:Jt,selectors:[["tui-editor-portal-host"]],features:[c._Bn([{provide:I.N9,useExisting:bt.ae},{provide:I.Er,useExisting:Jt}]),c.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(rt,It){1&rt&&c.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),Jt})();var Et=a(41039);function X(Jt,se){if(1&Jt){const rt=c.EpF();c.TgZ(0,"tui-toolbar",7),c.NdJ("fileAttached",function(Ut){return c.CHM(rt),c.oxw(2).fileAttached.emit(Ut)}),c.Hsn(1,1),c.qZA()}if(2&Jt){const rt=c.oxw(2);c.Q6J("tools",rt.tools)("disabled",!rt.interactive)}}function P(Jt,se){if(1&Jt&&(c.TgZ(0,"div",8),c._uU(1),c.qZA()),2&Jt){const rt=c.oxw(2);c.xp6(1),c.hij(" ",rt.exampleText," ")}}function H(Jt,se){if(1&Jt){const rt=c.EpF();c.TgZ(0,"tui-edit-link",13,14),c.NdJ("addLink",function(Ut){c.CHM(rt);const me=c.MAs(1),fe=c.oxw(3);return me.anchorMode?fe.addAnchor(Ut):fe.addLink(Ut)})("removeLink",function(){c.CHM(rt);const Ut=c.MAs(1),me=c.oxw(3);return Ut.anchorMode?me.removeAnchor():me.removeLink()}),c.qZA()}}function K(Jt,se){if(1&Jt){const rt=c.EpF();c.TgZ(0,"tui-scrollbar",9),c.NdJ("mousedown",function(Ut){return c.CHM(rt),c.oxw(2).focus(Ut)}),c.TgZ(1,"div",10),c.TgZ(2,"tui-editor-socket",11),c.NdJ("valueChange",function(Ut){return c.CHM(rt),c.oxw(2).onModelChange(Ut)})("stateChange",function(){return 0}),c.qZA(),c.qZA(),c.YNc(3,H,2,0,"ng-template",null,12,c.W1O),c._UZ(5,"tui-editor-portal-host"),c.qZA()}if(2&Jt){const rt=c.MAs(4),It=c.oxw(2);c.xp6(1),c.Q6J("tuiDropdownSelection",It.dropdownSelectionHandler)("tuiDropdown",rt),c.xp6(1),c.Q6J("value",It.value)("editable",It.interactive)}}function Mt(Jt,se){if(1&Jt){const rt=c.EpF();c.TgZ(0,"div",1),c.NdJ("tuiActiveZoneChange",function(Ut){return c.CHM(rt),c.oxw().onActiveZone(Ut)}),c.TgZ(1,"div",2),c.YNc(2,X,2,2,"tui-toolbar",3),c.TgZ(3,"div",4),c.Hsn(4),c.qZA(),c.YNc(5,P,2,1,"div",5),c.qZA(),c.YNc(6,K,6,4,"tui-scrollbar",6),c.qZA()}if(2&Jt){const rt=se.ngIf,It=c.oxw();c.Q6J("readOnly",It.readOnly)("disabled",It.disabled)("focus",It.computedFocused)("hover",It.pseudoHover)("invalid",It.computedInvalid),c.xp6(2),c.Q6J("ngIf",rt),c.xp6(1),c.ekj("t-placeholder_raised",It.placeholderRaised),c.xp6(2),c.Q6J("ngIf",It.hasExampleText),c.xp6(1),c.Q6J("ngIf",rt)}}const Pt=["*",[["tools"]]],Kt=["*","tools"];let oe=(()=>{class Jt extends I.M${constructor(rt,It,Ut,me,fe,ee,Wt,Nt){super(rt,It,Wt),this.editorLoaded$=Ut,this.editorService=me,this.contentProcessor=fe,this.doc=ee,this.options=Nt,this.exampleText="",this.tools=q.Db,this.fileAttached=new c.vpe,this.focused=!1,this.isSelectionLink=qt=>this.currentFocusedNodeIsTextAnchor(qt)||this.currentFocusedNodeIsImageAnchor,this.editorLoaded$.pipe((0,ft.g)(0),(0,st.R)(this.destroy$)).subscribe(()=>this.patchContentEditableElement())}get nativeFocusableElement(){var rt,It;return this.computedDisabled?null:(null===(It=null===(rt=this.el)||void 0===rt?void 0:rt.nativeElement)||void 0===It?void 0:It.querySelector("[contenteditable].ProseMirror"))||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:_.Iy}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(rt){var It;if(rt===this.value)return;const Ut=this.contentProcessor(rt||"");super.writeValue(Ut),Ut!==rt&&(null===(It=this.control)||void 0===It||It.setValue(Ut,{onlySelf:!1,emitEvent:!1,emitModelToViewChange:!1,emitViewToModelChange:!1}))}onActiveZone(rt){var It;this.focused=rt,this.updateFocused(rt),null===(It=this.control)||void 0===It||It.updateValueAndValidity()}onModelChange(rt){this.value=rt}addAnchor(rt){var It;null===(It=this.editor)||void 0===It||It.setAnchor(rt)}removeAnchor(){var rt;null===(rt=this.editor)||void 0===rt||rt.removeAnchor()}addLink(rt){var It,Ut;null===(It=this.editor)||void 0===It||It.selectClosest(),null===(Ut=this.editor)||void 0===Ut||Ut.setLink(rt)}removeLink(){var rt;null===(rt=this.editor)||void 0===rt||rt.unsetLink()}focus(rt){var It,Ut;(null===(It=this.nativeFocusableElement)||void 0===It?void 0:It.contains(rt.target))||(rt.preventDefault(),null===(Ut=this.nativeFocusableElement)||void 0===Ut||Ut.focus())}ngOnDestroy(){var rt;null===(rt=this.editor)||void 0===rt||rt.destroy()}getFallbackValue(){return""}currentFocusedNodeIsTextAnchor(rt){var It,Ut;return!!(null===(Ut=null===(It=rt.startContainer.parentElement)||void 0===It?void 0:It.closest("a"))||void 0===Ut?void 0:Ut.contains(this.focusNode))&&(0,Ot.nC)(rt)}get focusNode(){var rt,It;return null!==(It=null===(rt=this.doc.getSelection())||void 0===rt?void 0:rt.focusNode)&&void 0!==It?It:null}get hasValue(){return!!this.value}get currentFocusedNodeIsImageAnchor(){var rt,It,Ut;return"A"===(null===(rt=this.focusNode)||void 0===rt?void 0:rt.nodeName)&&["IMG","TUI-IMAGE-EDITOR"].includes(null===(Ut=null===(It=this.focusNode)||void 0===It?void 0:It.childNodes[0])||void 0===Ut?void 0:Ut.nodeName)}patchContentEditableElement(){var rt,It;null===(rt=this.nativeFocusableElement)||void 0===rt||rt.setAttribute("translate",this.options.translate),null===(It=this.nativeFocusableElement)||void 0===It||It.setAttribute("spellcheck",String(this.options.spellcheck))}}return Jt.\u0275fac=function(rt){return new(rt||Jt)(c.Y36($.a5,10),c.Y36(c.sBO),c.Y36(pt.ZW),c.Y36(et.$3),c.Y36(pt.F1),c.Y36(s.K0),c.Y36(pt.bK,8),c.Y36(pt.mJ))},Jt.\u0275cmp=c.Xpm({type:Jt,selectors:[["tui-editor"]],viewQuery:function(rt,It){if(1&rt&&(c.Gf(et.JU,5,c.SBq),c.Gf(Y.M6,5)),2&rt){let Ut;c.iGM(Ut=c.CRH())&&(It.el=Ut.first),c.iGM(Ut=c.CRH())&&(It.toolbar=Ut.first)}},inputs:{exampleText:"exampleText",tools:"tools"},outputs:{fileAttached:"fileAttached"},features:[c._Bn([(0,j.FT)(Jt),(0,F.f$)({delay:nt.Gc}),Q.m]),c.qOj],ngContentSelectors:Kt,decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"ngIf"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled","fileAttached",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","","class","t-scrollbar",3,"mousedown",4,"ngIf"],[3,"tools","disabled","fileAttached"],[1,"t-example-text"],["tuiEditorPortal","",1,"t-scrollbar",3,"mousedown"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],["dropdown",""],[3,"addLink","removeLink"],["link",""]],template:function(rt,It){1&rt&&(c.F$t(Pt),c.YNc(0,Mt,7,10,"div",0),c.ALo(1,"async")),2&rt&&c.Q6J("ngIf",c.lcZ(1,1,It.editorLoaded$))},directives:[s.O5,W.o,ot.e,xt.M,tt.IB,Yt,ut.Ek,ut.td,ut.VC,ut.A9,ut.yd,Zt.D,Ht.J,At,Et.l],pipes:[s.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m);max-height:inherit;min-height:10rem;box-sizing:border-box}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:inherit;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font:var(--tui-font-text-s);color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);margin:1rem 1rem -1rem;min-height:1.625rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);line-height:1.25rem;transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}._invalid[_nghost-%COMP%]:not(._focused)   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font:var(--tui-font-text-m);line-height:1.25rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}._focused[_nghost-%COMP%]   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   [tuiWrapper][data-mode=onDark][_ngcontent-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-placeholder[_ngcontent-%COMP%]:empty{min-height:.8rem}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;border-bottom:.3125rem solid transparent;padding-bottom:1.3125rem;box-sizing:border-box;flex:1}"],changeDetection:0}),Jt})()},46015:(Gt,yt,a)=>{a.d(yt,{m:()=>q});var s=a(74788),c=a(86114),$=a(71831),I=a(74235),_=a(9112),j=a(15257),F=a(88002),nt=a(47349),Y=a(22648);const q=[{provide:$.F4,deps:[$.Wf],useFactory:et=>{const pt=new I.t(1);return Promise.all(et).then(Ot=>pt.next(Ot)),pt}},{provide:$.Y1,deps:[s.Qsj],useFactory:et=>et.createElement("div")},{provide:$.ZW,deps:[$.Y1,$.F4,$.bG],useFactory:(et,pt,Ot)=>(0,_.aj)([Ot,pt]).pipe((0,j.q)(1),(0,F.U)(([ft,st])=>new ft({element:et,extensions:st})),(0,nt.d)({bufferSize:1,refCount:!0}))},c.$3,Y.Y]},22648:(Gt,yt,a)=>{a.d(yt,{Y:()=>$});var s=a(76480),c=a(74788);let $=(()=>{class I extends s.N9{}return I.\u0275fac=function(){let _;return function(F){return(_||(_=c.n5z(I)))(F||I)}}(),I.\u0275prov=c.Yz7({token:I,factory:I.\u0275fac}),I})()},20719:(Gt,yt,a)=>{a.d(yt,{X:()=>ft});var s=a(86114),c=a(71831),$=a(9112),I=a(88002),_=a(74788),j=a(12057),F=a(92668),nt=a(23917),Y=a(12628),q=a(90022);function et(st,Q){if(1&st){const W=_.EpF();_.TgZ(0,"div",6),_.TgZ(1,"button",7),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.onAlign("left")}),_.qZA(),_.TgZ(2,"button",8),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.onAlign("center")}),_.qZA(),_.TgZ(3,"button",9),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.onAlign("right")}),_.qZA(),_.TgZ(4,"button",10),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.onAlign("justify")}),_.qZA(),_.qZA()}if(2&st){const W=_.oxw().tuiLet,tt=_.oxw().ngIf;_.xp6(1),_.Q6J("pseudoActive",!(null==W||!W.left))("tuiHint",tt.justifyLeft),_.xp6(1),_.Q6J("pseudoActive",!(null==W||!W.center))("tuiHint",tt.justifyCenter),_.xp6(1),_.Q6J("pseudoActive",!(null==W||!W.right))("tuiHint",tt.justifyRight),_.xp6(1),_.Q6J("pseudoActive",!(null==W||!W.justify))("tuiHint",tt.justifyFull)}}function pt(st,Q){if(1&st&&(_.TgZ(0,"tui-hosted-dropdown",2,3),_._UZ(2,"button",4),_.YNc(3,et,5,8,"ng-template",null,5,_.W1O),_.qZA()),2&st){const W=_.MAs(1),tt=_.MAs(4),ut=_.oxw().ngIf;_.Q6J("content",tt),_.xp6(2),_.Q6J("tuiHint",ut.justify)("pseudoActive",W.open)("focusable",W.open)}}function Ot(st,Q){if(1&st&&(_.ynx(0),_.YNc(1,pt,5,4,"tui-hosted-dropdown",1),_.ALo(2,"async"),_.BQk()),2&st){const W=_.oxw();_.xp6(1),_.Q6J("tuiLet",_.lcZ(2,1,W.alignState$))}}let ft=(()=>{class st{constructor(W,tt){this.editor=W,this.texts$=tt,this.alignState$=(0,$.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,I.U)(([ut,ot,xt,bt])=>({left:ut,right:ot,center:xt,justify:bt})))}}return st.\u0275fac=function(W){return new(W||st)(_.Y36(s.$3),_.Y36(c.rf))},st.\u0275cmp=_.Xpm({type:st,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(W,tt){1&W&&(_.YNc(0,Ot,3,3,"ng-container",0),_.ALo(1,"async")),2&W&&_.Q6J("ngIf",_.lcZ(1,1,tt.texts$))},directives:[j.O5,F.Ls,nt.o1,Y.v0,q.$o,q.D,q.xn,q.t6,q.DM],pipes:[j.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),st})()},57289:(Gt,yt,a)=>{a.d(yt,{T:()=>Ot});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(23917),F=a(12628),nt=a(90022),Y=a(75111),q=a(12057);function et(ft,st){if(1&ft){const Q=_.EpF();_.TgZ(0,"button",5),_.NdJ("click",function(){const ut=_.CHM(Q).index;return _.oxw(2).onCode(!!ut)}),_._uU(1),_.qZA()}if(2&ft){const Q=st.$implicit;_.xp6(1),_.hij(" ",Q," ")}}function pt(ft,st){if(1&ft&&(_.TgZ(0,"tui-data-list"),_.YNc(1,et,2,1,"button",4),_.ALo(2,"async"),_.qZA()),2&ft){const Q=_.oxw();_.xp6(1),_.Q6J("ngForOf",_.lcZ(2,1,Q.codeOptionsTexts$))}}let Ot=(()=>{class ft{constructor(Q,W,tt){this.editor=Q,this.texts$=W,this.codeOptionsTexts$=tt,this.hintText$=this.texts$.pipe((0,$.U)(ut=>ut.code)),this.insideCode$=this.editor.stateChange$.pipe((0,$.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,I.x)())}onCode(Q){Q?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return ft.\u0275fac=function(Q){return new(Q||ft)(_.Y36(s.$3),_.Y36(c.rf),_.Y36(c.Mr))},ft.\u0275cmp=_.Xpm({type:ft,selectors:[["tui-code"]],decls:7,vars:8,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(Q,W){if(1&Q&&(_.TgZ(0,"tui-hosted-dropdown",0,1),_._UZ(2,"button",2),_.ALo(3,"async"),_.ALo(4,"async"),_.YNc(5,pt,3,3,"ng-template",null,3,_.W1O),_.qZA()),2&Q){const tt=_.MAs(1),ut=_.MAs(6);_.Q6J("content",ut),_.xp6(2),_.Q6J("tuiHint",_.lcZ(3,4,W.hintText$))("pseudoActive",tt.open||_.lcZ(4,6,W.insideCode$))("focusable",tt.open)}},directives:[j.o1,F.v0,nt.$o,nt.D,nt.xn,nt.t6,nt.DM,Y.qi,q.sg,Y.vK],pipes:[q.Ov],encapsulation:2,changeDetection:0}),ft})()},49382:(Gt,yt,a)=>{a.d(yt,{U:()=>q});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(12057),F=a(12628),nt=a(90022);function Y(et,pt){if(1&et){const Ot=_.EpF();_.TgZ(0,"button",1),_.NdJ("click",function(){return _.CHM(Ot),_.oxw().removeDetails()}),_.ALo(1,"async"),_.qZA()}if(2&et){const Ot=pt.ngIf,ft=_.oxw();_.Q6J("tuiHint",Ot.removeDetails)("focusable",!1)("disabled",!!_.lcZ(1,3,ft.disabled$))}}let q=(()=>{class et{constructor(Ot,ft){this.editor=Ot,this.texts$=ft,this.disabled$=this.editor.stateChange$.pipe((0,$.U)(()=>!this.editor.isActive("details")),(0,I.x)())}removeDetails(){this.editor.removeDetails()}}return et.\u0275fac=function(Ot){return new(Ot||et)(_.Y36(s.$3),_.Y36(c.rf))},et.\u0275cmp=_.Xpm({type:et,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable","disabled","click"]],template:function(Ot,ft){1&Ot&&(_.YNc(0,Y,2,5,"button",0),_.ALo(1,"async")),2&Ot&&_.Q6J("ngIf",_.lcZ(1,1,ft.texts$))},directives:[j.O5,F.v0,nt.$o,nt.D,nt.xn,nt.t6,nt.DM],pipes:[j.Ov],encapsulation:2,changeDetection:0}),et})()},18885:(Gt,yt,a)=>{a.d(yt,{y:()=>nt});var s=a(86114),c=a(71831),$=a(74788),I=a(12057),_=a(12628),j=a(90022);function F(Y,q){if(1&Y){const et=$.EpF();$.TgZ(0,"button",1),$.NdJ("click",function(){return $.CHM(et),$.oxw().setDetails()}),$.qZA()}2&Y&&$.Q6J("tuiHint",q.ngIf.setDetails)("focusable",!1)}let nt=(()=>{class Y{constructor(et,pt){this.editor=et,this.texts$=pt}setDetails(){this.editor.setDetails()}}return Y.\u0275fac=function(et){return new(et||Y)($.Y36(s.$3),$.Y36(c.rf))},Y.\u0275cmp=$.Xpm({type:Y,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable","click"]],template:function(et,pt){1&et&&($.YNc(0,F,1,2,"button",0),$.ALo(1,"async")),2&et&&$.Q6J("ngIf",$.lcZ(1,1,pt.texts$))},directives:[I.O5,_.v0,j.$o,j.D,j.xn,j.t6,j.DM],pipes:[I.Ov],encapsulation:2,changeDetection:0}),Y})()},73688:(Gt,yt,a)=>{a.d(yt,{m:()=>st}),a(18939);var c=a(75675),$=a(86114),I=a(71831),_=a(88002),j=a(74788),F=a(23917),nt=a(12628),Y=a(90022),q=a(75111),et=a(12057);const pt=function(){return{}};function Ot(Q,W){if(1&Q){const tt=j.EpF();j.TgZ(0,"button",5),j.NdJ("click",function(){const xt=j.CHM(tt).$implicit;return j.oxw(2).setFontOption(xt)}),j.ALo(1,"lowercase"),j._uU(2),j.qZA()}if(2&Q){const tt=W.$implicit;j.Udp("font-family",tt.family)("font-size",tt.px,"px")("font-weight",tt.weight),j.Q6J("ngClass",(null==tt?null:tt.ngClass)||j.DdM(12,pt))("ngStyle",(null==tt?null:tt.ngStyle)||j.DdM(13,pt)),j.uIk("automation-id","tui_font__"+j.lcZ(1,10,tt.name||"")),j.xp6(2),j.hij(" ",tt.name," ")}}function ft(Q,W){if(1&Q&&(j.TgZ(0,"tui-data-list"),j.YNc(1,Ot,3,14,"button",4),j.ALo(2,"async"),j.qZA()),2&Q){const tt=j.oxw();j.xp6(1),j.Q6J("ngForOf",j.lcZ(2,1,tt.fontsOptions$))}}let st=(()=>{class Q{constructor(tt,ut,ot,xt){this.options=tt,this.editor=ut,this.texts$=ot,this.fontOptionsTexts$=xt,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,_.U)(bt=>this.options.fontOptions(bt))),this.fontText$=this.texts$.pipe((0,_.U)(bt=>bt.font))}onClick({headingLevel:tt,px:ut}){this.setFontOption({headingLevel:tt,px:ut})}setFontOption({headingLevel:tt,px:ut}){this.clearPreviousTextStyles(),tt?this.editor.setHeading(tt):this.editor.setParagraph({fontSize:(0,c.O)(ut||0)})}clearPreviousTextStyles(){this.editor.removeEmptyTextStyle(),this.editor.toggleMark("textStyle")}}return Q.\u0275fac=function(tt){return new(tt||Q)(j.Y36(I.mJ),j.Y36($.$3),j.Y36(I.rf),j.Y36(I.UN))},Q.\u0275cmp=j.Xpm({type:Q,selectors:[["tui-font-size"]],decls:6,vars:6,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","ngClass","ngStyle","click",4,"ngFor","ngForOf"],["tuiOption","",3,"ngClass","ngStyle","click"]],template:function(tt,ut){if(1&tt&&(j.TgZ(0,"tui-hosted-dropdown",0,1),j._UZ(2,"button",2),j.ALo(3,"async"),j.YNc(4,ft,3,3,"ng-template",null,3,j.W1O),j.qZA()),2&tt){const ot=j.MAs(1),xt=j.MAs(5);j.Q6J("content",xt),j.xp6(2),j.Q6J("tuiHint",j.lcZ(3,4,ut.fontText$))("pseudoActive",ot.open)("focusable",ot.open)}},directives:[F.o1,nt.v0,Y.$o,Y.D,Y.xn,Y.t6,Y.DM,q.qi,et.sg,q.vK,et.mk,et.PC],pipes:[et.Ov,et.i8],encapsulation:2,changeDetection:0}),Q})()},81618:(Gt,yt,a)=>{a.d(yt,{h:()=>ut});var s=a(18892),c=a(86114),$=a(95161),I=a(71831),_=a(9112),j=a(88002),F=a(74788),nt=a(12057),Y=a(23917),q=a(12628),et=a(90022);function pt(ot,xt){if(1&ot){const bt=F.EpF();F.TgZ(0,"button",11),F.NdJ("click",function(){return F.CHM(bt),F.oxw(4).editor.toggleBold()}),F.qZA()}if(2&ot){const bt=F.oxw(2).ngIf,lt=F.oxw().ngIf;F.Q6J("tuiHint",lt.bold)("pseudoActive",bt.bold)}}function Ot(ot,xt){if(1&ot){const bt=F.EpF();F.TgZ(0,"button",12),F.NdJ("click",function(){return F.CHM(bt),F.oxw(4).editor.toggleItalic()}),F.qZA()}if(2&ot){const bt=F.oxw(2).ngIf,lt=F.oxw().ngIf;F.Q6J("tuiHint",lt.italic)("pseudoActive",bt.italic)}}function ft(ot,xt){if(1&ot){const bt=F.EpF();F.TgZ(0,"button",13),F.NdJ("click",function(){return F.CHM(bt),F.oxw(4).editor.toggleUnderline()}),F.qZA()}if(2&ot){const bt=F.oxw(2).ngIf,lt=F.oxw().ngIf;F.Q6J("tuiHint",lt.underline)("pseudoActive",bt.underline)}}function st(ot,xt){if(1&ot){const bt=F.EpF();F.TgZ(0,"button",14),F.NdJ("click",function(){return F.CHM(bt),F.oxw(4).editor.toggleStrike()}),F.qZA()}if(2&ot){const bt=F.oxw(2).ngIf,lt=F.oxw().ngIf;F.Q6J("tuiHint",lt.strikeThrough)("pseudoActive",bt.strike)}}function Q(ot,xt){if(1&ot&&(F.TgZ(0,"div",6),F.YNc(1,pt,1,2,"button",7),F.YNc(2,Ot,1,2,"button",8),F.YNc(3,ft,1,2,"button",9),F.YNc(4,st,1,2,"button",10),F.qZA()),2&ot){const bt=F.oxw(3);F.xp6(1),F.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Bold)),F.xp6(1),F.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Italic)),F.xp6(1),F.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Underline)),F.xp6(1),F.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Strikethrough))}}function W(ot,xt){if(1&ot&&(F.TgZ(0,"tui-hosted-dropdown",2,3),F._UZ(2,"button",4),F.YNc(3,Q,5,4,"ng-template",null,5,F.W1O),F.qZA()),2&ot){const bt=xt.ngIf,lt=F.MAs(1),Rt=F.MAs(4),Yt=F.oxw().ngIf;F.Q6J("content",Rt),F.xp6(2),F.Q6J("tuiHint",Yt.fontStyle)("pseudoActive",lt.open||bt.bold||bt.italic||bt.underline||bt.strike)("focusable",lt.open)}}function tt(ot,xt){if(1&ot&&(F.ynx(0),F.YNc(1,W,5,4,"tui-hosted-dropdown",1),F.ALo(2,"async"),F.BQk()),2&ot){const bt=F.oxw();F.xp6(1),F.Q6J("ngIf",F.lcZ(2,1,bt.fontStyleState$))}}let ut=(()=>{class ot{constructor(bt,lt){this.editor=bt,this.texts$=lt,this.toolsSet=new Set(s.Db),this.TuiEditorTool=$._,this.fontStyleState$=(0,_.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,j.U)(([Rt,Yt,Zt,Ht])=>({bold:Rt,italic:Yt,underline:Zt,strike:Ht})))}set enabledTools(bt){this.toolsSet=new Set(bt)}isEnabled(bt){return this.toolsSet.has(bt)}}return ot.\u0275fac=function(bt){return new(bt||ot)(F.Y36(c.$3),F.Y36(I.rf))},ot.\u0275cmp=F.Xpm({type:ot,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(bt,lt){1&bt&&(F.YNc(0,tt,3,3,"ng-container",0),F.ALo(1,"async")),2&bt&&F.Q6J("ngIf",F.lcZ(1,1,lt.texts$))},directives:[nt.O5,Y.o1,q.v0,et.$o,et.D,et.xn,et.t6,et.DM],pipes:[nt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),ot})()},52187:(Gt,yt,a)=>{a.d(yt,{d:()=>Y});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(12628),F=a(90022),nt=a(12057);let Y=(()=>{class q{constructor(pt,Ot){this.editor=pt,this.texts$=Ot,this.insertGroupText$=this.texts$.pipe((0,$.U)(ft=>ft.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,$.U)(ft=>ft.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,$.U)(()=>!this.editor.isActive("group")),(0,I.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return q.\u0275fac=function(pt){return new(pt||q)(_.Y36(s.$3),_.Y36(c.rf))},q.\u0275cmp=_.Xpm({type:q,selectors:[["tui-editor-group-tool"]],decls:5,vars:11,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon","tuiHintDescribe","",3,"focusable","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconCloseLarge","appearance","icon","tuiHintDescribe","",3,"focusable","disabled","tuiHint","click"]],template:function(pt,Ot){1&pt&&(_.TgZ(0,"button",0),_.NdJ("click",function(){return Ot.addGroup()}),_.ALo(1,"async"),_.qZA(),_.TgZ(2,"button",1),_.NdJ("click",function(){return Ot.removeGroup()}),_.ALo(3,"async"),_.ALo(4,"async"),_.qZA()),2&pt&&(_.Q6J("focusable",!1)("tuiHint",_.lcZ(1,5,Ot.insertGroupText$)),_.xp6(2),_.Q6J("focusable",!1)("disabled",!!_.lcZ(3,7,Ot.disabled$))("tuiHint",_.lcZ(4,9,Ot.removeGroupText$)))},directives:[j.v0,F.$o,F.D,F.xn,F.t6,F.DM],pipes:[nt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),q})()},73545:(Gt,yt,a)=>{a.d(yt,{U:()=>W});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(92668),F=a(221),nt=a(23917),Y=a(98952),q=a(12628),et=a(90022),pt=a(12057),Ot=a(59113);function ft(tt,ut){if(1&tt&&_._UZ(0,"div",6),2&tt){const ot=_.oxw().tuiLet;_.Udp("background",ot)}}function st(tt,ut){if(1&tt){const ot=_.EpF();_.TgZ(0,"tui-palette",7),_.NdJ("selectedColor",function(bt){return _.CHM(ot),_.oxw(2).editor.setBackgroundColor(bt)}),_.qZA()}if(2&tt){const ot=ut.$implicit,xt=_.oxw(2);_.Q6J("tuiActiveZoneParent",ot)("colors",xt.colors)}}function Q(tt,ut){if(1&tt&&(_.TgZ(0,"tui-hosted-dropdown",1,2),_._UZ(2,"button",3),_.ALo(3,"async"),_.YNc(4,ft,1,2,"div",4),_.YNc(5,st,1,2,"ng-template",null,5,_.W1O),_.qZA()),2&tt){const ot=ut.tuiLet,xt=_.MAs(1),bt=_.MAs(6),lt=_.oxw();_.Q6J("content",bt)("tuiDropdownMaxHeight",999),_.xp6(2),_.Q6J("tuiHint",_.lcZ(3,6,lt.backColorText$))("pseudoActive",xt.open)("focusable",xt.open),_.xp6(2),_.Q6J("ngIf",!lt.isBlankColor(ot||""))}}let W=(()=>{class tt{constructor(ot,xt,bt){this.editor=ot,this.texts$=xt,this.defaultOptions=bt,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,$.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,I.x)()),this.backColorText$=this.texts$.pipe((0,$.U)(lt=>lt.backColor))}isBlankColor(ot){return ot===this.defaultOptions.blankColor}}return tt.\u0275fac=function(ot){return new(ot||tt)(_.Y36(s.$3),_.Y36(c.rf),_.Y36(c.mJ))},tt.\u0275cmp=_.Xpm({type:tt,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button","tuiHintDescribe","",1,"t-tool",3,"tuiHint","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ot,xt){1&ot&&(_.YNc(0,Q,7,8,"tui-hosted-dropdown",0),_.ALo(1,"async")),2&ot&&_.Q6J("tuiLet",_.lcZ(1,1,xt.backgroundColor$))},directives:[j.Ls,nt.o1,Y.Ek,q.v0,et.$o,et.D,et.xn,et.t6,et.DM,pt.O5,Ot.R,F.e],pipes:[pt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),tt})()},69867:(Gt,yt,a)=>{a.d(yt,{pu:()=>nt,P_:()=>et,y9:()=>Ot,jP:()=>ot,p7:()=>Q,Zv:()=>tt,XC:()=>Yt,Ur:()=>Ht,mp:()=>Et,iA:()=>K,er:()=>Pt,__:()=>oe,_t:()=>se}),a(20719);var c=a(12057),$=a(92668),I=a(23917),_=a(12628),j=a(90022),F=a(74788);let nt=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,j.go,$.WD]]}),rt})();a(57289);var q=a(75111);let et=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,j.go,q.pc]]}),rt})();a(18885);let Ot=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,_.fN,j.go]]}),rt})();a(49382),a(73688);let Q=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,j.go,q.pc]]}),rt})();a(81618);let tt=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,j.go]]}),rt})();a(52187);let ot=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,_.fN,j.go]]}),rt})();a(73545);var bt=a(221),lt=a(98952),Rt=a(96472);let Yt=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,Rt.VM,j.go,lt.dp,bt.A,$.WD]]}),rt})();a(30928);let Ht=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,_.fN,j.go,$.WD]]}),rt})();a(61899);let Et=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,Rt.VM,_.fN,j.go,bt.A,lt.dp,$.WD]]}),rt})();a(76289);var P=a(1336);let H=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,P.Ih]]}),rt})(),K=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,lt.dp,_.fN,j.go,H]]}),rt})();a(41218);let Pt=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,_.fN,j.go,$.WD]]}),rt})();a(34773);let oe=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,I.jh,j.go,_.fN,q.pc,$.WD]]}),rt})();a(57891);let se=(()=>{class rt{}return rt.\u0275fac=function(Ut){return new(Ut||rt)},rt.\u0275mod=F.oAB({type:rt}),rt.\u0275inj=F.cJS({imports:[[c.ez,_.fN,I.jh,lt.dp,j.go,Rt.VM,bt.A,$.WD]]}),rt})()},30928:(Gt,yt,a)=>{a.d(yt,{w:()=>ft});var s=a(86114),c=a(71831),$=a(9112),I=a(88002),_=a(74788),j=a(12057),F=a(92668),nt=a(23917),Y=a(12628),q=a(90022);function et(st,Q){if(1&st){const W=_.EpF();_.TgZ(0,"div",6),_.TgZ(1,"button",7),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.toggleUnorderedList()}),_.qZA(),_.TgZ(2,"button",8),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).editor.toggleOrderedList()}),_.qZA(),_.TgZ(3,"button",9),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).sinkListItem()}),_.qZA(),_.TgZ(4,"button",10),_.NdJ("click",function(){return _.CHM(W),_.oxw(3).liftListItem()}),_.qZA(),_.qZA()}if(2&st){const W=_.oxw().tuiLet,tt=_.oxw().ngIf;_.xp6(1),_.Q6J("tuiHint",tt.unorderedList)("pseudoActive",!(null==W||!W.unordered)),_.xp6(1),_.Q6J("tuiHint",tt.orderedList)("pseudoActive",!(null==W||!W.ordered)),_.xp6(1),_.Q6J("tuiHint",tt.indent)("disabled",!(null!=W&&W.ordered||null!=W&&W.unordered)),_.xp6(1),_.Q6J("tuiHint",tt.outdent)("disabled",!(null!=W&&W.ordered||null!=W&&W.unordered))}}function pt(st,Q){if(1&st&&(_.TgZ(0,"tui-hosted-dropdown",2,3),_._UZ(2,"button",4),_.YNc(3,et,5,8,"ng-template",null,5,_.W1O),_.qZA()),2&st){const W=Q.tuiLet,tt=_.MAs(1),ut=_.MAs(4),ot=_.oxw().ngIf;_.Q6J("content",ut),_.xp6(2),_.Q6J("tuiHint",ot.list)("pseudoActive",(null==tt?null:tt.open)||(null==W?null:W.unordered)||(null==W?null:W.ordered)||!1)("focusable",tt.open)}}function Ot(st,Q){if(1&st&&(_.ynx(0),_.YNc(1,pt,5,4,"tui-hosted-dropdown",1),_.ALo(2,"async"),_.BQk()),2&st){const W=_.oxw();_.xp6(1),_.Q6J("tuiLet",_.lcZ(2,1,W.listState$))}}let ft=(()=>{class st{constructor(W,tt){this.editor=W,this.texts$=tt,this.listState$=(0,$.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,I.U)(([ut,ot])=>({ordered:ut,unordered:ot})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return st.\u0275fac=function(W){return new(W||st)(_.Y36(s.$3),_.Y36(c.rf))},st.\u0275cmp=_.Xpm({type:st,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(W,tt){1&W&&(_.YNc(0,Ot,3,3,"ng-container",0),_.ALo(1,"async")),2&W&&_.Q6J("ngIf",_.lcZ(1,1,tt.texts$))},directives:[j.O5,F.Ls,nt.o1,Y.v0,q.$o,q.D,q.xn,q.t6,q.DM],pipes:[j.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),st})()},61899:(Gt,yt,a)=>{a.d(yt,{p:()=>ut});var s=a(86114),c=a(71831),$=a(9112),I=a(88002),_=a(87519),j=a(74788),F=a(92668),nt=a(221),Y=a(23917),q=a(98952),et=a(12628),pt=a(90022),Ot=a(12057),ft=a(59113);function st(ot,xt){if(1&ot&&j._UZ(0,"div",7),2&ot){const bt=j.oxw(2).tuiLet;j.Udp("background",bt)}}function Q(ot,xt){if(1&ot){const bt=j.EpF();j.TgZ(0,"tui-palette",8),j.NdJ("selectedColor",function(Rt){j.CHM(bt),j.oxw();const Yt=j.MAs(1);return j.oxw(2).setCellColor(Rt),Yt.close()}),j.qZA()}if(2&ot){const bt=xt.$implicit,lt=j.oxw(3);j.Q6J("tuiActiveZoneParent",bt)("colors",lt.colors)}}function W(ot,xt){if(1&ot&&(j.TgZ(0,"tui-hosted-dropdown",2,3),j._UZ(2,"button",4),j.ALo(3,"async"),j.YNc(4,st,1,2,"div",5),j.YNc(5,Q,1,2,"ng-template",null,6,j.W1O),j.qZA()),2&ot){const bt=xt.tuiLet,lt=j.MAs(1),Rt=j.MAs(6),Yt=j.oxw().tuiLet,Zt=j.oxw();j.Q6J("content",Rt)("tuiDropdownMaxHeight",999)("canOpen",!!bt),j.xp6(2),j.Q6J("tuiHint",j.lcZ(3,8,Zt.colorText$))("pseudoActive",lt.open)("focusable",lt.open)("disabled",!bt),j.xp6(2),j.Q6J("ngIf",!Zt.isBlankColor(Yt||""))}}function tt(ot,xt){if(1&ot&&(j.ynx(0),j.YNc(1,W,7,10,"tui-hosted-dropdown",1),j.ALo(2,"async"),j.BQk()),2&ot){const bt=j.oxw();j.xp6(1),j.Q6J("tuiLet",j.lcZ(2,1,bt.isActive$))}}let ut=(()=>{class ot{constructor(bt,lt,Rt){this.defaultOptions=bt,this.editor=lt,this.texts$=Rt,this.colors=this.defaultOptions.colors,this.colorText$=this.texts$.pipe((0,I.U)(Yt=>this.editor.isActive("group")&&Yt.hiliteGroup||this.editor.isActive("table")&&Yt.cellColor||"")),this.isActive$=(0,$.aj)([this.editor.isActive$("table"),this.editor.isActive$("group")]).pipe((0,I.U)(([Yt,Zt])=>Yt||Zt)),this.color$=this.editor.stateChange$.pipe((0,I.U)(()=>this.editor.getCellColor()||this.editor.getGroupColor()||this.defaultOptions.blankColor),(0,_.x)())}isBlankColor(bt){return bt===this.defaultOptions.blankColor}setCellColor(bt){this.editor.isActive("group")?this.editor.setGroupHilite(bt):this.editor.isActive("table")&&this.editor.setCellColor(bt)}}return ot.\u0275fac=function(bt){return new(bt||ot)(j.Y36(c.mJ),j.Y36(s.$3),j.Y36(c.rf))},ot.\u0275cmp=j.Xpm({type:ot,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["colorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(bt,lt){1&bt&&(j.YNc(0,tt,3,3,"ng-container",0),j.ALo(1,"async")),2&bt&&j.Q6J("tuiLet",j.lcZ(1,1,lt.color$))},directives:[F.Ls,Y.o1,q.Ek,et.v0,pt.$o,pt.D,pt.xn,pt.t6,pt.DM,Ot.O5,ft.R,nt.e],pipes:[Ot.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),ot})()},76289:(Gt,yt,a)=>{a.d(yt,{l:()=>ot});var s=a(86114),c=a(71831),$=a(88002),I=a(74788),_=a(23917),j=a(98952),F=a(12628),nt=a(90022),Y=a(62579),q=a(47766),et=a(1336);function pt(xt,bt){if(1&xt){const lt=I.EpF();I.TgZ(0,"div",4),I.NdJ("mouseenter",function(Yt){const Ht=I.CHM(lt).$implicit,At=I.oxw().$implicit;return I.oxw().updateCurrentSize(Ht+1,At+1,Yt)})("click",function(){return I.CHM(lt),I.oxw(2).select()}),I.qZA()}if(2&xt){const lt=bt.$implicit,Rt=I.oxw().$implicit,Yt=I.oxw();I.ekj("t-cell_hovered",Yt.tableSelectHovered(lt,Rt))}}function Ot(xt,bt){if(1&xt&&(I.TgZ(0,"div",2),I.YNc(1,pt,1,2,"div",3),I.qZA()),2&xt){const lt=I.oxw();I.xp6(1),I.Q6J("tuiRepeatTimesOf",lt.rowsNumber)}}let W=(()=>{class xt{constructor(lt){this.win=lt,this.selectSize=new I.vpe,this.onSelectSize=this.selectSize,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(lt,Rt){return lt<this.tableSize.rows&&Rt<this.tableSize.cols}updateCurrentSize(lt,Rt,Yt){(0,q.ic)(this.win)-Yt.clientX>70&&(this.tableSize={rows:lt,cols:Rt})}onClick(){this.select()}select(){this.selectSize.emit(this.tableSize)}}return xt.\u0275fac=function(lt){return new(lt||xt)(I.Y36(Y.m9))},xt.\u0275cmp=I.Xpm({type:xt,selectors:[["tui-table-size-selector"]],outputs:{selectSize:"selectSize",onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(lt,Rt){1&lt&&(I.YNc(0,Ot,2,1,"div",0),I.TgZ(1,"div",1),I._uU(2),I.qZA()),2&lt&&(I.Q6J("tuiRepeatTimesOf",Rt.columnsNumber),I.xp6(2),I.AsE("",Rt.tableSize.cols,"\xd7",Rt.tableSize.rows,""))},directives:[et.Xj],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),xt})();var tt=a(12057);function ut(xt,bt){if(1&xt){const lt=I.EpF();I.TgZ(0,"tui-table-size-selector",4),I.NdJ("onSelectSize",function(Yt){return I.CHM(lt),I.oxw().addTable(Yt)}),I.qZA()}}let ot=(()=>{class xt{constructor(lt,Rt){this.editor=lt,this.texts$=Rt,this.insertTableText$=this.texts$.pipe((0,$.U)(Yt=>Yt.insertTable))}addTable({rows:lt,cols:Rt}){this.editor.enter();const Yt=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(Yt),this.editor.insertTable(lt,Rt)}}return xt.\u0275fac=function(lt){return new(lt||xt)(I.Y36(s.$3),I.Y36(c.rf))},xt.\u0275cmp=I.Xpm({type:xt,selectors:[["tui-table-create"]],decls:6,vars:5,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(lt,Rt){if(1&lt&&(I.TgZ(0,"tui-hosted-dropdown",0,1),I._UZ(2,"button",2),I.ALo(3,"async"),I.qZA(),I.YNc(4,ut,1,0,"ng-template",null,3,I.W1O)),2&lt){const Yt=I.MAs(1),Zt=I.MAs(5);I.Q6J("content",Zt),I.xp6(2),I.Q6J("tuiHint",I.lcZ(3,3,Rt.insertTableText$))("focusable",Yt.open)}},directives:[_.o1,j.Ek,F.v0,nt.$o,nt.D,nt.xn,nt.t6,nt.DM,W],pipes:[tt.Ov],encapsulation:2,changeDetection:0}),xt})()},41218:(Gt,yt,a)=>{a.d(yt,{Y:()=>Ot});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(92668),F=a(12057),nt=a(12628),Y=a(90022);function q(ft,st){if(1&ft){const Q=_.EpF();_.TgZ(0,"button",2),_.NdJ("click",function(){_.CHM(Q);const tt=_.oxw().tuiLet,ut=_.oxw();return tt.mergeCells?ut.mergeCells():ut.splitCell()}),_.qZA()}if(2&ft){const Q=st.ngIf,W=_.oxw().tuiLet;_.Q6J("icon",W.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",W.mergeCells?Q.mergeCells:Q.splitCells)("focusable",!1)("disabled",!W.mergeCells&&!W.splitCells)}}function et(ft,st){if(1&ft&&(_.ynx(0),_.YNc(1,q,1,4,"button",1),_.ALo(2,"async"),_.BQk()),2&ft){const Q=_.oxw();_.xp6(1),_.Q6J("ngIf",_.lcZ(2,1,Q.texts$))}}const pt=function(ft,st){return{mergeCells:ft,splitCells:st}};let Ot=(()=>{class ft{constructor(Q,W){this.editor=Q,this.texts$=W,this.canMergeCells$=this.editor.stateChange$.pipe((0,$.U)(()=>this.editor.canMergeCells()),(0,I.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,$.U)(()=>this.editor.canSplitCells()),(0,I.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return ft.\u0275fac=function(Q){return new(Q||ft)(_.Y36(s.$3),_.Y36(c.rf))},ft.\u0275cmp=_.Xpm({type:ft,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"icon","tuiHint","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"icon","tuiHint","focusable","disabled","click"]],template:function(Q,W){1&Q&&(_.YNc(0,et,3,3,"ng-container",0),_.ALo(1,"async"),_.ALo(2,"async")),2&Q&&_.Q6J("tuiLet",_.WLB(5,pt,_.lcZ(1,1,W.canMergeCells$),_.lcZ(2,3,W.canSplitCells$)))},directives:[j.Ls,F.O5,nt.v0,Y.$o,Y.D,Y.xn,Y.t6,Y.DM],pipes:[F.Ov],encapsulation:2,changeDetection:0}),ft})()},34773:(Gt,yt,a)=>{a.d(yt,{_:()=>Q});var s=a(86114),c=a(71831),$=a(88002),I=a(74788),_=a(92668),j=a(23917),F=a(12628),nt=a(90022),Y=a(75111),q=a(12057);function et(W,tt){if(1&W&&(I.TgZ(0,"tui-hosted-dropdown",2,3),I._UZ(2,"button",4),I.ALo(3,"async"),I.qZA()),2&W){const ut=tt.tuiLet,ot=I.MAs(1),xt=I.oxw(),bt=I.MAs(3);I.Q6J("content",bt)("canOpen",!!ut),I.xp6(2),I.Q6J("tuiHint",I.lcZ(3,5,xt.rowsColumnsManagingText$))("focusable",ot.open)("disabled",!ut)}}function pt(W,tt){if(1&W){const ut=I.EpF();I.TgZ(0,"button",7),I.NdJ("click",function(){const bt=I.CHM(ut).index,lt=I.oxw().index;return I.oxw(2).onTableOption(2*lt+bt)}),I._uU(1),I.qZA()}if(2&W){const ut=tt.$implicit;I.xp6(1),I.hij(" ",ut," ")}}function Ot(W,tt){if(1&W&&(I.TgZ(0,"tui-opt-group"),I.YNc(1,pt,2,1,"button",6),I.qZA()),2&W){const ut=tt.$implicit;I.xp6(1),I.Q6J("ngForOf",ut)}}function ft(W,tt){if(1&W&&(I.TgZ(0,"tui-data-list"),I.YNc(1,Ot,2,1,"tui-opt-group",5),I.ALo(2,"async"),I.qZA()),2&W){const ut=I.oxw();I.xp6(1),I.Q6J("ngForOf",I.lcZ(2,1,ut.tableCommandTexts$))}}var st=(()=>{return(W=st||(st={}))[W.InsertColumnBefore=0]="InsertColumnBefore",W[W.InsertColumnAfter=1]="InsertColumnAfter",W[W.InsertRowBefore=2]="InsertRowBefore",W[W.InsertRowAfter=3]="InsertRowAfter",W[W.DeleteColumn=4]="DeleteColumn",W[W.DeleteRow=5]="DeleteRow",st;var W})();let Q=(()=>{class W{constructor(ut,ot,xt){this.editor=ut,this.texts$=ot,this.tableCommandTexts$=xt,this.commandsRegistry={[st.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[st.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[st.InsertRowAfter]:()=>this.editor.addRowAfter(),[st.InsertRowBefore]:()=>this.editor.addRowBefore(),[st.DeleteColumn]:()=>this.editor.deleteColumn(),[st.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,$.U)(bt=>bt.rowsColumnsManaging))}onTableOption(ut){this.commandsRegistry[ut]()}}return W.\u0275fac=function(ut){return new(ut||W)(I.Y36(s.$3),I.Y36(c.rf),I.Y36(c.$i))},W.\u0275cmp=I.Xpm({type:W,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",3,"tuiHint","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(ut,ot){1&ut&&(I.YNc(0,et,4,7,"tui-hosted-dropdown",0),I.ALo(1,"async"),I.YNc(2,ft,3,3,"ng-template",null,1,I.W1O)),2&ut&&I.Q6J("tuiLet",I.lcZ(1,1,ot.isActive$))},directives:[_.Ls,j.o1,F.v0,nt.$o,nt.D,nt.xn,nt.t6,nt.DM,Y.qi,q.sg,Y.Rs,Y.vK],pipes:[q.Ov],encapsulation:2,changeDetection:0}),W})()},57891:(Gt,yt,a)=>{a.d(yt,{G:()=>Q});var s=a(86114),c=a(71831),$=a(88002),I=a(87519),_=a(74788),j=a(92668),F=a(221),nt=a(23917),Y=a(98952),q=a(12628),et=a(90022),pt=a(59113),Ot=a(12057);function ft(W,tt){if(1&W){const ut=_.EpF();_.TgZ(0,"tui-palette",6),_.NdJ("selectedColor",function(xt){return _.CHM(ut),_.oxw(2).editor.setFontColor(xt)}),_.qZA()}if(2&W){const ut=tt.$implicit,ot=_.oxw(2);_.Q6J("tuiActiveZoneParent",ut)("colors",ot.colors)}}function st(W,tt){if(1&W&&(_.TgZ(0,"tui-hosted-dropdown",1,2),_._UZ(2,"button",3),_.ALo(3,"async"),_._UZ(4,"div",4),_.YNc(5,ft,1,2,"ng-template",null,5,_.W1O),_.qZA()),2&W){const ut=tt.tuiLet,ot=_.MAs(1),xt=_.MAs(6),bt=_.oxw();_.Q6J("content",xt)("tuiDropdownMaxHeight",999),_.xp6(2),_.Q6J("tuiHint",_.lcZ(3,7,bt.foreColorText$))("pseudoActive",ot.open)("focusable",ot.open),_.xp6(2),_.Udp("background",ut)}}let Q=(()=>{class W{constructor(ut,ot,xt){this.defaultOptions=ut,this.editor=ot,this.texts$=xt,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,$.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,I.x)()),this.foreColorText$=this.texts$.pipe((0,$.U)(bt=>bt.foreColor))}}return W.\u0275fac=function(ut){return new(ut||W)(_.Y36(c.mJ),_.Y36(s.$3),_.Y36(c.rf))},W.\u0275cmp=_.Xpm({type:W,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button","tuiHintDescribe","",3,"tuiHint","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ut,ot){1&ut&&(_.YNc(0,st,7,9,"tui-hosted-dropdown",0),_.ALo(1,"async")),2&ut&&_.Q6J("tuiLet",_.lcZ(1,1,ot.fontColor$))},directives:[j.Ls,nt.o1,Y.Ek,q.v0,et.$o,et.D,et.xn,et.t6,et.DM,pt.R,F.e],pipes:[Ot.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:22.6rem}"],changeDetection:0}),W})()},51618:(Gt,yt,a)=>{a.d(yt,{M6:()=>s.M,yB:()=>et});var s=a(22580),c=a(12057),$=a(13633),I=a(56210),_=a(90022),j=a(12628),F=a(23917),nt=a(8674),Y=a(69867),q=a(74788);let et=(()=>{class pt{}return pt.\u0275fac=function(ft){return new(ft||pt)},pt.\u0275mod=q.oAB({type:pt}),pt.\u0275inj=q.cJS({imports:[[c.ez,_.go,$.u,j.fN,F.jh,nt.Fu,Y.er,Y.mp,Y.__,Y.iA,Y.p7,Y.Zv,Y.pu,Y.Ur,Y._t,Y.XC,Y.P_,Y.y9,I.H,Y.jP]]}),pt})()},22580:(Gt,yt,a)=>{a.d(yt,{M:()=>x});var s=a(74788),c=a(33770),$=a(57179),_=(a(18939),a(27103)),j=a(18892),F=a(86114),nt=a(95161),Y=a(71831),q=a(15257),et=a(46782),pt=a(85648);let Ot=(()=>{class b{constructor(D){this.el=D}get toolsContainers(){return Array.from(this.el.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(D){const{toolsContainers:V}=this,mt=V.findIndex($.zb),R=V[(0,pt.Ki)(mt+(D?-1:1),0,V.length-1)],l=D?this.findPreviousTool(R):this.findNextTool(R);l&&l.focus()}findFirstFocusableTool(D=!1){const V=D?this.toolsContainers.slice().reverse():this.toolsContainers;for(const mt of V){const Dt=(0,$._h)(mt)?mt:(0,$.BW)({initial:mt,root:mt,keyboard:!1});if(Dt)return Dt}return null}findPreviousTool(D){return(0,$._h)(D)?D:(0,$.BW)({initial:D,root:D,keyboard:!1})||(0,$.BW)({initial:D,root:this.el.nativeElement,previous:!0,keyboard:!1})}findNextTool(D){return(0,$._h)(D)?D:(0,$.BW)({initial:D,root:this.el.nativeElement,keyboard:!1})}}return b.\u0275fac=function(D){return new(D||b)(s.Y36(s.SBq))},b.\u0275dir=s.lG2({type:b,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(D,V){1&D&&s.NdJ("keydown.arrowRight.prevent",function(){return V.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return V.onHorizontalNavigation(!0)})}}),b})();var ft=a(12057),st=a(13633),Q=a(56210),W=a(12628),tt=a(90022),ut=a(23917),ot=a(73688),xt=a(81618),bt=a(20719),lt=a(30928),Rt=a(41039),Yt=a(57891),Zt=a(73545),Ht=a(57289),At=a(18885),Et=a(49382),X=a(52187),P=a(61899),H=a(76289),K=a(34773),Mt=a(41218);const Pt=["dropdown"];function Kt(b,B){1&b&&s.GkF(0)}function oe(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",7),s.NdJ("click",function(){return s.CHM(D),s.oxw(2).undo()}),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(D),s.oxw(2).redo()}),s.qZA(),s.qZA()}if(2&b){const D=s.oxw().ngIf,V=s.oxw();s.xp6(1),s.Q6J("tuiHint",D.undo)("disabled",V.undoDisabled)("focusable",!1),s.xp6(1),s.Q6J("tuiHint",D.redo)("disabled",V.redoDisabled)("focusable",!1)}}function Jt(b,B){1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-font-size",9),s.qZA())}function se(b,B){if(1&b&&s._UZ(0,"tui-font-style",15),2&b){const D=s.oxw(3);s.Q6J("enabledTools",D.toolsSet)}}function rt(b,B){1&b&&s._UZ(0,"tui-align-content",9)}function It(b,B){1&b&&s._UZ(0,"tui-list-configs",9)}function Ut(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"button",16,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(3).toggleQuote()}),s.qZA()}if(2&b){const D=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",D.quote)("pseudoActive",V.blockquote)("disabled",V.unorderedList||V.orderedList)("focusable",!1)}}function me(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"tui-edit-link",22,23),s.NdJ("addLink",function(mt){s.CHM(D),s.oxw();const Dt=s.MAs(1);return s.oxw(3).onLink(Dt,mt)})("removeLink",function(){s.CHM(D),s.oxw();const mt=s.MAs(1);return s.oxw(3).onLink(mt)}),s.qZA()}}function fe(b,B){if(1&b&&(s.TgZ(0,"tui-hosted-dropdown",18,19),s._UZ(2,"button",20,17),s.YNc(4,me,2,0,"ng-template",null,21,s.W1O),s.qZA()),2&b){const D=s.MAs(1),V=s.MAs(5),mt=s.oxw(2).ngIf,Dt=s.oxw();s.Q6J("canOpen",Dt.canOpenAnchor)("content",V),s.xp6(2),s.Q6J("tuiHint",mt.link)("pseudoActive",D.open||Dt.a)("focusable",D.open)}}function ee(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"tui-edit-link",28),s.NdJ("addLink",function(mt){s.CHM(D),s.oxw();const Dt=s.MAs(1);return s.oxw(3).setAnchor(Dt,mt)})("removeLink",function(){return s.CHM(D),s.oxw(4).removeAnchor()}),s.qZA()}2&b&&s.Q6J("anchorMode",!0)}function Wt(b,B){if(1&b&&(s.TgZ(0,"tui-hosted-dropdown",24,25),s._UZ(2,"button",26),s.YNc(3,ee,1,1,"ng-template",null,27,s.W1O),s.qZA()),2&b){const D=s.MAs(1),V=s.MAs(4),mt=s.oxw(2).ngIf,Dt=s.oxw();s.Q6J("canOpen",Dt.canOpenAnchor)("content",V),s.xp6(2),s.Q6J("focusable",!1)("pseudoActive",D.open||Dt.jumpAnchor)("tuiHint",mt.insertAnchor)}}function Nt(b,B){if(1&b){const D=s.EpF();s.ynx(0),s.TgZ(1,"button",29,17),s.NdJ("click",function(){return s.CHM(D),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",30,31),s.NdJ("change",function(){s.CHM(D);const mt=s.MAs(4);return s.oxw(3).onAttach(mt)}),s.qZA(),s.BQk()}if(2&b){const D=s.oxw(2).ngIf,V=s.oxw();s.xp6(1),s.Q6J("tuiHint",D.attach)("focusable",!1),s.xp6(2),s.Q6J("accept",V.attachOptions.accept)("multiple",V.attachOptions.multiple)("tuiFocusable",!1)}}function qt(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,se,1,1,"tui-font-style",10),s.YNc(2,rt,1,0,"tui-align-content",11),s.YNc(3,It,1,0,"tui-list-configs",11),s.YNc(4,Ut,2,4,"button",12),s.YNc(5,fe,6,5,"tui-hosted-dropdown",13),s.YNc(6,Wt,5,5,"tui-hosted-dropdown",14),s.YNc(7,Nt,5,5,"ng-container",1),s.qZA()),2&b){const D=s.oxw(2);s.xp6(1),s.Q6J("ngIf",D.formatEnabled),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Align)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.List)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Quote)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Link)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Anchor)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Attach))}}function kt(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"button",34,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(3).toggleSubscript()}),s.qZA()}if(2&b){const D=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",D.subscript)("pseudoActive",V.subscript)("focusable",!1)}}function jt(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"button",35,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(3).toggleSuperscript()}),s.qZA()}if(2&b){const D=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",D.superscript)("pseudoActive",V.superscript)("focusable",!1)}}function re(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,kt,2,3,"button",32),s.YNc(2,jt,2,3,"button",33),s.qZA()),2&b){const D=s.oxw(2);s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Sub)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Sup))}}function ae(b,B){if(1&b&&s._UZ(0,"tui-text-color",37),2&b){const D=s.oxw(3);s.Q6J("colors",D.colors)}}function Me(b,B){if(1&b&&s._UZ(0,"tui-highlight-color",37),2&b){const D=s.oxw(3);s.Q6J("colors",D.colors)}}function Ne(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,ae,1,1,"tui-text-color",36),s.YNc(2,Me,1,1,"tui-highlight-color",36),s.qZA()),2&b){const D=s.oxw(2);s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Color)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Hilite))}}function xe(b,B){1&b&&s._UZ(0,"tui-code",9)}function Ie(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"button",41,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(3).onTeX()}),s.qZA()}if(2&b){const D=s.oxw(2).ngIf;s.Q6J("tuiHint",D.tex)("focusable",!1)}}function Ze(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"div",42),s.TgZ(1,"button",43,17),s.NdJ("click",function(){return s.CHM(D),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",44,45),s.NdJ("change",function(){s.CHM(D);const mt=s.MAs(4);return s.oxw(3).onImage(mt)}),s.qZA(),s.qZA()}if(2&b){const D=s.oxw(2).ngIf;s.xp6(1),s.Q6J("tuiHint",D.image)("focusable",!1),s.xp6(2),s.Q6J("tuiFocusable",!1)}}function Fe(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"button",46,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(3).insertHorizontalRule()}),s.qZA()}if(2&b){const D=s.oxw(2).ngIf;s.Q6J("tuiHint",D.insertHorizontalRule)("focusable",!1)}}function De(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,xe,1,0,"tui-code",11),s.YNc(2,Ie,2,2,"button",38),s.YNc(3,Ze,5,3,"div",39),s.YNc(4,Fe,2,2,"button",40),s.qZA()),2&b){const D=s.oxw(2);s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Code)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Tex)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Img)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.HR))}}function Ue(b,B){if(1&b){const D=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",47,17),s.NdJ("click",function(){return s.CHM(D),s.oxw(2).removeFormat()}),s.qZA(),s.qZA()}if(2&b){const D=s.oxw().ngIf;s.xp6(1),s.Q6J("tuiHint",D.clear)("focusable",!1)}}function Te(b,B){1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-details",48),s._UZ(2,"tui-details-remove",48),s.qZA())}function Le(b,B){if(1&b&&s._UZ(0,"tui-table-cell-color",37),2&b){const D=s.oxw(3);s.Q6J("colors",D.colors)}}function be(b,B){if(1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-editor-group-tool",48),s.YNc(2,Le,1,1,"tui-table-cell-color",36),s.qZA()),2&b){const D=s.oxw(2);s.xp6(2),s.Q6J("ngIf",!D.enabled(D.TuiEditorTool.Table))}}function Oe(b,B){if(1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-table-create",48),s._UZ(2,"tui-table-row-column-manager",48),s._UZ(3,"tui-table-merge-cells",48),s._UZ(4,"tui-table-cell-color",37),s.qZA()),2&b){const D=s.oxw(2);s.xp6(4),s.Q6J("colors",D.colors)}}function ht(b,B){if(1&b&&(s.TgZ(0,"section",4),s.YNc(1,oe,3,6,"div",5),s.YNc(2,Jt,2,0,"div",5),s.YNc(3,qt,8,7,"div",5),s.YNc(4,re,3,2,"div",5),s.YNc(5,Ne,3,2,"div",5),s.YNc(6,De,5,4,"div",5),s.YNc(7,Ue,3,2,"div",5),s.YNc(8,Te,3,0,"div",5),s.YNc(9,be,3,1,"div",5),s.YNc(10,Oe,5,1,"div",5),s.TgZ(11,"div",6),s.Hsn(12),s.qZA(),s.qZA()),2&b){const D=s.oxw();s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Undo)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Size)),s.xp6(1),s.Q6J("ngIf",D.firstBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Sub)||D.enabled(D.TuiEditorTool.Sup)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Color)||D.enabled(D.TuiEditorTool.Hilite)),s.xp6(1),s.Q6J("ngIf",D.secondBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Clear)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Details)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Group)),s.xp6(1),s.Q6J("ngIf",D.enabled(D.TuiEditorTool.Table))}}const M=["*"];let x=(()=>{class b{constructor(D,V,mt,Dt,R,l,d,y){this.el=D,this.editor=V,this.imageLoader=mt,this.attachOptions=Dt,this.filesLoader=R,this.texts$=l,this.defaultOptions=d,this.destroy$=y,this.dropdowns=c.Mm,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new s.vpe,this.texClicked=new s.vpe,this.fileAttached=new s.vpe,this.TuiEditorTool=nt._,this.toolsSet=new Set(j.Db)}set tools(D){this.toolsSet=new Set(D)}get focused(){return(0,$.zb)(this.el.nativeElement)||!!this.dropdowns.find(({nativeElement:D})=>(0,$.zb)(D))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get jumpAnchor(){return this.editor.isActive("jumpAnchor")}get canOpenAnchor(){return!this.a&&!this.jumpAnchor}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(nt._.Bold)||this.enabled(nt._.Italic)||this.enabled(nt._.Underline)||this.enabled(nt._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(nt._.Align)||this.enabled(nt._.List)||this.enabled(nt._.Quote)||this.enabled(nt._.Link)||this.enabled(nt._.Anchor)||this.enabled(nt._.Attach)}get secondBigBlockEnabled(){return this.enabled(nt._.Code)||this.enabled(nt._.Tex)||this.enabled(nt._.Img)||this.enabled(nt._.HR)}onMouseDown(D,V){V.closest("button")||(D.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(D){var V;const mt=null===(V=D.files)||void 0===V?void 0:V[0];D.value="",mt&&this.imageLoader(mt).pipe((0,q.q)(1),(0,et.R)(this.destroy$)).subscribe(Dt=>this.addImage(Dt))}onAttach(D){var V;const mt=Array.from(D.files||[]);D.value="",mt&&(null===(V=this.filesLoader)||void 0===V||V.call(this,mt).pipe((0,q.q)(1),(0,et.R)(this.destroy$)).subscribe(Dt=>this.fileAttached.emit(Dt)))}onTeX(){this.texClicked.emit()}onLink(D,V){D.open=!1,V&&this.editor.toggleLink(V)}setAnchor(D,V){D.open=!1,V&&(this.editor.setAnchor(V),this.editor.selectClosest())}removeAnchor(){this.editor.removeAnchor()}enabled(D){return this.toolsSet.has(D)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(D){this.editor.setImage(D)}focusFirst(){var D;const V=null===(D=this.navigationManager)||void 0===D?void 0:D.findFirstFocusableTool();V&&V.focus()}focusLast(){var D;const V=null===(D=this.navigationManager)||void 0===D?void 0:D.findFirstFocusableTool(!0);V&&V.focus()}}return b.\u0275fac=function(D){return new(D||b)(s.Y36(s.SBq,8),s.Y36(F.$3),s.Y36(Y.p7),s.Y36(Y.dR),s.Y36(Y.zc,8),s.Y36(Y.rf),s.Y36(Y.mJ),s.Y36(_.a3,2))},b.\u0275cmp=s.Xpm({type:b,selectors:[["tui-toolbar"]],viewQuery:function(D,V){if(1&D&&(s.Gf(Ot,5),s.Gf(Pt,5,s.SBq)),2&D){let mt;s.iGM(mt=s.CRH())&&(V.navigationManager=mt.first),s.iGM(mt=s.CRH())&&(V.dropdowns=mt)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(D,V){1&D&&s.NdJ("mousedown",function(Dt){return V.onMouseDown(Dt,Dt.target)}),2&D&&s.ekj("_disabled",V.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",fileAttached:"fileAttached"},features:[s._Bn([_.a3])],ngContentSelectors:M,decls:7,vars:8,consts:[["type","button",1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","","class","t-tool t-tool_margin",3,"tuiHint","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool",3,"tuiHint","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],[1,"t-wrapper",3,"canOpen","content"],["anchor",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAnchorLarge","tuiHintDirection","top-left","appearance","icon","tuiHintDescribe","",3,"focusable","pseudoActive","tuiHint"],["anchorDropdown",""],[3,"anchorMode","addLink","removeLink"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconPaperclipLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","focusable","click"],["type","file",1,"t-file-upload",3,"accept","multiple","tuiFocusable","change"],["fileUpload",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","","class","t-tool t-tool_margin",3,"tuiHint","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","","class","t-tool t-tool_margin",3,"tuiHint","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","","class","t-tool",3,"tuiHint","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","","class","t-tool t-tool_margin",3,"tuiHint","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool",3,"tuiHint","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImageLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool",3,"tuiHint","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left","tuiHintDescribe","",1,"t-tool","t-tool_margin",3,"tuiHint","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function(D,V){1&D&&(s.F$t(),s._UZ(0,"button",0),s.YNc(1,Kt,1,0,"ng-container",1),s.ALo(2,"async"),s.TgZ(3,"div",2),s.NdJ("focus",function(){return V.onTopFocus()}),s.qZA(),s.TgZ(4,"div",2),s.NdJ("focus",function(){return V.onBottomFocus()}),s.qZA(),s.YNc(5,ht,13,10,"section",3),s.ALo(6,"async")),2&D&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,4,V.editor.stateChange$)),s.xp6(2),s.Q6J("tuiFocusable",V.focusable),s.xp6(1),s.Q6J("tuiFocusable",V.focusable),s.xp6(1),s.Q6J("ngIf",s.lcZ(6,6,V.texts$)))},directives:[ft.O5,st.t,Ot,W.v0,Q.w,tt.$o,tt.D,tt.xn,tt.t6,tt.DM,ot.m,xt.h,bt.X,lt.w,ut.o1,Rt.l,Yt.G,Zt.U,Ht.T,At.y,Et.U,X.d,P.p,H.l,K._,Mt.Y],pipes:[ft.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-file-upload[_ngcontent-%COMP%]{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),b})()},18892:(Gt,yt,a)=>{a.d(yt,{hK:()=>c,pH:()=>j,pL:()=>pt,_s:()=>F,Ci:()=>Y,jU:()=>et,DN:()=>q,sw:()=>s,Db:()=>I,RR:()=>_});const s=new Map([["transparent","transparent"],["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),c="rgb(51, 51, 51)";var $=a(95161);const I=[$._.Undo,$._.Size,$._.Bold,$._.Italic,$._.Underline,$._.Align,$._.List,$._.Quote,$._.Link,$._.Anchor,$._.Color,$._.Hilite,$._.Clear,$._.Strikethrough,$._.Code,$._.Img,$._.HR,$._.Sup,$._.Sub,$._.Table,$._.Details];function _(Ot){return[{px:13,name:Ot.small},{px:15,name:Ot.normal},{px:17,name:Ot.large},{px:24,family:"var(--tui-font-heading)",name:Ot.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:Ot.title,headingLevel:1,weight:"bold"}]}const j=["id","class","src","style","controls","loop","muted","preload","autoplay","width","height","controlsList"],F="#",Y="https://",q=":",et="://",pt={protocol:Y}},86114:(Gt,yt,a)=>{a.d(yt,{BN:()=>c,JU:()=>$.JU,mJ:()=>$.mJ,$3:()=>$.$3});var s=a(74788);let c=(()=>{class I{}return I.\u0275fac=function(j){return new(j||I)},I.\u0275mod=s.oAB({type:I}),I.\u0275inj=s.cJS({}),I})();var $=a(79698)},79698:(Gt,yt,a)=>{a.d(yt,{JU:()=>s.J,mJ:()=>$,$3:()=>I.$});var s=a(87429),c=a(74788);let $=(()=>{class _{}return _.\u0275fac=function(F){return new(F||_)},_.\u0275mod=c.oAB({type:_}),_.\u0275inj=c.cJS({}),_})();var I=a(26710)},87429:(Gt,yt,a)=>{a.d(yt,{J:()=>j});var s=a(74788),c=a(27103),$=a(71831),I=a(46782),_=a(26710);let j=(()=>{class F{constructor(Y,q,et,pt,Ot,ft){this.el=Y,this.renderer=q,this.editor=et,this.editorContainer=pt,this.editorLoaded$=Ot,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,I.R)(ft)).subscribe(()=>{this.renderer.appendChild(this.el.nativeElement,this.editorContainer)})}set value(Y){this.editor.setValue(Y)}set editable(Y){this.editor.editable=Y}}return F.\u0275fac=function(Y){return new(Y||F)(s.Y36(s.SBq),s.Y36(s.Qsj),s.Y36(_.$),s.Y36($.Y1),s.Y36($.ZW),s.Y36(c.a3,2))},F.\u0275dir=s.lG2({type:F,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[s._Bn([c.a3])]}),F})()},26710:(Gt,yt,a)=>{a.d(yt,{$:()=>Ot});var s=a(75675),c=a(79765),$=a(74788);let I=(()=>{class ft{constructor(){this.stateChange$=new c.xQ,this.valueChange$=new c.xQ}}return ft.\u0275fac=function(Q){return new(Q||ft)},ft.\u0275dir=$.lG2({type:ft}),ft})();var _=a(18892),j=a(71831),F=a(88320),nt=a(62463),Y=a(39761),q=a(88002),et=a(87519);let Ot=(()=>{class ft extends I{constructor(Q){super(),this.editorRef=Q,this.editorRef.subscribe(W=>{this.editor=W,W.on("transaction",()=>{this.stateChange$.next()}),W.on("update",()=>{const tt=W.getHTML(),ot=function(ft){return Array.isArray(ft)&&1===ft.length&&"paragraph"===ft[0].type&&!ft[0].hasOwnProperty("content")}(W.getJSON().content)?"":tt;this.valueChange$.next(ot)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(Q){this.editor.setEditable(Q)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||_.hK}getFontSize(){return parseInt(this.editor.getAttributes("textStyle").fontSize,10)}setFontSize(Q){this.editor.chain().setMark("textStyle",{fontSize:(0,s.O)(Q)}).run()}getBackgroundColor(){var Q;return(null===(Q=this.editor)||void 0===Q?void 0:Q.getAttributes("textStyle").backgroundColor)||"transparent"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}getGroupColor(){var Q,W,tt,ut;if(this.editor.isActive("group")){const ot=null!==(W=null===(Q=this.editor.getAttributes("group"))||void 0===Q?void 0:Q.style)&&void 0!==W?W:"",xt=(0,F.jx)(ot);return null!==(ut=null!==(tt=xt["background-color"])&&void 0!==tt?tt:xt.background)&&void 0!==ut?ut:""}return""}onAlign(Q){this.editor.chain().focus().setTextAlign(Q).run()}setImage(Q){this.editor.chain().focus().command(({commands:W,state:tt})=>{var ut;const ot=null!==(ut=W.setEditableImage)&&void 0!==ut?ut:W.setImage;if(ot){const xt=tt.selection.anchor;return ot({src:Q}),W.setTextSelection(xt),!0}return!1}).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(Q){this.editor.chain().focus().setFontColor(Q).run()}setBackgroundColor(Q){this.editor.chain().focus().setBackgroundColor(Q).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(Q){return this.editor.isActive(Q)}isActive$(Q){return this.stateChange$.pipe((0,Y.O)(null),(0,q.U)(()=>this.isActive(Q)),(0,et.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(Q,W){this.editor.chain().focus().insertTable({cols:Q,rows:W}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(Q){this.editor.chain().focus().setHeading({level:Q}).run()}setParagraph(Q){this.editor.chain().focus().setParagraph().run(),Q&&this.editor.chain().setMark("textStyle",Q).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(Q){this.editor.commands.setTextSelection(Q)}toggleLink(Q){this.editor.chain().focus().toggleLink({href:Q}).run()}setLink(Q){this.editor.chain().focus().setLink({href:Q}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(Q){Q===this.html||""===Q&&"<p></p>"===this.html||(this.editor.commands.setContent(Q),this.editor.view.updateState(nt.yy.create({schema:this.editor.state.schema,doc:this.editor.state.doc,selection:this.editor.state.selection,storedMarks:this.editor.state.storedMarks,plugins:this.editor.state.plugins})))}destroy(){this.editor.destroy()}setCellColor(Q){this.editor.chain().focus().setCellBackground(Q).run()}selectClosest(){const Q=this.editor.state.selection.anchor,{schema:W,doc:tt}=this.editor.state,ut=(0,F.Yz)(tt.resolve(Q),W.marks.link);ut&&this.editor.chain().setTextSelection(ut).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}setGroupHilite(Q){this.editor.commands.setGroupHilite(Q)}setAnchor(Q){this.editor.commands.setAnchor(Q.replace("#",""))}removeAnchor(){this.editor.commands.removeAnchor()}setFileLink(Q){this.editor.commands.setFileLink(Q)}setYoutubeVideo(Q){this.editor.commands.setYoutubeVideo(Q)}setIframe(Q){this.editor.commands.setIframe(Q)}removeEmptyTextStyle(){this.editor.commands.removeEmptyTextStyle()}toggleMark(Q,W,tt){this.editor.commands.toggleMark(Q,W,tt)}}return ft.\u0275fac=function(Q){return new(Q||ft)($.LFG(j.ZW))},ft.\u0275prov=$.Yz7({token:ft,factory:ft.\u0275fac}),ft})()},95161:(Gt,yt,a)=>{a.d(yt,{_:()=>s});var s=(()=>{return(c=s||(s={})).Undo="undo",c.Anchor="anchor",c.Size="fontSize",c.Bold="bold",c.Italic="italic",c.Underline="underline",c.Strikethrough="strikeThrough",c.Align="justify",c.List="list",c.Quote="quote",c.Color="foreColor",c.Hilite="hiliteColor",c.Clear="clear",c.Link="link",c.Attach="attach",c.Tex="tex",c.Code="code",c.Img="image",c.HR="insertHorizontalRule",c.Sup="superscript",c.Sub="subscript",c.Table="insertTable",c.MergeCells="mergeCells",c.SplitCells="splitCells",c.RowsColumnsManaging="rowsColumnsManaging",c.Details="details",c.Group="group",s;var c})()},13511:(Gt,yt,a)=>{a.r(yt),a.d(yt,{BackgroundColor:()=>$}),a(84402);const $=a(11046).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:I})=>I?{style:`background-color: ${I}`}:{},parseHTML:({style:I})=>I.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:I=>({chain:_})=>_().setMark("textStyle",{backgroundColor:I}).run(),unsetBackgroundColor:()=>({chain:I})=>I().setMark("textStyle",{backgroundColor:null}).run()})})},41131:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TuiFileLink:()=>c});const c=a(11046).Extension.create({name:"fileLink",addCommands:()=>({setFileLink:$=>({state:I,chain:_})=>{const{selection:j}=I,nt='<span style="font-size: 15px"> </span>';return(Math.abs(j.to-j.from)>0?_().toggleMark("link",{href:$.link},{extendEmptyMarkRange:!0}).setTextSelection(j.to).insertContent(nt):_().insertContent(`<a href="${$.link}">${$.name}</a>${nt}`)).setTextSelection(j.to).run()}})})},47841:(Gt,yt,a)=>{a.r(yt),a.d(yt,{FontColor:()=>$}),a(84402);const $=a(11046).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:I})=>I?{style:`color: ${I}`}:{},parseHTML:({style:I})=>I.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:I=>({chain:_})=>_().setMark("textStyle",{fontColor:I}).run(),unsetFontColor:()=>({chain:I})=>I().setMark("textStyle",{fontColor:null}).run()})})},83120:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TuiFontSize:()=>$}),a(84402);const $=a(11046).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:I})=>I.fontSize,renderHTML:({fontSize:I})=>I?{style:`font-size: ${I}`}:{}}}}]},addCommands:()=>({setFontSize:I=>({chain:_})=>_().setMark("textStyle",{fontSize:I}).run(),unsetFontSize:()=>({chain:I})=>I().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},38981:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>$,createGroupExtension:()=>I});var s=a(88320),c=a(11046);const $={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},I=(_={})=>{const{draggable:j,nested:F,groupNodeClass:nt,groupPointerNodeClass:Y,createOnEnter:q}=Object.assign(Object.assign({},$),_);return c.Node.create({name:"group",draggable:j,group:"block",content:F?"block+":"block",addAttributes:()=>({style:{default:null,parseHTML:et=>et.getAttribute("style"),renderHTML:et=>et.style?{style:et.style}:{}}}),parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:et})=>["div",(0,c.mergeAttributes)(et,{"data-type":"group"}),0],addNodeView:()=>({HTMLAttributes:et,node:pt})=>{const Ot=document.createElement("div"),ft=document.createElement("div");if(Ot.classList.add(nt),ft.setAttribute("data-type","group"),et.style&&(pt.attrs.style=et.style,ft.setAttribute("style",et.style)),j){const st=document.createElement("div");st.classList.add(Y),st.innerHTML="",st.contentEditable="false",Ot.append(st,ft)}else Ot.append(ft);return{dom:Ot,contentDOM:ft}},addCommands(){return{setGroup:()=>({commands:et,state:pt})=>{this.editor.chain().focus().run();const Ot=(0,s.Ap)(pt,""),st=`<div data-type="group">${Ot.trim().startsWith("<p>")?Ot:`<p>${Ot}</p>`}</div>`;return et.insertContent(st)},setGroupHilite:et=>({editor:pt})=>{for(let Ot=pt.state.selection.$anchor,ft=Ot.depth;ft>0;ft--){const st=Ot.node(ft);if(st.type.name===this.name){setTimeout(()=>pt.commands.updateAttributes(st.type,{style:`background: ${et}`}));break}}return!0},removeGroup:()=>({state:et,dispatch:pt})=>(0,s.yU)(et,pt,this.name)}},addKeyboardShortcuts(){return q?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},91876:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TUI_IFRAME_EDITOR_OPTIONS:()=>j,TuiIframeEditorComponent:()=>nt,TuiIframeEditorModule:()=>Ot,createIframeEditorExtension:()=>et});var s=a(12057),c=a(91211),$=a(27103),I=a(33703),_=a(74788);const j=new _.OlP("[TUI_IFRAME_EDITOR_OPTIONS]",{factory:()=>({minWidth:100,maxWidth:1/0,minHeight:100,maxHeight:1/0})});var F=a(61732);let nt=(()=>{class ft extends I._{constructor(Q,W,tt,ut){super(W,ut),this.options=Q,this.sanitizer=tt}get src(){var Q;return this.sanitizer.bypassSecurityTrustResourceUrl(null!==(Q=this.attrs.src)&&void 0!==Q?Q:"")}updateSize([Q,W]){this._width=Math.max(this.options.minWidth,Math.min(this.options.maxWidth,Q)),this._height=Math.max(this.options.minHeight,Math.min(this.options.maxHeight,W))}}return ft.\u0275fac=function(Q){return new(Q||ft)(_.Y36(j),_.Y36(s.K0),_.Y36(c.H7),_.Y36($.a3,2))},ft.\u0275cmp=_.Xpm({type:ft,selectors:[["tui-iframe-editor"]],features:[_._Bn([$.a3]),_.qOj],decls:2,vars:13,consts:[[3,"width","height","sizeChange"],[3,"src","width","height"]],template:function(Q,W){1&Q&&(_.TgZ(0,"tui-editor-resizable",0),_.NdJ("sizeChange",function(ut){return W.updateSize(ut)}),_._UZ(1,"iframe",1),_.qZA()),2&Q&&(_.Q6J("width",W.width)("height",W.height),_.xp6(1),_.Udp("min-width",W.options.minWidth)("min-height",W.options.minHeight)("max-width",W.options.maxWidth)("max-height",W.options.maxHeight),_.Q6J("src",W.src,_.uOi)("width",W.width)("height",W.height))},directives:[F.V],styles:["iframe[_ngcontent-%COMP%]{display:inline;pointer-events:none}"],changeDetection:0}),ft})();var Y=a(87187),q=a(11046);const et=ft=>q.Node.create({name:"iframe",group:"block",atom:!0,draggable:!1,parseHTML:()=>[{tag:'iframe[data-type="iframe-editor"]'}],addAttributes(){return{src:{default:null,keepOnSplit:!1,parseHTML:st=>st.getAttribute("src")},frameborder:{default:0,keepOnSplit:!1,parseHTML:st=>st.getAttribute("frameborder")},width:{default:"100%",keepOnSplit:!1,parseHTML:st=>st.getAttribute("width")},height:{default:null,keepOnSplit:!1,parseHTML:st=>st.getAttribute("height")},allowfullscreen:{keepOnSplit:!1,default:this.options.allowFullscreen,parseHTML:st=>st.getAttribute("allowfullscreen")}}},renderHTML:({HTMLAttributes:st})=>["iframe",(0,q.mergeAttributes)(st,{"data-type":"iframe-editor"})],addNodeView:()=>st=>new Y.y(nt,st,Object.assign({injector:ft},st)),addCommands(){return{setIframe:st=>({commands:Q,state:W})=>{const tt=W.selection.anchor;return Q.enter(),Q.setTextSelection(tt),Q.insertContent({type:this.name,attrs:st}),Q.setTextSelection(W.selection.anchor),!0}}}});var pt=a(36807);let Ot=(()=>{class ft{}return ft.\u0275fac=function(Q){return new(Q||ft)},ft.\u0275mod=_.oAB({type:ft}),ft.\u0275inj=_.cJS({imports:[[pt.S]]}),ft})()},45267:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>nt,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>F,TUI_IMAGE_EDITOR_OPTIONS:()=>Y,TuiImageEditorComponent:()=>et,TuiImageEditorModule:()=>lt,createImageEditorExtension:()=>ut,tuiCreateImageEditorExtension:()=>xt});var s=a(12057),c=a(74788),$=a(91211),I=a(62579),_=a(27103),j=a(33703);const F=new c.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]",{factory:()=>null}),nt=new c.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]",{factory:()=>null}),Y=new c.OlP("[TUI_IMAGE_EDITOR_OPTIONS]",{factory:()=>({minWidth:100,maxWidth:1/0})});var q=a(61732);let et=(()=>{class Rt extends j._{constructor(Zt,Ht,At,Et,X,P,H,K){super(Et,P),this.minWidth=Zt,this.maxWidth=Ht,this.options=At,this.sanitizer=X,this.el=H,this.win=K,this.contenteditable=!0,this.focused=!1}get dragHandle(){var Zt;return null!==(Zt=this.attrs.draggable)&&void 0!==Zt?Zt:null}get height(){return null}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}get src(){return this.sanitizer.bypassSecurityTrustResourceUrl(this.attrs.src)}currentTargetIsFocused(Zt){this.focused=this.el.nativeElement.contains(Zt),this.focused&&this.selectFakeText()}updateSize([Zt]){var Ht,At;const Et=null!==(Ht=this.minWidth)&&void 0!==Ht?Ht:this.options.minWidth,X=null!==(At=this.maxWidth)&&void 0!==At?At:this.options.maxWidth;this._width=Math.max(Et,Math.min(X,Zt))}selectFakeText(){var Zt,Ht,At;const Et=this.doc.createRange();null===(Zt=this.el.nativeElement.querySelector("p"))||void 0===Zt||Zt.focus(),Et.selectNode(this.el.nativeElement),null===(Ht=this.win.getSelection())||void 0===Ht||Ht.removeAllRanges(),null===(At=this.win.getSelection())||void 0===At||At.addRange(Et)}}return Rt.\u0275fac=function(Zt){return new(Zt||Rt)(c.Y36(F),c.Y36(nt),c.Y36(Y),c.Y36(s.K0),c.Y36($.H7),c.Y36(_.a3,2),c.Y36(c.SBq),c.Y36(I.m9))},Rt.\u0275cmp=c.Xpm({type:Rt,selectors:[["tui-image-editor"]],hostVars:2,hostBindings:function(Zt,Ht){1&Zt&&c.NdJ("click.silent",function(Et){return Ht.currentTargetIsFocused(Et.target)},!1,c.evT),2&Zt&&c.uIk("contenteditable",Ht.contenteditable)("data-drag-handle",Ht.dragHandle)},features:[c._Bn([_.a3]),c.qOj],decls:4,vars:12,consts:[["contenteditable","false",1,"t-emulate-inline-node"],[3,"width","autoHeight","sizeChange"],["contenteditable","false",3,"src","width","alt","title"]],template:function(Zt,Ht){1&Zt&&(c._UZ(0,"p",0),c.TgZ(1,"tui-editor-resizable",1),c.NdJ("sizeChange",function(Et){return Ht.updateSize(Et)}),c._UZ(2,"img",2),c.qZA(),c._UZ(3,"p",0)),2&Zt&&(c.xp6(1),c.Q6J("width",Ht.width)("autoHeight",!0),c.xp6(1),c.Udp("min-width",Ht.options.minWidth,"px")("max-width",Ht.options.maxWidth,"px"),c.ekj("ProseMirror-selectednode",Ht.focused),c.Q6J("src",Ht.src,c.LSH)("width",Ht.width)("alt",Ht.alt)("title",Ht.title))},directives:[q.V],styles:["[data-drag-handle][_nghost-%COMP%]{cursor:move}img[_ngcontent-%COMP%]{pointer-events:none}.t-emulate-inline-node[_ngcontent-%COMP%]{display:inline-block;margin:0;height:0}"],changeDetection:0}),Rt})();var pt=a(11927),Ot=a(87187),ft=a(11046),st=a(44632),Q=a(62463);const W=[{tag:'img[data-type="image-editor"]'}],tt={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}};function ut(Rt,{draggable:Yt}={}){const Zt=!(0,pt.Pc)(Yt)||Yt;return st.Image.extend({name:"imageEditor",group:"inline",inline:!0,atom:!0,priority:0,selectable:!0,draggable:Zt,parseHTML:()=>W,addAttributes:()=>Object.assign(Object.assign({},tt),{draggable:{default:Zt?"":null,keepOnSplit:!1}}),renderHTML:({HTMLAttributes:Ht})=>["img",(0,ft.mergeAttributes)(Ht,{"data-type":"image-editor"})],addNodeView:()=>Ht=>new Ot.y(et,Ht,Object.assign({injector:Rt},Ht)),addCommands(){return{setEditableImage:Ht=>({commands:At})=>At.insertContent({type:this.name,attrs:Ht})}},addProseMirrorPlugins:()=>[new Q.Sy({props:{handleDOMEvents:{paste:ot,drop:ot}}})]})}function ot(Rt,Yt){var Zt;const Ht=Yt instanceof DragEvent?Yt.dataTransfer:Yt.clipboardData,At=Array.from(null!==(Zt=null==Ht?void 0:Ht.files)&&void 0!==Zt?Zt:[]).filter(Et=>/image/i.test(Et.type));At.length&&Yt.preventDefault();for(const Et of At){const X=new FileReader;X.onload=P=>{var H;const K=Rt.state.schema.nodes.imageEditor.create({src:null===(H=P.target)||void 0===H?void 0:H.result}),Mt=Rt.state.tr.replaceSelectionWith(K);setTimeout(()=>Rt.dispatch(Mt))},X.readAsDataURL(Et)}}function xt({injector:Rt,draggable:Yt}){return ut(Rt,{draggable:Yt})}var bt=a(36807);let lt=(()=>{class Rt{}return Rt.\u0275fac=function(Zt){return new(Zt||Rt)},Rt.\u0275mod=c.oAB({type:Rt}),Rt.\u0275inj=c.cJS({imports:[[s.ez,bt.S]]}),Rt})()},73757:(Gt,yt,a)=>{function c(I){return I.isActive("bulletList")||I.isActive("orderedList")}a.r(yt),a.d(yt,{TuiTabExtension:()=>$,tuiIsOrderedOrBulletList:()=>c});const $=a(11046).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>c(this.editor)?null:this.editor.commands.insertContent("\t")}}})},50822:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TuiLink:()=>v});var s=a(88320),c=a(11046);const _=(m,h)=>{for(const T in h)m[T]=h[T];return m},j="numeric",F="ascii",nt="alpha",Y="asciinumeric",q="alphanumeric",et="domain",st="whitespace";function Q(m,h){return m in h||(h[m]=[]),h[m]}function W(m,h,T){h[j]&&(h[Y]=!0,h[q]=!0),h[F]&&(h[Y]=!0,h[nt]=!0),h[Y]&&(h[q]=!0),h[nt]&&(h[q]=!0),h[q]&&(h[et]=!0),h.emoji&&(h[et]=!0);for(const E in h){const N=Q(E,T);N.indexOf(m)<0&&N.push(m)}}function ut(m){void 0===m&&(m=null),this.j={},this.jr=[],this.jd=null,this.t=m}ut.groups={},ut.prototype={accepts(){return!!this.t},go(m){const h=this,T=h.j[m];if(T)return T;for(let E=0;E<h.jr.length;E++){const N=h.jr[E][0],Z=h.jr[E][1];if(Z&&N.test(m))return Z}return h.jd},has(m,h){return void 0===h&&(h=!1),h?m in this.j:!!this.go(m)},ta(m,h,T,E){for(let N=0;N<m.length;N++)this.tt(m[N],h,T,E)},tr(m,h,T,E){let N;return E=E||ut.groups,h&&h.j?N=h:(N=new ut(h),T&&E&&W(h,T,E)),this.jr.push([m,N]),N},ts(m,h,T,E){let N=this;const Z=m.length;if(!Z)return N;for(let L=0;L<Z-1;L++)N=N.tt(m[L]);return N.tt(m[Z-1],h,T,E)},tt(m,h,T,E){E=E||ut.groups;const N=this;if(h&&h.j)return N.j[m]=h,h;const Z=h;let L,G=N.go(m);if(G?(L=new ut,_(L.j,G.j),L.jr.push.apply(L.jr,G.jr),L.jd=G.jd,L.t=G.t):L=new ut,Z){if(E)if(L.t&&"string"==typeof L.t){const gt=_(function(m,h){const T={};for(const E in h)h[E].indexOf(m)>=0&&(T[E]=!0);return T}(L.t,E),T);W(Z,gt,E)}else T&&W(Z,T,E);L.t=Z}return N.j[m]=L,L}};const ot=(m,h,T,E,N)=>m.ta(h,T,E,N),xt=(m,h,T,E,N)=>m.tr(h,T,E,N),bt=(m,h,T,E,N)=>m.ts(h,T,E,N),lt=(m,h,T,E,N)=>m.tt(h,T,E,N),Rt="WORD",Yt="UWORD",Zt="LOCALHOST",At="UTLD",Et="SCHEME",X="SLASH_SCHEME",P="NUM",K="NL",Mt="OPENBRACE",Pt="OPENBRACKET",Kt="OPENANGLEBRACKET",oe="OPENPAREN",Jt="CLOSEBRACE",se="CLOSEBRACKET",rt="CLOSEANGLEBRACKET",It="CLOSEPAREN",Ut="AMPERSAND",me="APOSTROPHE",fe="ASTERISK",ee="AT",Wt="BACKSLASH",Nt="BACKTICK",qt="CARET",kt="COLON",jt="COMMA",re="DOLLAR",ae="DOT",Me="EQUALS",Ne="EXCLAMATION",xe="HYPHEN",Ie="PERCENT",Ze="PIPE",Fe="PLUS",De="POUND",Ue="QUERY",Te="QUOTE",Le="SEMI",be="SLASH",Oe="TILDE",ht="UNDERSCORE",M="EMOJI",x="SYM";var b=Object.freeze({__proto__:null,WORD:Rt,UWORD:Yt,LOCALHOST:Zt,TLD:"TLD",UTLD:At,SCHEME:Et,SLASH_SCHEME:X,NUM:P,WS:"WS",NL:K,OPENBRACE:Mt,OPENBRACKET:Pt,OPENANGLEBRACKET:Kt,OPENPAREN:oe,CLOSEBRACE:Jt,CLOSEBRACKET:se,CLOSEANGLEBRACKET:rt,CLOSEPAREN:It,AMPERSAND:Ut,APOSTROPHE:me,ASTERISK:fe,AT:ee,BACKSLASH:Wt,BACKTICK:Nt,CARET:qt,COLON:kt,COMMA:jt,DOLLAR:re,DOT:ae,EQUALS:Me,EXCLAMATION:Ne,HYPHEN:xe,PERCENT:Ie,PIPE:Ze,PLUS:Fe,POUND:De,QUERY:Ue,QUOTE:Te,SEMI:Le,SLASH:be,TILDE:Oe,UNDERSCORE:ht,EMOJI:M,SYM:x});const B=/[a-z]/,D=/\p{L}/u,V=/\p{Emoji}/u,Dt=/\d/,R=/\s/;let w=null,z=null;function te(m,h,T,E,N){let Z;const L=h.length;for(let G=0;G<L-1;G++){const gt=h[G];m.j[gt]?Z=m.j[gt]:(Z=new ut(E),Z.jr=N.slice(),m.j[gt]=Z),m=Z}return Z=new ut(T),Z.jr=N.slice(),m.j[h[L-1]]=Z,Z}function Pe(m){const h=[],T=[];let E=0;for(;E<m.length;){let Z=0;for(;"0123456789".indexOf(m[E+Z])>=0;)Z++;if(Z>0){h.push(T.join(""));for(let L=parseInt(m.substring(E,E+Z),10);L>0;L--)T.pop();E+=Z}else T.push(m[E]),E++}return h}const J={defaultProtocol:"http",events:null,format:at,formatHref:at,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function S(m,h){void 0===h&&(h=null);let T=_({},J);m&&(T=_(T,m instanceof S?m.o:m));const E=T.ignoreTags,N=[];for(let Z=0;Z<E.length;Z++)N.push(E[Z].toUpperCase());this.o=T,h&&(this.defaultRender=h),this.ignoreTags=N}function at(m){return m}function Ct(m,h){this.t="token",this.v=m,this.tk=h}function zt(m,h){class T extends Ct{constructor(N,Z){super(N,Z),this.t=m}}for(const E in h)T.prototype[E]=h[E];return T.t=m,T}S.prototype={o:J,ignoreTags:[],defaultRender:m=>m,check(m){return this.get("validate",m.toString(),m)},get(m,h,T){const E=null!=h;let N=this.o[m];return N&&("object"==typeof N?(N=T.t in N?N[T.t]:J[m],"function"==typeof N&&E&&(N=N(h,T))):"function"==typeof N&&E&&(N=N(h,T.t,T)),N)},getObj(m,h,T){let E=this.o[m];return"function"==typeof E&&null!=h&&(E=E(h,T.t,T)),E},render(m){const h=m.render(this);return(this.get("render",null,m)||this.defaultRender)(h,m.t,m)}},Ct.prototype={isLink:!1,toString(){return this.v},toHref(m){return this.toString()},toFormattedString(m){const h=this.toString(),T=m.get("truncate",h,this),E=m.get("format",h,this);return T&&E.length>T?E.substring(0,T)+"\u2026":E},toFormattedHref(m){return m.get("formatHref",this.toHref(m.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(m){return void 0===m&&(m=J.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(m),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(m){return{type:this.t,value:this.toFormattedString(m),isLink:this.isLink,href:this.toFormattedHref(m),start:this.startIndex(),end:this.endIndex()}},validate(m){return m.get("validate",this.toString(),this)},render(m){const h=this,T=this.toHref(m.get("defaultProtocol")),E=m.get("formatHref",T,this),N=m.get("tagName",T,h),Z=this.toFormattedString(m),L={},G=m.get("className",T,h),gt=m.get("target",T,h),Tt=m.get("rel",T,h),wt=m.getObj("attributes",T,h),Lt=m.getObj("events",T,h);return L.href=E,G&&(L.class=G),gt&&(L.target=gt),Tt&&(L.rel=Tt),wt&&_(L,wt),{tagName:N,attributes:L,content:Z,eventListeners:Lt}}};const Ft=zt("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Vt=zt("text"),ue=zt("nl"),pe=zt("url",{isLink:!0,toHref(m){return void 0===m&&(m=J.defaultProtocol),this.hasProtocol()?this.v:`${m}://${this.v}`},hasProtocol(){const m=this.tk;return m.length>=2&&m[0].t!==Zt&&m[1].t===kt}}),ce=m=>new ut(m);function je(m,h,T){return new m(h.slice(T[0].s,T[T.length-1].e),T)}const Be="undefined"!=typeof console&&console&&console.warn||(()=>{}),ge={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Tn(m,h){if(void 0===h&&(h=!1),ge.initialized&&Be(`linkifyjs: already initialized - will not register custom scheme "${m}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(m))throw new Error('linkifyjs: incorrect scheme format.\n 1. Must only contain digits, lowercase ASCII letters or "-"\n 2. Cannot start or end with "-"\n 3. "-" cannot repeat');ge.customSchemes.push([m,h])}function mn(m){return ge.initialized||function(){ge.scanner=function(m){void 0===m&&(m=[]);const h={};ut.groups=h;const T=new ut;null==w&&(w=Pe("aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==z&&(z=Pe("\u03b5\u03bb1\u03c52\u0431\u04331\u0435\u043b3\u0434\u0435\u0442\u04384\u0435\u044e2\u043a\u0430\u0442\u043e\u043b\u0438\u043a6\u043e\u043c3\u043c\u043a\u04342\u043e\u043d1\u0441\u043a\u0432\u04306\u043e\u043d\u043b\u0430\u0439\u043d5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043a\u04403\u049b\u0430\u04373\u0570\u0561\u05753\u05d9\u05e9\u05e8\u05d0\u05dc5\u05e7\u05d5\u05dd3\u0627\u0628\u0648\u0638\u0628\u064a5\u062a\u0635\u0627\u0644\u0627\u062a6\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062f\u06464\u0628\u062d\u0631\u064a\u06465\u062c\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062f\u064a\u06296\u0639\u0644\u064a\u0627\u06465\u0645\u063a\u0631\u06285\u0645\u0627\u0631\u0627\u062a5\u06cc\u0631\u0627\u06465\u0628\u0627\u0631\u062a2\u0632\u0627\u06314\u064a\u062a\u06433\u06be\u0627\u0631\u062a5\u062a\u0648\u0646\u06334\u0633\u0648\u062f\u0627\u06463\u0631\u064a\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064a\u06466\u0642\u0637\u06313\u0643\u0627\u062b\u0648\u0644\u064a\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064a\u0633\u064a\u06275\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067e\u0627\u06a9\u0633\u062a\u0627\u06467\u0680\u0627\u0631\u062a4\u0915\u0949\u092e3\u0928\u0947\u091f3\u092d\u093e\u0930\u09240\u092e\u094d3\u094b\u09245\u0938\u0902\u0917\u0920\u09285\u09ac\u09be\u0982\u09b2\u09be5\u09ad\u09be\u09b0\u09a42\u09f0\u09a44\u0a2d\u0a3e\u0a30\u0a244\u0aad\u0abe\u0ab0\u0aa44\u0b2d\u0b3e\u0b30\u0b244\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe6\u0bb2\u0b99\u0bcd\u0b95\u0bc86\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd11\u0c2d\u0c3e\u0c30\u0c24\u0c4d5\u0cad\u0cbe\u0cb0\u0ca44\u0d2d\u0d3e\u0d30\u0d24\u0d025\u0dbd\u0d82\u0d9a\u0dcf4\u0e04\u0e2d\u0e213\u0e44\u0e17\u0e223\u0ea5\u0eb2\u0ea73\u10d2\u10d42\u307f\u3093\u306a3\u30a2\u30de\u30be\u30f34\u30af\u30e9\u30a6\u30c94\u30b0\u30fc\u30b0\u30eb4\u30b3\u30e02\u30b9\u30c8\u30a23\u30bb\u30fc\u30eb3\u30d5\u30a1\u30c3\u30b7\u30e7\u30f36\u30dd\u30a4\u30f3\u30c84\u4e16\u754c2\u4e2d\u4fe11\u56fd1\u570b1\u6587\u7f513\u4e9a\u9a6c\u900a3\u4f01\u4e1a2\u4f5b\u5c712\u4fe1\u606f2\u5065\u5eb72\u516b\u53662\u516c\u53f81\u76ca2\u53f0\u6e7e1\u70632\u5546\u57ce1\u5e971\u68072\u5609\u91cc0\u5927\u9152\u5e975\u5728\u7ebf2\u5927\u62ff2\u5929\u4e3b\u65593\u5a31\u4e502\u5bb6\u96fb2\u5e7f\u4e1c2\u5fae\u535a2\u6148\u55842\u6211\u7231\u4f603\u624b\u673a2\u62db\u80582\u653f\u52a11\u5e9c2\u65b0\u52a0\u57612\u95fb2\u65f6\u5c1a2\u66f8\u7c4d2\u673a\u67842\u6de1\u9a6c\u95213\u6e38\u620f2\u6fb3\u95802\u70b9\u770b2\u79fb\u52a82\u7ec4\u7ec7\u673a\u67844\u7f51\u57401\u5e971\u7ad91\u7edc2\u8054\u901a2\u8c37\u6b4c2\u8d2d\u72692\u901a\u8ca92\u96c6\u56e22\u96fb\u8a0a\u76c8\u79d14\u98de\u5229\u6d663\u98df\u54c12\u9910\u53852\u9999\u683c\u91cc\u62c93\u6e2f2\ub2f7\ub1371\ucef42\uc0bc\uc1312\ud55c\uad6d2")),lt(T,"'",me),lt(T,"{",Mt),lt(T,"[",Pt),lt(T,"<",Kt),lt(T,"(",oe),lt(T,"}",Jt),lt(T,"]",se),lt(T,">",rt),lt(T,")",It),lt(T,"&",Ut),lt(T,"*",fe),lt(T,"@",ee),lt(T,"`",Nt),lt(T,"^",qt),lt(T,":",kt),lt(T,",",jt),lt(T,"$",re),lt(T,".",ae),lt(T,"=",Me),lt(T,"!",Ne),lt(T,"-",xe),lt(T,"%",Ie),lt(T,"|",Ze),lt(T,"+",Fe),lt(T,"#",De),lt(T,"?",Ue),lt(T,'"',Te),lt(T,"/",be),lt(T,";",Le),lt(T,"~",Oe),lt(T,"_",ht),lt(T,"\\",Wt);const E=xt(T,Dt,P,{[j]:!0});xt(E,Dt,E);const N=xt(T,B,Rt,{[F]:!0});xt(N,B,N);const Z=xt(T,D,Yt,{[nt]:!0});xt(Z,B),xt(Z,D,Z);const L=xt(T,R,"WS",{[st]:!0});lt(T,"\n",K,{[st]:!0}),lt(L,"\n"),xt(L,R,L);const G=xt(T,V,M,{emoji:!0});xt(G,V,G),lt(G,"\ufe0f",G);const gt=lt(G,"\u200d");xt(gt,V,G);const Tt=[[B,N]],wt=[[B,null],[D,Z]];for(let Lt=0;Lt<w.length;Lt++)te(T,w[Lt],"TLD",Rt,Tt);for(let Lt=0;Lt<z.length;Lt++)te(T,z[Lt],At,Yt,wt);W("TLD",{tld:!0,ascii:!0},h),W(At,{utld:!0,alpha:!0},h),te(T,"file",Et,Rt,Tt),te(T,"mailto",Et,Rt,Tt),te(T,"http",X,Rt,Tt),te(T,"https",X,Rt,Tt),te(T,"ftp",X,Rt,Tt),te(T,"ftps",X,Rt,Tt),W(Et,{scheme:!0,ascii:!0},h),W(X,{slashscheme:!0,ascii:!0},h),m=m.sort((Lt,Qt)=>Lt[0]>Qt[0]?1:-1);for(let Lt=0;Lt<m.length;Lt++){const Qt=m[Lt][0],ie=m[Lt][1]?{scheme:!0}:{slashscheme:!0};Qt.indexOf("-")>=0?ie[et]=!0:B.test(Qt)?Dt.test(Qt)?ie[Y]=!0:ie[F]=!0:ie[j]=!0,bt(T,Qt,Qt,ie)}return bt(T,"localhost",Zt,{ascii:!0}),T.jd=new ut(x),{start:T,tokens:_({groups:h},b)}}(ge.customSchemes);for(let m=0;m<ge.tokenQueue.length;m++)ge.tokenQueue[m][1]({scanner:ge.scanner});ge.parser=function(m){let{groups:h}=m;const T=h.domain.concat([Ut,fe,ee,Wt,Nt,qt,re,Me,xe,P,Ie,Ze,Fe,De,be,x,Oe,ht]),E=[me,rt,Jt,se,It,kt,jt,ae,Ne,Kt,Mt,Pt,oe,Ue,Te,Le],N=[Ut,me,fe,Wt,Nt,qt,Jt,re,Me,xe,Mt,Ie,Ze,Fe,De,Ue,be,x,Oe,ht],Z=ce(),L=lt(Z,Oe);ot(L,N,L),ot(L,h.domain,L);const G=ce(),gt=ce(),Tt=ce();ot(Z,h.domain,G),ot(Z,h.scheme,gt),ot(Z,h.slashscheme,Tt),ot(G,N,L),ot(G,h.domain,G);const wt=lt(G,ee);lt(L,ee,wt),lt(gt,ee,wt),lt(Tt,ee,wt);const Lt=lt(L,ae);ot(Lt,N,L),ot(Lt,h.domain,L);const Qt=ce();ot(wt,h.domain,Qt),ot(Qt,h.domain,Qt);const le=lt(Qt,ae);ot(le,h.domain,Qt);const ie=ce(Ft);ot(le,h.tld,ie),ot(le,h.utld,ie),lt(wt,Zt,ie);const we=lt(Qt,xe);ot(we,h.domain,Qt),ot(ie,h.domain,Qt),lt(ie,ae,le),lt(ie,xe,we);const qe=lt(ie,kt);ot(qe,h.numeric,Ft);const Ke=lt(G,xe),Ee=lt(G,ae);ot(Ke,h.domain,G),ot(Ee,N,L),ot(Ee,h.domain,G);const Ae=ce(pe);ot(Ee,h.tld,Ae),ot(Ee,h.utld,Ae),ot(Ae,h.domain,G),ot(Ae,N,L),lt(Ae,ae,Ee),lt(Ae,xe,Ke),lt(Ae,ee,wt);const tn=lt(Ae,kt),Ge=ce(pe);ot(tn,h.numeric,Ge);const he=ce(pe),Xe=ce();ot(he,T,he),ot(he,E,Xe),ot(Xe,T,he),ot(Xe,E,Xe),lt(Ae,be,he),lt(Ge,be,he);const Mn=lt(gt,kt),Kn=lt(Tt,kt),Zn=lt(Kn,be),un=lt(Zn,be);ot(gt,h.domain,G),lt(gt,ae,Ee),lt(gt,xe,Ke),ot(Tt,h.domain,G),lt(Tt,ae,Ee),lt(Tt,xe,Ke),ot(Mn,h.domain,he),lt(Mn,be,he),ot(un,h.domain,he),ot(un,T,he),lt(un,be,he);const Re=lt(he,Mt),We=lt(he,Pt),kn=lt(he,Kt),An=lt(he,oe);lt(Xe,Mt,Re),lt(Xe,Pt,We),lt(Xe,Kt,kn),lt(Xe,oe,An),lt(Re,Jt,he),lt(We,se,he),lt(kn,rt,he),lt(An,It,he),lt(Re,Jt,he);const _n=ce(pe),Ve=ce(pe),dn=ce(pe),rn=ce(pe);ot(Re,T,_n),ot(We,T,Ve),ot(kn,T,dn),ot(An,T,rn);const pn=ce(),Cn=ce(),Sn=ce(),fn=ce();return ot(Re,E),ot(We,E),ot(kn,E),ot(An,E),ot(_n,T,_n),ot(Ve,T,Ve),ot(dn,T,dn),ot(rn,T,rn),ot(_n,E,_n),ot(Ve,E,Ve),ot(dn,E,dn),ot(rn,E,rn),ot(pn,T,pn),ot(Cn,T,Ve),ot(Sn,T,dn),ot(fn,T,rn),ot(pn,E,pn),ot(Cn,E,Cn),ot(Sn,E,Sn),ot(fn,E,fn),lt(Ve,se,he),lt(dn,rt,he),lt(rn,It,he),lt(_n,Jt,he),lt(Cn,se,he),lt(Sn,rt,he),lt(fn,It,he),lt(pn,It,he),lt(Z,Zt,Ae),lt(Z,K,ue),{start:Z,tokens:b}}(ge.scanner.tokens);for(let m=0;m<ge.pluginQueue.length;m++)ge.pluginQueue[m][1]({scanner:ge.scanner,parser:ge.parser});ge.initialized=!0}(),function(m,h,T){let E=T.length,N=0,Z=[],L=[];for(;N<E;){let G=m,gt=null,Tt=null,wt=0,Lt=null,Qt=-1;for(;N<E&&!(gt=G.go(T[N].t));)L.push(T[N++]);for(;N<E&&(Tt=gt||G.go(T[N].t));)gt=null,G=Tt,G.accepts()?(Qt=0,Lt=G):Qt>=0&&Qt++,N++,wt++;if(Qt<0)N-=wt,N<E&&(L.push(T[N]),N++);else{L.length>0&&(Z.push(je(Vt,h,L)),L=[]),N-=Qt,wt-=Qt;const le=Lt.t,ie=T.slice(N-wt,N);Z.push(je(le,h,ie))}}return L.length>0&&Z.push(je(Vt,h,L)),Z}(ge.parser.start,m,function(m,h){const T=function(m){const h=[],T=m.length;let E=0;for(;E<T;){let Z,N=m.charCodeAt(E),L=N<55296||N>56319||E+1===T||(Z=m.charCodeAt(E+1))<56320||Z>57343?m[E]:m.slice(E,E+2);h.push(L),E+=L.length}return h}(h.replace(/[A-Z]/g,G=>G.toLowerCase())),E=T.length,N=[];let Z=0,L=0;for(;L<E;){let G=m,gt=null,Tt=0,wt=null,Lt=-1,Qt=-1;for(;L<E&&(gt=G.go(T[L]));)G=gt,G.accepts()?(Lt=0,Qt=0,wt=G):Lt>=0&&(Lt+=T[L].length,Qt++),Tt+=T[L].length,Z+=T[L].length,L++;Z-=Lt,L-=Qt,Tt-=Lt,N.push({t:wt.t,v:h.slice(Z-Tt,Z),s:Z-Tt,e:Z})}return N}(ge.scanner.start,m))}function cn(m,h,T){if(void 0===h&&(h=null),void 0===T&&(T=null),h&&"object"==typeof h){if(T)throw Error(`linkifyjs: Invalid link type ${h}; must be a string`);T=h,h=null}const E=new S(T),N=mn(m),Z=[];for(let L=0;L<N.length;L++){const G=N[L];G.isLink&&(!h||G.t===h)&&Z.push(G.toFormattedObject(E))}return Z}function bn(m,h){void 0===h&&(h=null);const T=mn(m);return 1===T.length&&T[0].isLink&&(!h||T[0].t===h)}var on=a(62463);const v=c.Mark.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(m=>{"string"!=typeof m?Tn(m.scheme,m.optionalSlashes):Tn(m)})},onDestroy(){ut.groups={},ge.scanner=null,ge.parser=null,ge.tokenQueue=[],ge.pluginQueue=[],ge.customSchemes=[],ge.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:'a[href]:not([href *= "javascript:" i])'}],renderHTML({HTMLAttributes:m}){return["a",(0,c.mergeAttributes)(this.options.HTMLAttributes,m),0]},addCommands(){return{setLink:m=>({chain:h})=>h().setMark(this.name,m).setMeta("preventAutolink",!0).run(),toggleLink:m=>({chain:h})=>h().toggleMark(this.name,m,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:m})=>m().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[(0,c.markPasteRule)({find:m=>cn(m).filter(h=>!this.options.validate||this.options.validate(h.value)).filter(h=>h.isLink).map(h=>({text:h.value,index:h.start,data:h})),type:this.type,getAttributes:m=>{var h;return{href:null===(h=m.data)||void 0===h?void 0:h.href}}})]},addProseMirrorPlugins(){const m=[];return this.options.autolink&&m.push(function(m){return new on.Sy({key:new on.H$("autolink"),appendTransaction:(h,T,E)=>{const N=h.some(wt=>wt.docChanged)&&!T.doc.eq(E.doc),Z=h.some(wt=>wt.getMeta("preventAutolink"));if(!N||Z)return;const{tr:L}=E,G=(0,c.combineTransactionSteps)(T.doc,[...h]),{mapping:gt}=G;return(0,c.getChangedRanges)(G).forEach(({oldRange:wt,newRange:Lt})=>{(0,c.getMarksBetween)(wt.from,wt.to,T.doc).filter(we=>we.mark.type===m.type).forEach(we=>{const qe=gt.map(we.from),Ke=gt.map(we.to),Ee=(0,c.getMarksBetween)(qe,Ke,E.doc).filter(Mn=>Mn.mark.type===m.type);if(!Ee.length)return;const Ae=Ee[0],tn=T.doc.textBetween(we.from,we.to,void 0," "),Ge=E.doc.textBetween(Ae.from,Ae.to,void 0," "),he=bn(tn),Xe=bn(Ge);he&&!Xe&&L.removeMark(Ae.from,Ae.to,m.type)});const Qt=(0,c.findChildrenInRange)(E.doc,Lt,we=>we.isTextblock);let le,ie;if(Qt.length>1?(le=Qt[0],ie=E.doc.textBetween(le.pos,le.pos+le.node.nodeSize,void 0," ")):Qt.length&&E.doc.textBetween(Lt.from,Lt.to," "," ").endsWith(" ")&&(le=Qt[0],ie=E.doc.textBetween(le.pos,Lt.to,void 0," ")),le&&ie){const we=ie.split(" ").filter(Ee=>""!==Ee);if(we.length<=0)return!1;const qe=we[we.length-1],Ke=le.pos+ie.lastIndexOf(qe);if(!qe)return!1;cn(qe).filter(Ee=>Ee.isLink).filter(Ee=>!m.validate||m.validate(Ee.value)).map(Ee=>ye(Xt({},Ee),{from:Ke+Ee.start+1,to:Ke+Ee.end+1})).forEach(Ee=>{L.addMark(Ee.from,Ee.to,m.type.create({href:Ee.href}))})}}),L.steps.length?L:void 0}})}({type:this.type,validate:this.options.validate})),this.options.openOnClick&&m.push(function(m){return new on.Sy({key:new on.H$("handleClickLink"),props:{handleClick:(h,T,E)=>{var N,Z,L;if(0!==E.button)return!1;const G=(0,c.getAttributes)(h.state,m.type.name),gt=null===(N=E.target)||void 0===N?void 0:N.closest("a"),Tt=null!==(Z=null==gt?void 0:gt.href)&&void 0!==Z?Z:G.href,wt=null!==(L=null==gt?void 0:gt.target)&&void 0!==L?L:G.target;return!(!gt||!Tt||(window.open(Tt,wt),0))}}})}({type:this.type})),this.options.linkOnPaste&&m.push(function(m){return new on.Sy({key:new on.H$("handlePasteLink"),props:{handlePaste:(h,T,E)=>{const{state:N}=h,{selection:Z}=N,{empty:L}=Z;if(L)return!1;let G="";E.content.forEach(Tt=>{G+=Tt.textContent});const gt=cn(G).find(Tt=>Tt.isLink&&Tt.value===G);return!(!G||!gt||(m.editor.commands.setMark(m.type,{href:gt.href}),0))}}})}({editor:this.editor,type:this.type})),m}}).extend({addAttributes(){var m;return Object.assign(Object.assign({},null===(m=this.parent)||void 0===m?void 0:m.call(this)),(0,s.x6)(["download"]))},addCommands(){var m;return Object.assign(Object.assign({},null===(m=this.parent)||void 0===m?void 0:m.call(this)),{toggleLink:h=>({chain:T,state:E})=>{{const{selection:N,doc:Z}=E,L=Z.cut(N.to,N.to+1),gt=" "===(0,c.getHTMLFromFragment)(L.content,E.schema).replace(/<\/?[^>]+(>|$)/g,""),Tt=T().toggleMark(this.name,h,{extendEmptyMarkRange:!0});return(gt?Tt.setTextSelection(N.to+1):Tt.setTextSelection(N.to).insertContent('<span style="font-size: 15px"> </span>')).run()}}})}}).configure({openOnClick:!1})},12585:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TuiAudio:()=>I,TuiSource:()=>_,TuiVideo:()=>j});var s=a(18892),c=a(88320),$=a(11046);const I=$.Node.create({name:"audio",group:"block",content:"source+",addAttributes:()=>(0,c.x6)(s.pH),parseHTML:()=>[{tag:"audio"}],renderHTML:({node:F,HTMLAttributes:nt})=>["audio",nt,...(0,c.YX)(F)]}),_=$.Node.create({name:"source",addAttributes:()=>(0,c.x6)(["src","type","width","height","media","sizes","srcset"]),parseHTML:()=>[{tag:"source"}],renderHTML:({HTMLAttributes:F})=>["source",(0,$.mergeAttributes)(F)]}),j=$.Node.create({name:"video",group:"block",content:"source+",addAttributes:()=>(0,c.x6)(s.pH),parseHTML:()=>[{tag:"video"}],renderHTML:({node:F,HTMLAttributes:nt})=>["video",nt,...(0,c.YX)(F)]})},66826:(Gt,yt,a)=>{a.r(yt),a.d(yt,{StarterKit:()=>Pe});var s=a(11046);const c=/^\s*>\s$/,$=s.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:J}){return["blockquote",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setBlockquote:()=>({commands:J})=>J.wrapIn(this.name),toggleBlockquote:()=>({commands:J})=>J.toggleWrap(this.name),unsetBlockquote:()=>({commands:J})=>J.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,s.wrappingInputRule)({find:c,type:this.type})]}}),I=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,_=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,j=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,F=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,nt=s.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:J=>"normal"!==J.style.fontWeight&&null},{style:"font-weight",getAttrs:J=>/^(bold(er)?|[5-9]\d{2,})$/.test(J)&&null}],renderHTML({HTMLAttributes:J}){return["strong",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setBold:()=>({commands:J})=>J.setMark(this.name),toggleBold:()=>({commands:J})=>J.toggleMark(this.name),unsetBold:()=>({commands:J})=>J.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,s.markInputRule)({find:I,type:this.type}),(0,s.markInputRule)({find:j,type:this.type})]},addPasteRules(){return[(0,s.markPasteRule)({find:_,type:this.type}),(0,s.markPasteRule)({find:F,type:this.type})]}}),Y=s.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:J}){return["li",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),q=s.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:J=>!!J.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:J}){return["span",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:J,commands:S})=>{const at=(0,s.getMarkAttributes)(J,this.type);return!!Object.entries(at).some(([,Ct])=>!!Ct)||S.unsetMark(this.name)}}}}),et=/^\s*([-+*])\s$/,pt=s.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:J}){return["ul",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{toggleBulletList:()=>({commands:J,chain:S})=>this.options.keepAttributes?S().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Y.name,this.editor.getAttributes(q.name)).run():J.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let J=(0,s.wrappingInputRule)({find:et,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(J=(0,s.wrappingInputRule)({find:et,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(q.name),editor:this.editor})),[J]}}),Ot=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,ft=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,st=s.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:J}){return["code",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setCode:()=>({commands:J})=>J.setMark(this.name),toggleCode:()=>({commands:J})=>J.toggleMark(this.name),unsetCode:()=>({commands:J})=>J.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,s.markInputRule)({find:Ot,type:this.type})]},addPasteRules(){return[(0,s.markPasteRule)({find:ft,type:this.type})]}});var Q=a(62463);const W=/^```([a-z]+)?[\s\n]$/,tt=/^~~~([a-z]+)?[\s\n]$/,ut=s.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:J=>{var S;const{languageClassPrefix:at}=this.options;return[...(null===(S=J.firstElementChild)||void 0===S?void 0:S.classList)||[]].filter(Ft=>Ft.startsWith(at)).map(Ft=>Ft.replace(at,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:J,HTMLAttributes:S}){return["pre",(0,s.mergeAttributes)(this.options.HTMLAttributes,S),["code",{class:J.attrs.language?this.options.languageClassPrefix+J.attrs.language:null},0]]},addCommands(){return{setCodeBlock:J=>({commands:S})=>S.setNode(this.name,J),toggleCodeBlock:J=>({commands:S})=>S.toggleNode(this.name,"paragraph",J)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:J,$anchor:S}=this.editor.state.selection;return!(!J||S.parent.type.name!==this.name)&&!(1!==S.pos&&S.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:J})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:S}=J,{selection:at}=S,{$from:vt,empty:Ct}=at;if(!Ct||vt.parent.type!==this.type)return!1;const zt=vt.parentOffset===vt.parent.nodeSize-2,Ft=vt.parent.textContent.endsWith("\n\n");return!(!zt||!Ft)&&J.chain().command(({tr:Vt})=>(Vt.delete(vt.pos-2,vt.pos),!0)).exitCode().run()},ArrowDown:({editor:J})=>{if(!this.options.exitOnArrowDown)return!1;const{state:S}=J,{selection:at,doc:vt}=S,{$from:Ct,empty:zt}=at;if(!zt||Ct.parent.type!==this.type||Ct.parentOffset!==Ct.parent.nodeSize-2)return!1;const Vt=Ct.after();return void 0!==Vt&&!vt.nodeAt(Vt)&&J.commands.exitCode()}}},addInputRules(){return[(0,s.textblockTypeInputRule)({find:W,type:this.type,getAttributes:J=>({language:J[1]})}),(0,s.textblockTypeInputRule)({find:tt,type:this.type,getAttributes:J=>({language:J[1]})})]},addProseMirrorPlugins(){return[new Q.Sy({key:new Q.H$("codeBlockVSCodeHandler"),props:{handlePaste:(J,S)=>{if(!S.clipboardData||this.editor.isActive(this.type.name))return!1;const at=S.clipboardData.getData("text/plain"),vt=S.clipboardData.getData("vscode-editor-data"),Ct=vt?JSON.parse(vt):void 0,zt=null==Ct?void 0:Ct.mode;if(!at||!zt)return!1;const{tr:Ft}=J.state;return Ft.replaceSelectionWith(this.type.create({language:zt})),Ft.setSelection(Q.Bs.near(Ft.doc.resolve(Math.max(0,Ft.selection.from-2)))),Ft.insertText(at.replace(/\r\n?/g,"\n")),Ft.setMeta("paste",!0),J.dispatch(Ft),!0}}})]}}),ot=s.Node.create({name:"doc",topNode:!0,content:"block+"});var xt=a(38480);function bt(J={}){return new Q.Sy({view:S=>new lt(S,J)})}class lt{constructor(S,at){var vt;this.editorView=S,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(vt=at.width)&&void 0!==vt?vt:1,this.color=!1===at.color?void 0:at.color||"black",this.class=at.class,this.handlers=["dragover","dragend","drop","dragleave"].map(Ct=>{let zt=Ft=>{this[Ct](Ft)};return S.dom.addEventListener(Ct,zt),{name:Ct,handler:zt}})}destroy(){this.handlers.forEach(({name:S,handler:at})=>this.editorView.dom.removeEventListener(S,at))}update(S,at){null!=this.cursorPos&&at.doc!=S.state.doc&&(this.cursorPos>S.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(S){S!=this.cursorPos&&(this.cursorPos=S,null==S?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let vt,S=this.editorView.state.doc.resolve(this.cursorPos),at=!S.parent.inlineContent;if(at){let Vt=S.nodeBefore,ue=S.nodeAfter;if(Vt||ue){let pe=this.editorView.nodeDOM(this.cursorPos-(Vt?Vt.nodeSize:0));if(pe){let ke=pe.getBoundingClientRect(),ce=Vt?ke.bottom:ke.top;Vt&&ue&&(ce=(ce+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),vt={left:ke.left,right:ke.right,top:ce-this.width/2,bottom:ce+this.width/2}}}}if(!vt){let Vt=this.editorView.coordsAtPos(this.cursorPos);vt={left:Vt.left-this.width/2,right:Vt.left+this.width/2,top:Vt.top,bottom:Vt.bottom}}let zt,Ft,Ct=this.editorView.dom.offsetParent;if(this.element||(this.element=Ct.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",at),this.element.classList.toggle("prosemirror-dropcursor-inline",!at),!Ct||Ct==document.body&&"static"==getComputedStyle(Ct).position)zt=-pageXOffset,Ft=-pageYOffset;else{let Vt=Ct.getBoundingClientRect();zt=Vt.left-Ct.scrollLeft,Ft=Vt.top-Ct.scrollTop}this.element.style.left=vt.left-zt+"px",this.element.style.top=vt.top-Ft+"px",this.element.style.width=vt.right-vt.left+"px",this.element.style.height=vt.bottom-vt.top+"px"}scheduleRemoval(S){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),S)}dragover(S){if(!this.editorView.editable)return;let at=this.editorView.posAtCoords({left:S.clientX,top:S.clientY}),vt=at&&at.inside>=0&&this.editorView.state.doc.nodeAt(at.inside),Ct=vt&&vt.type.spec.disableDropCursor,zt="function"==typeof Ct?Ct(this.editorView,at,S):Ct;if(at&&!zt){let Ft=at.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let Vt=(0,xt.nj)(this.editorView.state.doc,Ft,this.editorView.dragging.slice);null!=Vt&&(Ft=Vt)}this.setCursor(Ft),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(S){(S.target==this.editorView.dom||!this.editorView.dom.contains(S.relatedTarget))&&this.setCursor(null)}}const Rt=s.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[bt(this.options)]}});var Yt=a(31690),Zt=a(27439),Ht=a(43594);class At extends Q.Y1{constructor(S){super(S,S)}map(S,at){let vt=S.resolve(at.map(this.head));return At.valid(vt)?new At(vt):Q.Y1.near(vt)}content(){return Zt.p2.empty}eq(S){return S instanceof At&&S.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(S,at){if("number"!=typeof at.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new At(S.resolve(at.pos))}getBookmark(){return new Et(this.anchor)}static valid(S){let at=S.parent;if(at.isTextblock||!function(J){for(let S=J.depth;S>=0;S--){let at=J.index(S),vt=J.node(S);if(0!=at)for(let Ct=vt.child(at-1);;Ct=Ct.lastChild){if(0==Ct.childCount&&!Ct.inlineContent||Ct.isAtom||Ct.type.spec.isolating)return!0;if(Ct.inlineContent)return!1}else if(vt.type.spec.isolating)return!0}return!0}(S)||!function(J){for(let S=J.depth;S>=0;S--){let at=J.indexAfter(S),vt=J.node(S);if(at!=vt.childCount)for(let Ct=vt.child(at);;Ct=Ct.firstChild){if(0==Ct.childCount&&!Ct.inlineContent||Ct.isAtom||Ct.type.spec.isolating)return!0;if(Ct.inlineContent)return!1}else if(vt.type.spec.isolating)return!0}return!0}(S))return!1;let vt=at.type.spec.allowGapCursor;if(null!=vt)return vt;let Ct=at.contentMatchAt(S.index()).defaultType;return Ct&&Ct.isTextblock}static findGapCursorFrom(S,at,vt=!1){t:for(;;){if(!vt&&At.valid(S))return S;let Ct=S.pos,zt=null;for(let Ft=S.depth;;Ft--){let Vt=S.node(Ft);if(at>0?S.indexAfter(Ft)<Vt.childCount:S.index(Ft)>0){zt=Vt.child(at>0?S.indexAfter(Ft):S.index(Ft)-1);break}if(0==Ft)return null;Ct+=at;let ue=S.doc.resolve(Ct);if(At.valid(ue))return ue}for(;;){let Ft=at>0?zt.firstChild:zt.lastChild;if(!Ft){if(zt.isAtom&&!zt.isText&&!Q.qv.isSelectable(zt)){S=S.doc.resolve(Ct+zt.nodeSize*at),vt=!1;continue t}break}zt=Ft,Ct+=at;let Vt=S.doc.resolve(Ct);if(At.valid(Vt))return Vt}return null}}}At.prototype.visible=!1,At.findFrom=At.findGapCursorFrom,Q.Y1.jsonID("gapcursor",At);class Et{constructor(S){this.pos=S}map(S){return new Et(S.map(this.pos))}resolve(S){let at=S.resolve(this.pos);return At.valid(at)?new At(at):Q.Y1.near(at)}}const K=(0,Yt.$)({ArrowLeft:Mt("horiz",-1),ArrowRight:Mt("horiz",1),ArrowUp:Mt("vert",-1),ArrowDown:Mt("vert",1)});function Mt(J,S){const at="vert"==J?S>0?"down":"up":S>0?"right":"left";return function(vt,Ct,zt){let Ft=vt.selection,Vt=S>0?Ft.$to:Ft.$from,ue=Ft.empty;if(Ft instanceof Q.Bs){if(!zt.endOfTextblock(at)||0==Vt.depth)return!1;ue=!1,Vt=vt.doc.resolve(S>0?Vt.after():Vt.before())}let pe=At.findGapCursorFrom(Vt,S,ue);return!!pe&&(Ct&&Ct(vt.tr.setSelection(new At(pe))),!0)}}function Pt(J,S,at){if(!J||!J.editable)return!1;let vt=J.state.doc.resolve(S);if(!At.valid(vt))return!1;let Ct=J.posAtCoords({left:at.clientX,top:at.clientY});return!(Ct&&Ct.inside>-1&&Q.qv.isSelectable(J.state.doc.nodeAt(Ct.inside))||(J.dispatch(J.state.tr.setSelection(new At(vt))),0))}function Kt(J,S){if("insertCompositionText"!=S.inputType||!(J.state.selection instanceof At))return!1;let{$from:at}=J.state.selection,vt=at.parent.contentMatchAt(at.index()).findWrapping(J.state.schema.nodes.text);if(!vt)return!1;let Ct=Zt.HY.empty;for(let Ft=vt.length-1;Ft>=0;Ft--)Ct=Zt.HY.from(vt[Ft].createAndFill(null,Ct));let zt=J.state.tr.replace(at.pos,at.pos,new Zt.p2(Ct,0,0));return zt.setSelection(Q.Bs.near(zt.doc.resolve(at.pos+1))),J.dispatch(zt),!1}function oe(J){if(!(J.selection instanceof At))return null;let S=document.createElement("div");return S.className="ProseMirror-gapcursor",Ht.EH.create(J.doc,[Ht.p.widget(J.selection.head,S,{key:"gapcursor"})])}const Jt=s.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Q.Sy({props:{decorations:oe,createSelectionBetween:(J,S,at)=>S.pos==at.pos&&At.valid(at)?new At(at):null,handleClick:Pt,handleKeyDown:K,handleDOMEvents:{beforeinput:Kt}}})],extendNodeSchema(J){var S;return{allowGapCursor:null!==(S=(0,s.callOrReturn)((0,s.getExtensionField)(J,"allowGapCursor",{name:J.name,options:J.options,storage:J.storage})))&&void 0!==S?S:null}}}),se=s.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:J}){return["br",(0,s.mergeAttributes)(this.options.HTMLAttributes,J)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:J,chain:S,state:at,editor:vt})=>J.first([()=>J.exitCode(),()=>J.command(()=>{const{selection:Ct,storedMarks:zt}=at;if(Ct.$from.parent.type.spec.isolating)return!1;const{keepMarks:Ft}=this.options,{splittableMarks:Vt}=vt.extensionManager,ue=zt||Ct.$to.parentOffset&&Ct.$from.marks();return S().insertContent({type:this.name}).command(({tr:pe,dispatch:ke})=>{if(ke&&ue&&Ft){const ce=ue.filter(Ce=>Vt.includes(Ce.type.name));pe.ensureMarks(ce)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var rt=a(54424),Ut=function(){};Ut.prototype.append=function(S){return S.length?(S=Ut.from(S),!this.length&&S||S.length<200&&this.leafAppend(S)||this.length<200&&S.leafPrepend(this)||this.appendInner(S)):this},Ut.prototype.prepend=function(S){return S.length?Ut.from(S).append(this):this},Ut.prototype.appendInner=function(S){return new fe(this,S)},Ut.prototype.slice=function(S,at){return void 0===S&&(S=0),void 0===at&&(at=this.length),S>=at?Ut.empty:this.sliceInner(Math.max(0,S),Math.min(this.length,at))},Ut.prototype.get=function(S){if(!(S<0||S>=this.length))return this.getInner(S)},Ut.prototype.forEach=function(S,at,vt){void 0===at&&(at=0),void 0===vt&&(vt=this.length),at<=vt?this.forEachInner(S,at,vt,0):this.forEachInvertedInner(S,at,vt,0)},Ut.prototype.map=function(S,at,vt){void 0===at&&(at=0),void 0===vt&&(vt=this.length);var Ct=[];return this.forEach(function(zt,Ft){return Ct.push(S(zt,Ft))},at,vt),Ct},Ut.from=function(S){return S instanceof Ut?S:S&&S.length?new me(S):Ut.empty};var me=function(J){function S(vt){J.call(this),this.values=vt}J&&(S.__proto__=J),(S.prototype=Object.create(J&&J.prototype)).constructor=S;var at={length:{configurable:!0},depth:{configurable:!0}};return S.prototype.flatten=function(){return this.values},S.prototype.sliceInner=function(Ct,zt){return 0==Ct&&zt==this.length?this:new S(this.values.slice(Ct,zt))},S.prototype.getInner=function(Ct){return this.values[Ct]},S.prototype.forEachInner=function(Ct,zt,Ft,Vt){for(var ue=zt;ue<Ft;ue++)if(!1===Ct(this.values[ue],Vt+ue))return!1},S.prototype.forEachInvertedInner=function(Ct,zt,Ft,Vt){for(var ue=zt-1;ue>=Ft;ue--)if(!1===Ct(this.values[ue],Vt+ue))return!1},S.prototype.leafAppend=function(Ct){if(this.length+Ct.length<=200)return new S(this.values.concat(Ct.flatten()))},S.prototype.leafPrepend=function(Ct){if(this.length+Ct.length<=200)return new S(Ct.flatten().concat(this.values))},at.length.get=function(){return this.values.length},at.depth.get=function(){return 0},Object.defineProperties(S.prototype,at),S}(Ut);Ut.empty=new me([]);var fe=function(J){function S(at,vt){J.call(this),this.left=at,this.right=vt,this.length=at.length+vt.length,this.depth=Math.max(at.depth,vt.depth)+1}return J&&(S.__proto__=J),(S.prototype=Object.create(J&&J.prototype)).constructor=S,S.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},S.prototype.getInner=function(vt){return vt<this.left.length?this.left.get(vt):this.right.get(vt-this.left.length)},S.prototype.forEachInner=function(vt,Ct,zt,Ft){var Vt=this.left.length;if(Ct<Vt&&!1===this.left.forEachInner(vt,Ct,Math.min(zt,Vt),Ft)||zt>Vt&&!1===this.right.forEachInner(vt,Math.max(Ct-Vt,0),Math.min(this.length,zt)-Vt,Ft+Vt))return!1},S.prototype.forEachInvertedInner=function(vt,Ct,zt,Ft){var Vt=this.left.length;if(Ct>Vt&&!1===this.right.forEachInvertedInner(vt,Ct-Vt,Math.max(zt,Vt)-Vt,Ft+Vt)||zt<Vt&&!1===this.left.forEachInvertedInner(vt,Math.min(Ct,Vt),zt,Ft))return!1},S.prototype.sliceInner=function(vt,Ct){if(0==vt&&Ct==this.length)return this;var zt=this.left.length;return Ct<=zt?this.left.slice(vt,Ct):vt>=zt?this.right.slice(vt-zt,Ct-zt):this.left.slice(vt,zt).append(this.right.slice(0,Ct-zt))},S.prototype.leafAppend=function(vt){var Ct=this.right.leafAppend(vt);if(Ct)return new S(this.left,Ct)},S.prototype.leafPrepend=function(vt){var Ct=this.left.leafPrepend(vt);if(Ct)return new S(Ct,this.right)},S.prototype.appendInner=function(vt){return this.left.depth>=Math.max(this.right.depth,vt.depth)+1?new S(this.left,new S(this.right,vt)):new S(this,vt)},S}(Ut);const ee=Ut;class Nt{constructor(S,at){this.items=S,this.eventCount=at}popEvent(S,at){if(0==this.eventCount)return null;let Ct,zt,vt=this.items.length;for(;;vt--)if(this.items.get(vt-1).selection){--vt;break}at&&(Ct=this.remapping(vt,this.items.length),zt=Ct.maps.length);let Vt,ue,Ft=S.tr,pe=[],ke=[];return this.items.forEach((ce,Ce)=>{if(!ce.step)return Ct||(Ct=this.remapping(vt,Ce+1),zt=Ct.maps.length),zt--,void ke.push(ce);if(Ct){ke.push(new kt(ce.map));let je,_e=ce.step.map(Ct.slice(zt));_e&&Ft.maybeStep(_e).doc&&(je=Ft.mapping.maps[Ft.mapping.maps.length-1],pe.push(new kt(je,void 0,void 0,pe.length+ke.length))),zt--,je&&Ct.appendMap(je,zt)}else Ft.maybeStep(ce.step);return ce.selection?(Vt=Ct?ce.selection.map(Ct.slice(zt)):ce.selection,ue=new Nt(this.items.slice(0,vt).append(ke.reverse().concat(pe)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:ue,transform:Ft,selection:Vt}}addTransform(S,at,vt,Ct){let zt=[],Ft=this.eventCount,Vt=this.items,ue=!Ct&&Vt.length?Vt.get(Vt.length-1):null;for(let ke=0;ke<S.steps.length;ke++){let _e,ce=S.steps[ke].invert(S.docs[ke]),Ce=new kt(S.mapping.maps[ke],ce,at);(_e=ue&&ue.merge(Ce))&&(Ce=_e,ke?zt.pop():Vt=Vt.slice(0,Vt.length-1)),zt.push(Ce),at&&(Ft++,at=void 0),Ct||(ue=Ce)}let pe=Ft-vt.depth;return pe>re&&(Vt=function(J,S){let at;return J.forEach((vt,Ct)=>{if(vt.selection&&0==S--)return at=Ct,!1}),J.slice(at)}(Vt,pe),Ft-=pe),new Nt(Vt.append(zt),Ft)}remapping(S,at){let vt=new xt.vs;return this.items.forEach((Ct,zt)=>{vt.appendMap(Ct.map,null!=Ct.mirrorOffset&&zt-Ct.mirrorOffset>=S?vt.maps.length-Ct.mirrorOffset:void 0)},S,at),vt}addMaps(S){return 0==this.eventCount?this:new Nt(this.items.append(S.map(at=>new kt(at))),this.eventCount)}rebased(S,at){if(!this.eventCount)return this;let vt=[],Ct=Math.max(0,this.items.length-at),zt=S.mapping,Ft=S.steps.length,Vt=this.eventCount;this.items.forEach(Ce=>{Ce.selection&&Vt--},Ct);let ue=at;this.items.forEach(Ce=>{let _e=zt.getMirror(--ue);if(null==_e)return;Ft=Math.min(Ft,_e);let je=zt.maps[_e];if(Ce.step){let Be=S.steps[_e].invert(S.docs[_e]),nn=Ce.selection&&Ce.selection.map(zt.slice(ue+1,_e));nn&&Vt++,vt.push(new kt(je,Be,nn))}else vt.push(new kt(je))},Ct);let pe=[];for(let Ce=at;Ce<Ft;Ce++)pe.push(new kt(zt.maps[Ce]));let ke=this.items.slice(0,Ct).append(pe).append(vt),ce=new Nt(ke,Vt);return ce.emptyItemCount()>500&&(ce=ce.compress(this.items.length-vt.length)),ce}emptyItemCount(){let S=0;return this.items.forEach(at=>{at.step||S++}),S}compress(S=this.items.length){let at=this.remapping(0,S),vt=at.maps.length,Ct=[],zt=0;return this.items.forEach((Ft,Vt)=>{if(Vt>=S)Ct.push(Ft),Ft.selection&&zt++;else if(Ft.step){let ue=Ft.step.map(at.slice(vt)),pe=ue&&ue.getMap();if(vt--,pe&&at.appendMap(pe,vt),ue){let ke=Ft.selection&&Ft.selection.map(at.slice(vt));ke&&zt++;let Ce,ce=new kt(pe.invert(),ue,ke),_e=Ct.length-1;(Ce=Ct.length&&Ct[_e].merge(ce))?Ct[_e]=Ce:Ct.push(ce)}}else Ft.map&&vt--},this.items.length,0),new Nt(ee.from(Ct.reverse()),zt)}}Nt.empty=new Nt(ee.empty,0);class kt{constructor(S,at,vt,Ct){this.map=S,this.step=at,this.selection=vt,this.mirrorOffset=Ct}merge(S){if(this.step&&S.step&&!S.selection){let at=S.step.merge(this.step);if(at)return new kt(at.getMap().invert(),at,this.selection)}}}class jt{constructor(S,at,vt,Ct,zt){this.done=S,this.undone=at,this.prevRanges=vt,this.prevTime=Ct,this.prevComposition=zt}}const re=20;function Ne(J){let S=[];return J.forEach((at,vt,Ct,zt)=>S.push(Ct,zt)),S}function xe(J,S){if(!J)return null;let at=[];for(let vt=0;vt<J.length;vt+=2){let Ct=S.map(J[vt],1),zt=S.map(J[vt+1],-1);Ct<=zt&&at.push(Ct,zt)}return at}function Ie(J,S,at,vt){let Ct=De(S),zt=Te.get(S).spec.config,Ft=(vt?J.undone:J.done).popEvent(S,Ct);if(!Ft)return;let Vt=Ft.selection.resolve(Ft.transform.doc),ue=(vt?J.done:J.undone).addTransform(Ft.transform,S.selection.getBookmark(),zt,Ct),pe=new jt(vt?ue:Ft.remaining,vt?Ft.remaining:ue,null,0,-1);at(Ft.transform.setSelection(Vt).setMeta(Te,{redo:vt,historyState:pe}).scrollIntoView())}let Ze=!1,Fe=null;function De(J){let S=J.plugins;if(Fe!=S){Ze=!1,Fe=S;for(let at=0;at<S.length;at++)if(S[at].spec.historyPreserveItems){Ze=!0;break}}return Ze}const Te=new Q.H$("history"),Le=new Q.H$("closeHistory");function be(J={}){return new Q.Sy({key:Te,state:{init:()=>new jt(Nt.empty,Nt.empty,null,0,-1),apply:(S,at,vt)=>function(J,S,at,vt){let zt,Ct=at.getMeta(Te);if(Ct)return Ct.historyState;at.getMeta(Le)&&(J=new jt(J.done,J.undone,null,0,-1));let Ft=at.getMeta("appendedTransaction");if(0==at.steps.length)return J;if(Ft&&Ft.getMeta(Te))return Ft.getMeta(Te).redo?new jt(J.done.addTransform(at,void 0,vt,De(S)),J.undone,Ne(at.mapping.maps[at.steps.length-1]),J.prevTime,J.prevComposition):new jt(J.done,J.undone.addTransform(at,void 0,vt,De(S)),null,J.prevTime,J.prevComposition);if(!1===at.getMeta("addToHistory")||Ft&&!1===Ft.getMeta("addToHistory"))return(zt=at.getMeta("rebased"))?new jt(J.done.rebased(at,zt),J.undone.rebased(at,zt),xe(J.prevRanges,at.mapping),J.prevTime,J.prevComposition):new jt(J.done.addMaps(at.mapping.maps),J.undone.addMaps(at.mapping.maps),xe(J.prevRanges,at.mapping),J.prevTime,J.prevComposition);{let Vt=at.getMeta("composition"),ue=0==J.prevTime||!Ft&&J.prevComposition!=Vt&&(J.prevTime<(at.time||0)-vt.newGroupDelay||!function(J,S){if(!S)return!1;if(!J.docChanged)return!0;let at=!1;return J.mapping.maps[0].forEach((vt,Ct)=>{for(let zt=0;zt<S.length;zt+=2)vt<=S[zt+1]&&Ct>=S[zt]&&(at=!0)}),at}(at,J.prevRanges)),pe=Ft?xe(J.prevRanges,at.mapping):Ne(at.mapping.maps[at.steps.length-1]);return new jt(J.done.addTransform(at,ue?S.selection.getBookmark():void 0,vt,De(S)),Nt.empty,pe,at.time,null==Vt?J.prevComposition:Vt)}}(at,vt,S,J)},config:J={depth:J.depth||100,newGroupDelay:J.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(S,at){let vt=at.inputType,Ct="historyUndo"==vt?Oe:"historyRedo"==vt?ht:null;return!!Ct&&(at.preventDefault(),Ct(S.state,S.dispatch))}}}})}const Oe=(J,S)=>{let at=Te.getState(J);return!(!at||0==at.done.eventCount||(S&&Ie(at,J,S,!1),0))},ht=(J,S)=>{let at=Te.getState(J);return!(!at||0==at.undone.eventCount||(S&&Ie(at,J,S,!0),0))},b=s.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:J,dispatch:S})=>Oe(J,S),redo:()=>({state:J,dispatch:S})=>ht(J,S)}),addProseMirrorPlugins(){return[be(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),B=s.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:J}){return["hr",(0,s.mergeAttributes)(this.options.HTMLAttributes,J)]},addCommands(){return{setHorizontalRule:()=>({chain:J})=>J().insertContent({type:this.name}).command(({tr:S,dispatch:at})=>{var vt;if(at){const{$to:Ct}=S.selection,zt=Ct.end();if(Ct.nodeAfter)S.setSelection(Q.Bs.create(S.doc,Ct.pos));else{const Ft=null===(vt=Ct.parent.type.contentMatch.defaultType)||void 0===vt?void 0:vt.create();Ft&&(S.insert(zt,Ft),S.setSelection(Q.Bs.create(S.doc,zt)))}S.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,s.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),D=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,V=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,mt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Dt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,R=s.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:J=>"normal"!==J.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:J}){return["em",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setItalic:()=>({commands:J})=>J.setMark(this.name),toggleItalic:()=>({commands:J})=>J.toggleMark(this.name),unsetItalic:()=>({commands:J})=>J.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,s.markInputRule)({find:D,type:this.type}),(0,s.markInputRule)({find:mt,type:this.type})]},addPasteRules(){return[(0,s.markPasteRule)({find:V,type:this.type}),(0,s.markPasteRule)({find:Dt,type:this.type})]}}),l=s.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:J}){return["li",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),d=s.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:J}){return["li",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),y=s.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:J=>!!J.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:J}){return["span",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:J,commands:S})=>{const at=(0,s.getMarkAttributes)(J,this.type);return!!Object.entries(at).some(([,Ct])=>!!Ct)||S.unsetMark(this.name)}}}}),O=/^(\d+)\.\s$/,w=s.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:J=>J.hasAttribute("start")?parseInt(J.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:J}){const vt=J,{start:S}=vt,at=Xo(vt,["start"]);return 1===S?["ol",(0,s.mergeAttributes)(this.options.HTMLAttributes,at),0]:["ol",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{toggleOrderedList:()=>({commands:J,chain:S})=>this.options.keepAttributes?S().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(d.name,this.editor.getAttributes(y.name)).run():J.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let J=(0,s.wrappingInputRule)({find:O,type:this.type,getAttributes:S=>({start:+S[1]}),joinPredicate:(S,at)=>at.childCount+at.attrs.start===+S[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(J=(0,s.wrappingInputRule)({find:O,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:S=>Xt({start:+S[1]},this.editor.getAttributes(y.name)),joinPredicate:(S,at)=>at.childCount+at.attrs.start===+S[1],editor:this.editor})),[J]}}),z=s.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:J}){return["p",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setParagraph:()=>({commands:J})=>J.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),dt=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,St=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ne=s.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:J=>!!J.includes("line-through")&&{}}],renderHTML({HTMLAttributes:J}){return["s",(0,s.mergeAttributes)(this.options.HTMLAttributes,J),0]},addCommands(){return{setStrike:()=>({commands:J})=>J.setMark(this.name),toggleStrike:()=>({commands:J})=>J.toggleMark(this.name),unsetStrike:()=>({commands:J})=>J.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,s.markInputRule)({find:dt,type:this.type})]},addPasteRules(){return[(0,s.markPasteRule)({find:St,type:this.type})]}}),te=s.Node.create({name:"text",group:"inline"}),Pe=s.Extension.create({name:"starterKit",addExtensions(){const J=[],S=this.options;return!1!==(null==S?void 0:S.blockquote)&&J.push($.configure(null==S?void 0:S.blockquote)),!1!==(null==S?void 0:S.bold)&&J.push(nt.configure(null==S?void 0:S.bold)),!1!==(null==S?void 0:S.bulletList)&&J.push(pt.configure(null==S?void 0:S.bulletList)),!1!==(null==S?void 0:S.code)&&J.push(st.configure(null==S?void 0:S.code)),!1!==(null==S?void 0:S.codeBlock)&&J.push(ut.configure(null==S?void 0:S.codeBlock)),!1!==(null==S?void 0:S.document)&&J.push(ot.configure(null==S?void 0:S.document)),!1!==(null==S?void 0:S.dropcursor)&&J.push(Rt.configure(null==S?void 0:S.dropcursor)),!1!==(null==S?void 0:S.gapcursor)&&J.push(Jt.configure(null==S?void 0:S.gapcursor)),!1!==(null==S?void 0:S.hardBreak)&&J.push(se.configure(null==S?void 0:S.hardBreak)),!1!==(null==S?void 0:S.heading)&&J.push(rt.Heading.configure(null==S?void 0:S.heading)),!1!==(null==S?void 0:S.history)&&J.push(b.configure(Object.assign({depth:10,newGroupDelay:100},null==S?void 0:S.history))),!1!==(null==S?void 0:S.horizontalRule)&&J.push(B.configure(null==S?void 0:S.horizontalRule)),!1!==(null==S?void 0:S.italic)&&J.push(R.configure(null==S?void 0:S.italic)),!1!==(null==S?void 0:S.listItem)&&J.push(l.configure(null==S?void 0:S.listItem)),!1!==(null==S?void 0:S.orderedList)&&J.push(w.configure(null==S?void 0:S.orderedList)),!1!==(null==S?void 0:S.paragraph)&&J.push(z.configure(null==S?void 0:S.paragraph)),!1!==(null==S?void 0:S.strike)&&J.push(ne.configure(null==S?void 0:S.strike)),!1!==(null==S?void 0:S.text)&&J.push(te.configure(null==S?void 0:S.text)),J}})},58676:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TableCellBackground:()=>c});const c=a(11046).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:$})=>$?{style:`background: ${$}`}:null,parseHTML:({style:$})=>$.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:$=>({chain:I})=>I().updateAttributes("tableCell",{background:$}).updateAttributes("tableHeader",{background:$}).run(),unsetCellBackground:()=>({chain:$})=>$().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},14739:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TuiTable:()=>Qe});var F,nt,s=a(11046),c=a(62463),$=a(27439),I=a(43594),_=a(31690),j=a(38480);if("undefined"!=typeof WeakMap){let g=new WeakMap;F=v=>g.get(v),nt=(v,m)=>(g.set(v,m),m)}else{const g=[],v=10;let m=0;F=h=>{for(let T=0;T<g.length;T+=2)if(g[T]==h)return g[T+1]},nt=(h,T)=>(m==v&&(m=0),g[m++]=h,g[m++]=T)}var Y=class{constructor(g,v,m,h){this.width=g,this.height=v,this.map=m,this.problems=h}findCell(g){for(let v=0;v<this.map.length;v++){const m=this.map[v];if(m!=g)continue;const h=v%this.width,T=v/this.width|0;let E=h+1,N=T+1;for(let Z=1;E<this.width&&this.map[v+Z]==m;Z++)E++;for(let Z=1;N<this.height&&this.map[v+this.width*Z]==m;Z++)N++;return{left:h,top:T,right:E,bottom:N}}throw new RangeError(`No cell with offset ${g} found`)}colCount(g){for(let v=0;v<this.map.length;v++)if(this.map[v]==g)return v%this.width;throw new RangeError(`No cell with offset ${g} found`)}nextCell(g,v,m){const{left:h,right:T,top:E,bottom:N}=this.findCell(g);return"horiz"==v?(m<0?0==h:T==this.width)?null:this.map[E*this.width+(m<0?h-1:T)]:(m<0?0==E:N==this.height)?null:this.map[h+this.width*(m<0?E-1:N)]}rectBetween(g,v){const{left:m,right:h,top:T,bottom:E}=this.findCell(g),{left:N,right:Z,top:L,bottom:G}=this.findCell(v);return{left:Math.min(m,N),top:Math.min(T,L),right:Math.max(h,Z),bottom:Math.max(E,G)}}cellsInRect(g){const v=[],m={};for(let h=g.top;h<g.bottom;h++)for(let T=g.left;T<g.right;T++){const E=h*this.width+T,N=this.map[E];m[N]||(m[N]=!0,!(T==g.left&&T&&this.map[E-1]==N||h==g.top&&h&&this.map[E-this.width]==N)&&v.push(N))}return v}positionAt(g,v,m){for(let h=0,T=0;;h++){const E=T+m.child(h).nodeSize;if(h==g){let N=v+g*this.width;const Z=(g+1)*this.width;for(;N<Z&&this.map[N]<T;)N++;return N==Z?E-1:this.map[N]}T=E}}static get(g){return F(g)||nt(g,function(g){if("table"!=g.type.spec.tableRole)throw new RangeError("Not a table node: "+g.type.name);const v=function(g){let v=-1,m=!1;for(let h=0;h<g.childCount;h++){const T=g.child(h);let E=0;if(m)for(let N=0;N<h;N++){const Z=g.child(N);for(let L=0;L<Z.childCount;L++){const G=Z.child(L);N+G.attrs.rowspan>h&&(E+=G.attrs.colspan)}}for(let N=0;N<T.childCount;N++){const Z=T.child(N);E+=Z.attrs.colspan,Z.attrs.rowspan>1&&(m=!0)}-1==v?v=E:v!=E&&(v=Math.max(v,E))}return v}(g),m=g.childCount,h=[];let T=0,E=null;const N=[];for(let G=0,gt=v*m;G<gt;G++)h[G]=0;for(let G=0,gt=0;G<m;G++){const Tt=g.child(G);gt++;for(let Qt=0;;Qt++){for(;T<h.length&&0!=h[T];)T++;if(Qt==Tt.childCount)break;const le=Tt.child(Qt),{colspan:ie,rowspan:we,colwidth:qe}=le.attrs;for(let Ke=0;Ke<we;Ke++){if(Ke+G>=m){(E||(E=[])).push({type:"overlong_rowspan",pos:gt,n:we-Ke});break}const Ee=T+Ke*v;for(let Ae=0;Ae<ie;Ae++){0==h[Ee+Ae]?h[Ee+Ae]=gt:(E||(E=[])).push({type:"collision",row:G,pos:gt,n:ie-Ae});const tn=qe&&qe[Ae];if(tn){const Ge=(Ee+Ae)%v*2,he=N[Ge];null==he||he!=tn&&1==N[Ge+1]?(N[Ge]=tn,N[Ge+1]=1):he==tn&&N[Ge+1]++}}}T+=ie,gt+=le.nodeSize}const wt=(G+1)*v;let Lt=0;for(;T<wt;)0==h[T++]&&Lt++;Lt&&(E||(E=[])).push({type:"missing",row:G,n:Lt}),gt++}const Z=new Y(v,m,h,E);let L=!1;for(let G=0;!L&&G<N.length;G+=2)null!=N[G]&&N[G+1]<m&&(L=!0);return L&&function(g,v,m){g.problems||(g.problems=[]);const h={};for(let T=0;T<g.map.length;T++){const E=g.map[T];if(h[E])continue;h[E]=!0;const N=m.nodeAt(E);if(!N)throw new RangeError(`No cell with offset ${E} found`);let Z=null;const L=N.attrs;for(let G=0;G<L.colspan;G++){const Tt=v[(T+G)%g.width*2];null!=Tt&&(!L.colwidth||L.colwidth[G]!=Tt)&&((Z||(Z=Ot(L)))[G]=Tt)}Z&&g.problems.unshift({type:"colwidth mismatch",pos:E,colwidth:Z})}}(Z,N,g),Z}(g))}};function Ot(g){if(g.colwidth)return g.colwidth.slice();const v=[];for(let m=0;m<g.colspan;m++)v.push(0);return v}function W(g){let v=g.cached.tableNodeTypes;if(!v){v=g.cached.tableNodeTypes={};for(const m in g.nodes){const h=g.nodes[m],T=h.spec.tableRole;T&&(v[T]=h)}}return v}var tt=new c.H$("selectingCells");function ut(g){for(let v=g.depth-1;v>0;v--)if("row"==g.node(v).type.spec.tableRole)return g.node(0).resolve(g.before(v+1));return null}function xt(g){const v=g.selection.$head;for(let m=v.depth;m>0;m--)if("row"==v.node(m).type.spec.tableRole)return!0;return!1}function bt(g){const v=g.selection;if("$anchorCell"in v&&v.$anchorCell)return v.$anchorCell.pos>v.$headCell.pos?v.$anchorCell:v.$headCell;if("node"in v&&v.node&&"cell"==v.node.type.spec.tableRole)return v.$anchor;const m=ut(v.$head)||function(g){for(let v=g.nodeAfter,m=g.pos;v;v=v.firstChild,m++){const h=v.type.spec.tableRole;if("cell"==h||"header_cell"==h)return g.doc.resolve(m)}for(let v=g.nodeBefore,m=g.pos;v;v=v.lastChild,m--){const h=v.type.spec.tableRole;if("cell"==h||"header_cell"==h)return g.doc.resolve(m-v.nodeSize)}}(v.$head);if(m)return m;throw new RangeError(`No cell found around position ${v.head}`)}function Rt(g){return"row"==g.parent.type.spec.tableRole&&!!g.nodeAfter}function Zt(g,v){return g.depth==v.depth&&g.pos>=v.start(-1)&&g.pos<=v.end(-1)}function Et(g,v,m){const h=g.node(-1),T=Y.get(h),E=g.start(-1),N=T.nextCell(g.pos-E,v,m);return null==N?null:g.node(0).resolve(E+N)}function X(g,v,m=1){const h=ye(Xt({},g),{colspan:g.colspan-m});return h.colwidth&&(h.colwidth=h.colwidth.slice(),h.colwidth.splice(v,m),h.colwidth.some(T=>T>0)||(h.colwidth=null)),h}function P(g,v,m=1){const h=ye(Xt({},g),{colspan:g.colspan+m});if(h.colwidth){h.colwidth=h.colwidth.slice();for(let T=0;T<m;T++)h.colwidth.splice(v,0,0)}return h}var K=class extends c.Y1{constructor(g,v=g){const m=g.node(-1),h=Y.get(m),T=g.start(-1),E=h.rectBetween(g.pos-T,v.pos-T),N=g.node(0),Z=h.cellsInRect(E).filter(G=>G!=v.pos-T);Z.unshift(v.pos-T);const L=Z.map(G=>{const gt=m.nodeAt(G);if(!gt)throw RangeError(`No cell with offset ${G} found`);const Tt=T+G+1;return new c.xm(N.resolve(Tt),N.resolve(Tt+gt.content.size))});super(L[0].$from,L[0].$to,L),this.$anchorCell=g,this.$headCell=v}map(g,v){const m=g.resolve(v.map(this.$anchorCell.pos)),h=g.resolve(v.map(this.$headCell.pos));if(Rt(m)&&Rt(h)&&Zt(m,h)){const T=this.$anchorCell.node(-1)!=m.node(-1);return T&&this.isRowSelection()?K.rowSelection(m,h):T&&this.isColSelection()?K.colSelection(m,h):new K(m,h)}return c.Bs.between(m,h)}content(){const g=this.$anchorCell.node(-1),v=Y.get(g),m=this.$anchorCell.start(-1),h=v.rectBetween(this.$anchorCell.pos-m,this.$headCell.pos-m),T={},E=[];for(let Z=h.top;Z<h.bottom;Z++){const L=[];for(let G=Z*v.width+h.left,gt=h.left;gt<h.right;gt++,G++){const Tt=v.map[G];if(T[Tt])continue;T[Tt]=!0;const wt=v.findCell(Tt);let Lt=g.nodeAt(Tt);if(!Lt)throw RangeError(`No cell with offset ${Tt} found`);const Qt=h.left-wt.left,le=wt.right-h.right;if(Qt>0||le>0){let ie=Lt.attrs;if(Qt>0&&(ie=X(ie,0,Qt)),le>0&&(ie=X(ie,ie.colspan-le,le)),wt.left<h.left){if(Lt=Lt.type.createAndFill(ie),!Lt)throw RangeError(`Could not create cell with attrs ${JSON.stringify(ie)}`)}else Lt=Lt.type.create(ie,Lt.content)}if(wt.top<h.top||wt.bottom>h.bottom){const ie=ye(Xt({},Lt.attrs),{rowspan:Math.min(wt.bottom,h.bottom)-Math.max(wt.top,h.top)});Lt=wt.top<h.top?Lt.type.createAndFill(ie):Lt.type.create(ie,Lt.content)}L.push(Lt)}E.push(g.child(Z).copy($.HY.from(L)))}const N=this.isColSelection()&&this.isRowSelection()?g:E;return new $.p2($.HY.from(N),1,1)}replace(g,v=$.p2.empty){const m=g.steps.length,h=this.ranges;for(let E=0;E<h.length;E++){const{$from:N,$to:Z}=h[E],L=g.mapping.slice(m);g.replace(L.map(N.pos),L.map(Z.pos),E?$.p2.empty:v)}const T=c.Y1.findFrom(g.doc.resolve(g.mapping.slice(m).map(this.to)),-1);T&&g.setSelection(T)}replaceWith(g,v){this.replace(g,new $.p2($.HY.from(v),0,0))}forEachCell(g){const v=this.$anchorCell.node(-1),m=Y.get(v),h=this.$anchorCell.start(-1),T=m.cellsInRect(m.rectBetween(this.$anchorCell.pos-h,this.$headCell.pos-h));for(let E=0;E<T.length;E++)g(v.nodeAt(T[E]),h+T[E])}isColSelection(){const g=this.$anchorCell.index(-1),v=this.$headCell.index(-1);return!(Math.min(g,v)>0)&&Math.max(g+this.$anchorCell.nodeAfter.attrs.rowspan,v+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(g,v=g){const m=g.node(-1),h=Y.get(m),T=g.start(-1),E=h.findCell(g.pos-T),N=h.findCell(v.pos-T),Z=g.node(0);return E.top<=N.top?(E.top>0&&(g=Z.resolve(T+h.map[E.left])),N.bottom<h.height&&(v=Z.resolve(T+h.map[h.width*(h.height-1)+N.right-1]))):(N.top>0&&(v=Z.resolve(T+h.map[N.left])),E.bottom<h.height&&(g=Z.resolve(T+h.map[h.width*(h.height-1)+E.right-1]))),new K(g,v)}isRowSelection(){const g=this.$anchorCell.node(-1),v=Y.get(g),m=this.$anchorCell.start(-1),h=v.colCount(this.$anchorCell.pos-m),T=v.colCount(this.$headCell.pos-m);return!(Math.min(h,T)>0)&&Math.max(h+this.$anchorCell.nodeAfter.attrs.colspan,T+this.$headCell.nodeAfter.attrs.colspan)==v.width}eq(g){return g instanceof K&&g.$anchorCell.pos==this.$anchorCell.pos&&g.$headCell.pos==this.$headCell.pos}static rowSelection(g,v=g){const m=g.node(-1),h=Y.get(m),T=g.start(-1),E=h.findCell(g.pos-T),N=h.findCell(v.pos-T),Z=g.node(0);return E.left<=N.left?(E.left>0&&(g=Z.resolve(T+h.map[E.top*h.width])),N.right<h.width&&(v=Z.resolve(T+h.map[h.width*(N.top+1)-1]))):(N.left>0&&(v=Z.resolve(T+h.map[N.top*h.width])),E.right<h.width&&(g=Z.resolve(T+h.map[h.width*(E.top+1)-1]))),new K(g,v)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(g,v){return new K(g.resolve(v.anchor),g.resolve(v.head))}static create(g,v,m=v){return new K(g.resolve(v),g.resolve(m))}getBookmark(){return new Mt(this.$anchorCell.pos,this.$headCell.pos)}};K.prototype.visible=!1,c.Y1.jsonID("cell",K);var Mt=class{constructor(g,v){this.anchor=g,this.head=v}map(g){return new Mt(g.map(this.anchor),g.map(this.head))}resolve(g){const v=g.resolve(this.anchor),m=g.resolve(this.head);return"row"==v.parent.type.spec.tableRole&&"row"==m.parent.type.spec.tableRole&&v.index()<v.parent.childCount&&m.index()<m.parent.childCount&&Zt(v,m)?new K(v,m):c.Y1.near(m,1)}};function Pt(g){if(!(g.selection instanceof K))return null;const v=[];return g.selection.forEachCell((m,h)=>{v.push(I.p.node(h,h+m.nodeSize,{class:"selectedCell"}))}),I.EH.create(g.doc,v)}var se=new c.H$("fix-tables");function rt(g,v,m,h){const T=g.childCount,E=v.childCount;t:for(let N=0,Z=0;N<E;N++){const L=v.child(N);for(let G=Z,gt=Math.min(T,N+3);G<gt;G++)if(g.child(G)==L){Z=G+1,m+=L.nodeSize;continue t}h(L,m),Z<T&&g.child(Z).sameMarkup(L)?rt(g.child(Z),L,m+1,h):L.nodesBetween(0,L.content.size,h,m+1),m+=L.nodeSize}}function It(g,v){let m;const h=(T,E)=>{"table"==T.type.spec.tableRole&&(m=function(g,v,m,h){const T=Y.get(v);if(!T.problems)return h;h||(h=g.tr);const E=[];for(let L=0;L<T.height;L++)E.push(0);for(let L=0;L<T.problems.length;L++){const G=T.problems[L];if("collision"==G.type){const gt=v.nodeAt(G.pos);if(!gt)continue;const Tt=gt.attrs;for(let wt=0;wt<Tt.rowspan;wt++)E[G.row+wt]+=G.n;h.setNodeMarkup(h.mapping.map(m+1+G.pos),null,X(Tt,Tt.colspan-G.n,G.n))}else if("missing"==G.type)E[G.row]+=G.n;else if("overlong_rowspan"==G.type){const gt=v.nodeAt(G.pos);if(!gt)continue;h.setNodeMarkup(h.mapping.map(m+1+G.pos),null,ye(Xt({},gt.attrs),{rowspan:gt.attrs.rowspan-G.n}))}else if("colwidth mismatch"==G.type){const gt=v.nodeAt(G.pos);if(!gt)continue;h.setNodeMarkup(h.mapping.map(m+1+G.pos),null,ye(Xt({},gt.attrs),{colwidth:G.colwidth}))}}let N,Z;for(let L=0;L<E.length;L++)E[L]&&(null==N&&(N=L),Z=L);for(let L=0,G=m+1;L<T.height;L++){const gt=v.child(L),Tt=G+gt.nodeSize,wt=E[L];if(wt>0){let Lt="cell";gt.firstChild&&(Lt=gt.firstChild.type.spec.tableRole);const Qt=[];for(let ie=0;ie<wt;ie++){const we=W(g.schema)[Lt].createAndFill();we&&Qt.push(we)}h.insert(h.mapping.map(0!=L&&N!=L-1||Z!=L?Tt-1:G+1),Qt)}G=Tt}return h.setMeta(se,{fixTables:!0})}(g,T,E,m))};return v?v.doc!=g.doc&&rt(v.doc,g.doc,0,h):g.doc.descendants(h),m}function ee(g,v){const m=g.createAndFill();return new j.wx(m).replace(0,m.content.size,v).doc}function qt(g,v,m,h,T,E,N,Z){if(0==N||N==v.height)return!1;let L=!1;for(let G=T;G<E;G++){const gt=N*v.width+G,Tt=v.map[gt];if(v.map[gt-v.width]==Tt){L=!0;const wt=m.nodeAt(Tt),{top:Lt,left:Qt}=v.findCell(Tt);g.setNodeMarkup(g.mapping.slice(Z).map(Tt+h),null,ye(Xt({},wt.attrs),{rowspan:N-Lt})),g.insert(g.mapping.slice(Z).map(v.positionAt(N,Qt,m)),wt.type.createAndFill(ye(Xt({},wt.attrs),{rowspan:Lt+wt.attrs.rowspan-N}))),G+=wt.attrs.colspan-1}}return L}function kt(g,v,m,h,T,E,N,Z){if(0==N||N==v.width)return!1;let L=!1;for(let G=T;G<E;G++){const gt=G*v.width+N,Tt=v.map[gt];if(v.map[gt-1]==Tt){L=!0;const wt=m.nodeAt(Tt),Lt=v.colCount(Tt),Qt=g.mapping.slice(Z).map(Tt+h);g.setNodeMarkup(Qt,null,X(wt.attrs,N-Lt,wt.attrs.colspan-(N-Lt))),g.insert(Qt+wt.nodeSize,wt.type.createAndFill(X(wt.attrs,0,N-Lt))),G+=wt.attrs.rowspan-1}}return L}function jt(g,v,m,h,T){let E=m?g.doc.nodeAt(m-1):g.doc;if(!E)throw new Error("No table found");let N=Y.get(E);const{top:Z,left:L}=h,G=L+T.width,gt=Z+T.height,Tt=g.tr;let wt=0;function Lt(){if(E=m?Tt.doc.nodeAt(m-1):Tt.doc,!E)throw new Error("No table found");N=Y.get(E),wt=Tt.mapping.maps.length}(function(g,v,m,h,T,E,N){const L=W(g.doc.type.schema);let G,gt;if(T>v.width)for(let Tt=0,wt=0;Tt<v.height;Tt++){const Lt=m.child(Tt);wt+=Lt.nodeSize;const Qt=[];let le;le=null==Lt.lastChild||Lt.lastChild.type==L.cell?G||(G=L.cell.createAndFill()):gt||(gt=L.header_cell.createAndFill());for(let ie=v.width;ie<T;ie++)Qt.push(le);g.insert(g.mapping.slice(N).map(wt-1+h),Qt)}if(E>v.height){const Tt=[];for(let Qt=0,le=(v.height-1)*v.width;Qt<Math.max(v.width,T);Qt++){const ie=!(Qt>=v.width)&&m.nodeAt(v.map[le+Qt]).type==L.header_cell;Tt.push(ie?gt||(gt=L.header_cell.createAndFill()):G||(G=L.cell.createAndFill()))}const wt=L.row.create(null,$.HY.from(Tt)),Lt=[];for(let Qt=v.height;Qt<E;Qt++)Lt.push(wt);g.insert(g.mapping.slice(N).map(h+m.nodeSize-2),Lt)}return!(!G&&!gt)})(Tt,N,E,m,G,gt,wt)&&Lt(),qt(Tt,N,E,m,L,G,Z,wt)&&Lt(),qt(Tt,N,E,m,L,G,gt,wt)&&Lt(),kt(Tt,N,E,m,Z,gt,L,wt)&&Lt(),kt(Tt,N,E,m,Z,gt,G,wt)&&Lt();for(let Qt=Z;Qt<gt;Qt++){const le=N.positionAt(Qt,L,E),ie=N.positionAt(Qt,G,E);Tt.replace(Tt.mapping.slice(wt).map(le+m),Tt.mapping.slice(wt).map(ie+m),new $.p2(T.rows[Qt-Z],0,0))}Lt(),Tt.setSelection(new K(Tt.doc.resolve(m+N.positionAt(Z,L,E)),Tt.doc.resolve(m+N.positionAt(gt-1,G-1,E)))),v(Tt)}var re=(0,_.$)({ArrowLeft:Me("horiz",-1),ArrowRight:Me("horiz",1),ArrowUp:Me("vert",-1),ArrowDown:Me("vert",1),"Shift-ArrowLeft":Ne("horiz",-1),"Shift-ArrowRight":Ne("horiz",1),"Shift-ArrowUp":Ne("vert",-1),"Shift-ArrowDown":Ne("vert",1),Backspace:xe,"Mod-Backspace":xe,Delete:xe,"Mod-Delete":xe});function ae(g,v,m){return!m.eq(g.selection)&&(v&&v(g.tr.setSelection(m).scrollIntoView()),!0)}function Me(g,v){return(m,h,T)=>{if(!T)return!1;const E=m.selection;if(E instanceof K)return ae(m,h,c.Y1.near(E.$headCell,v));if("horiz"!=g&&!E.empty)return!1;const N=De(T,g,v);if(null==N)return!1;if("horiz"==g)return ae(m,h,c.Y1.near(m.doc.resolve(E.head+v),v));{const Z=m.doc.resolve(N),L=Et(Z,g,v);let G;return G=L?c.Y1.near(L,1):v<0?c.Y1.near(m.doc.resolve(Z.before(-1)),-1):c.Y1.near(m.doc.resolve(Z.after(-1)),1),ae(m,h,G)}}}function Ne(g,v){return(m,h,T)=>{if(!T)return!1;const E=m.selection;let N;if(E instanceof K)N=E;else{const L=De(T,g,v);if(null==L)return!1;N=new K(m.doc.resolve(L))}const Z=Et(N.$headCell,g,v);return!!Z&&ae(m,h,new K(N.$anchorCell,Z))}}function xe(g,v){const m=g.selection;if(!(m instanceof K))return!1;if(v){const h=g.tr,T=W(g.schema).cell.createAndFill().content;m.forEachCell((E,N)=>{E.content.eq(T)||h.replace(h.mapping.map(N+1),h.mapping.map(N+E.nodeSize-1),new $.p2(T,0,0))}),h.docChanged&&v(h)}return!0}function Ie(g,v){const h=ut(g.state.doc.resolve(v));return!!h&&(g.dispatch(g.state.tr.setSelection(new K(h))),!0)}function Ze(g,v,m){if(!xt(g.state))return!1;let h=function(g){if(!g.size)return null;let{content:v,openStart:m,openEnd:h}=g;for(;1==v.childCount&&(m>0&&h>0||"table"==v.child(0).type.spec.tableRole);)m--,h--,v=v.child(0).content;const T=v.child(0),E=T.type.spec.tableRole,N=T.type.schema,Z=[];if("row"==E)for(let L=0;L<v.childCount;L++){let G=v.child(L).content;const gt=L?0:Math.max(0,m-1),Tt=L<v.childCount-1?0:Math.max(0,h-1);(gt||Tt)&&(G=ee(W(N).row,new $.p2(G,gt,Tt)).content),Z.push(G)}else{if("cell"!=E&&"header_cell"!=E)return null;Z.push(m||h?ee(W(N).row,new $.p2(v,m,h)).content:v)}return function(g,v){const m=[];for(let T=0;T<v.length;T++){const E=v[T];for(let N=E.childCount-1;N>=0;N--){const{rowspan:Z,colspan:L}=E.child(N).attrs;for(let G=T;G<T+Z;G++)m[G]=(m[G]||0)+L}}let h=0;for(let T=0;T<m.length;T++)h=Math.max(h,m[T]);for(let T=0;T<m.length;T++)if(T>=v.length&&v.push($.HY.empty),m[T]<h){const E=W(g).cell.createAndFill(),N=[];for(let Z=m[T];Z<h;Z++)N.push(E);v[T]=v[T].append($.HY.from(N))}return{height:v.length,width:h,rows:v}}(N,Z)}(m);const T=g.state.selection;if(T instanceof K){h||(h={width:1,height:1,rows:[$.HY.from(ee(W(g.state.schema).cell,m))]});const E=T.$anchorCell.node(-1),N=T.$anchorCell.start(-1),Z=Y.get(E).rectBetween(T.$anchorCell.pos-N,T.$headCell.pos-N);return h=function({width:g,height:v,rows:m},h,T){if(g!=h){const E=[],N=[];for(let Z=0;Z<m.length;Z++){const L=m[Z],G=[];for(let gt=E[Z]||0,Tt=0;gt<h;Tt++){let wt=L.child(Tt%L.childCount);gt+wt.attrs.colspan>h&&(wt=wt.type.createChecked(X(wt.attrs,wt.attrs.colspan,gt+wt.attrs.colspan-h),wt.content)),G.push(wt),gt+=wt.attrs.colspan;for(let Lt=1;Lt<wt.attrs.rowspan;Lt++)E[Z+Lt]=(E[Z+Lt]||0)+wt.attrs.colspan}N.push($.HY.from(G))}m=N,g=h}if(v!=T){const E=[];for(let N=0,Z=0;N<T;N++,Z++){const L=[],G=m[Z%v];for(let gt=0;gt<G.childCount;gt++){let Tt=G.child(gt);N+Tt.attrs.rowspan>T&&(Tt=Tt.type.create(ye(Xt({},Tt.attrs),{rowspan:Math.max(1,T-Tt.attrs.rowspan)}),Tt.content)),L.push(Tt)}E.push($.HY.from(L))}m=E,v=T}return{width:g,height:v,rows:m}}(h,Z.right-Z.left,Z.bottom-Z.top),jt(g.state,g.dispatch,N,Z,h),!0}if(h){const E=bt(g.state),N=E.start(-1);return jt(g.state,g.dispatch,N,Y.get(E.node(-1)).findCell(E.pos-N),h),!0}return!1}function Fe(g,v){var m;if(v.ctrlKey||v.metaKey)return;const h=Ue(g,v.target);let T;if(v.shiftKey&&g.state.selection instanceof K)E(g.state.selection.$anchorCell,v),v.preventDefault();else if(v.shiftKey&&h&&null!=(T=ut(g.state.selection.$anchor))&&(null==(m=Te(g,v))?void 0:m.pos)!=T.pos)E(T,v),v.preventDefault();else if(!h)return;function E(L,G){let gt=Te(g,G);const Tt=null==tt.getState(g.state);if(!gt||!Zt(L,gt)){if(!Tt)return;gt=L}const wt=new K(L,gt);if(Tt||!g.state.selection.eq(wt)){const Lt=g.state.tr.setSelection(wt);Tt&&Lt.setMeta(tt,L.pos),g.dispatch(Lt)}}function N(){g.root.removeEventListener("mouseup",N),g.root.removeEventListener("dragstart",N),g.root.removeEventListener("mousemove",Z),null!=tt.getState(g.state)&&g.dispatch(g.state.tr.setMeta(tt,-1))}function Z(L){const G=L,gt=tt.getState(g.state);let Tt;if(null!=gt)Tt=g.state.doc.resolve(gt);else if(Ue(g,G.target)!=h&&(Tt=Te(g,v),!Tt))return N();Tt&&E(Tt,G)}g.root.addEventListener("mouseup",N),g.root.addEventListener("dragstart",N),g.root.addEventListener("mousemove",Z)}function De(g,v,m){if(!(g.state.selection instanceof c.Bs))return null;const{$head:h}=g.state.selection;for(let T=h.depth-1;T>=0;T--){const E=h.node(T);if((m<0?h.index(T):h.indexAfter(T))!=(m<0?0:E.childCount))return null;if("cell"==E.type.spec.tableRole||"header_cell"==E.type.spec.tableRole){const Z=h.before(T);return g.endOfTextblock("vert"==v?m>0?"down":"up":m>0?"right":"left")?Z:null}}return null}function Ue(g,v){for(;v&&v!=g.dom;v=v.parentNode)if("TD"==v.nodeName||"TH"==v.nodeName)return v;return null}function Te(g,v){const m=g.posAtCoords({left:v.clientX,top:v.clientY});return m&&m?ut(g.state.doc.resolve(m.pos)):null}var Le=class{constructor(g,v){this.node=g,this.cellMinWidth=v,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),be(g,this.colgroup,this.table,v),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(g){return g.type==this.node.type&&(this.node=g,be(g,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(g){return"attributes"==g.type&&(g.target==this.table||this.colgroup.contains(g.target))}};function be(g,v,m,h,T,E){var N;let Z=0,L=!0,G=v.firstChild;const gt=g.firstChild;if(gt){for(let Tt=0,wt=0;Tt<gt.childCount;Tt++){const{colspan:Lt,colwidth:Qt}=gt.child(Tt).attrs;for(let le=0;le<Lt;le++,wt++){const ie=T==wt?E:Qt&&Qt[le],we=ie?ie+"px":"";Z+=ie||h,ie||(L=!1),G?(G.style.width!=we&&(G.style.width=we),G=G.nextSibling):v.appendChild(document.createElement("col")).style.width=we}}for(;G;){const Tt=G.nextSibling;null==(N=G.parentNode)||N.removeChild(G),G=Tt}L?(m.style.width=Z+"px",m.style.minWidth=""):(m.style.width="",m.style.minWidth=Z+"px")}}var Oe=new c.H$("tableColumnResizing");function ht({handleWidth:g=5,cellMinWidth:v=25,View:m=Le,lastColumnResizable:h=!0}={}){const T=new c.Sy({key:Oe,state:{init:(E,N)=>(T.spec.props.nodeViews[W(N.schema).table.name]=(Z,L)=>new m(Z,v,L),new M(-1,!1)),apply:(E,N)=>N.apply(E)},props:{attributes:E=>{const N=Oe.getState(E);return N&&N.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(E,N)=>{!function(g,v,m,h,T){const E=Oe.getState(g.state);if(E&&!E.dragging){const N=function(g){for(;g&&"TD"!=g.nodeName&&"TH"!=g.nodeName;)g=g.classList&&g.classList.contains("ProseMirror")?null:g.parentNode;return g}(v.target);let Z=-1;if(N){const{left:L,right:G}=N.getBoundingClientRect();v.clientX-L<=m?Z=mt(g,v,"left",m):G-v.clientX<=m&&(Z=mt(g,v,"right",m))}if(Z!=E.activeHandle){if(!T&&-1!==Z){const L=g.state.doc.resolve(Z),G=L.node(-1),gt=Y.get(G),Tt=L.start(-1);if(gt.colCount(L.pos-Tt)+L.nodeAfter.attrs.colspan-1==gt.width-1)return}R(g,Z)}}}(E,N,g,0,h)},mouseleave:E=>{!function(g){const v=Oe.getState(g.state);v&&v.activeHandle>-1&&!v.dragging&&R(g,-1)}(E)},mousedown:(E,N)=>{!function(g,v,m){const h=Oe.getState(g.state);if(!h||-1==h.activeHandle||h.dragging)return!1;const T=g.state.doc.nodeAt(h.activeHandle),E=function(g,v,{colspan:m,colwidth:h}){const T=h&&h[h.length-1];if(T)return T;const E=g.domAtPos(v);let Z=E.node.childNodes[E.offset].offsetWidth,L=m;if(h)for(let G=0;G<m;G++)h[G]&&(Z-=h[G],L--);return Z/L}(g,h.activeHandle,T.attrs);function N(L){window.removeEventListener("mouseup",N),window.removeEventListener("mousemove",Z);const G=Oe.getState(g.state);(null==G?void 0:G.dragging)&&(function(g,v,m){const h=g.state.doc.resolve(v),T=h.node(-1),E=Y.get(T),N=h.start(-1),Z=E.colCount(h.pos-N)+h.nodeAfter.attrs.colspan-1,L=g.state.tr;for(let G=0;G<E.height;G++){const gt=G*E.width+Z;if(G&&E.map[gt]==E.map[gt-E.width])continue;const Tt=E.map[gt],wt=T.nodeAt(Tt).attrs,Lt=1==wt.colspan?0:Z-E.colCount(Tt);if(wt.colwidth&&wt.colwidth[Lt]==m)continue;const Qt=wt.colwidth?wt.colwidth.slice():y(wt.colspan);Qt[Lt]=m,L.setNodeMarkup(N+Tt,null,ye(Xt({},wt),{colwidth:Qt}))}L.docChanged&&g.dispatch(L)}(g,G.activeHandle,Dt(G.dragging,L,m)),g.dispatch(g.state.tr.setMeta(Oe,{setDragging:null})))}function Z(L){if(!L.which)return N(L);const G=Oe.getState(g.state);if(G&&G.dragging){const gt=Dt(G.dragging,L,m);!function(g,v,m,h){const T=g.state.doc.resolve(v),E=T.node(-1),N=T.start(-1),Z=Y.get(E).colCount(T.pos-N)+T.nodeAfter.attrs.colspan-1;let L=g.domAtPos(T.start(-1)).node;for(;L&&"TABLE"!=L.nodeName;)L=L.parentNode;!L||be(E,L.firstChild,L,h,Z,m)}(g,G.activeHandle,gt,m)}}g.dispatch(g.state.tr.setMeta(Oe,{setDragging:{startX:v.clientX,startWidth:E}})),window.addEventListener("mouseup",N),window.addEventListener("mousemove",Z),v.preventDefault()}(E,N,v)}},decorations:E=>{const N=Oe.getState(E);if(N&&N.activeHandle>-1)return function(g,v){const m=[],h=g.doc.resolve(v),T=h.node(-1);if(!T)return I.EH.empty;const E=Y.get(T),N=h.start(-1),Z=E.colCount(h.pos-N)+h.nodeAfter.attrs.colspan;for(let L=0;L<E.height;L++){const G=Z+L*E.width-1;if(!(Z!=E.width&&E.map[G]==E.map[G+1]||0!=L&&E.map[G]==E.map[G-E.width])){const gt=E.map[G],Tt=N+gt+T.nodeAt(gt).nodeSize-1,wt=document.createElement("div");wt.className="column-resize-handle",m.push(I.p.widget(Tt,wt))}}return I.EH.create(g.doc,m)}(E,N.activeHandle)},nodeViews:{}}});return T}var M=class{constructor(g,v){this.activeHandle=g,this.dragging=v}apply(g){const v=this,m=g.getMeta(Oe);if(m&&null!=m.setHandle)return new M(m.setHandle,!1);if(m&&void 0!==m.setDragging)return new M(v.activeHandle,m.setDragging);if(v.activeHandle>-1&&g.docChanged){let h=g.mapping.map(v.activeHandle,-1);return Rt(g.doc.resolve(h))||(h=-1),new M(h,v.dragging)}return v}};function mt(g,v,m,h){const E=g.posAtCoords({left:v.clientX+("right"==m?-h:h),top:v.clientY});if(!E)return-1;const{pos:N}=E,Z=ut(g.state.doc.resolve(N));if(!Z)return-1;if("right"==m)return Z.pos;const L=Y.get(Z.node(-1)),G=Z.start(-1),gt=L.map.indexOf(Z.pos-G);return gt%L.width==0?-1:G+L.map[gt-1]}function Dt(g,v,m){return Math.max(m,g.startWidth+(v.clientX-g.startX))}function R(g,v){g.dispatch(g.state.tr.setMeta(Oe,{setHandle:v}))}function y(g){return Array(g).fill(0)}function w(g){const v=g.selection,m=bt(g),h=m.node(-1),T=m.start(-1),E=Y.get(h),N=v instanceof K?E.rectBetween(v.$anchorCell.pos-T,v.$headCell.pos-T):E.findCell(m.pos-T);return ye(Xt({},N),{tableStart:T,map:E,table:h})}function z(g,{map:v,tableStart:m,table:h},T){let E=T>0?-1:0;(function(g,v,m){const h=W(v.type.schema).header_cell;for(let T=0;T<g.height;T++)if(v.nodeAt(g.map[m+T*g.width]).type!=h)return!1;return!0})(v,h,T+E)&&(E=0==T||T==v.width?null:0);for(let N=0;N<v.height;N++){const Z=N*v.width+T;if(T>0&&T<v.width&&v.map[Z-1]==v.map[Z]){const L=v.map[Z],G=h.nodeAt(L);g.setNodeMarkup(g.mapping.map(m+L),null,P(G.attrs,T-v.colCount(L))),N+=G.attrs.rowspan-1}else{const L=null==E?W(h.type.schema).cell:h.nodeAt(v.map[Z+E]).type,G=v.positionAt(N,T,h);g.insert(g.mapping.map(m+G),L.createAndFill())}}return g}function ne(g,{map:v,table:m,tableStart:h},T){const E=g.mapping.maps.length;for(let N=0;N<v.height;){const Z=N*v.width+T,L=v.map[Z],G=m.nodeAt(L),gt=G.attrs;if(T>0&&v.map[Z-1]==L||T<v.width-1&&v.map[Z+1]==L)g.setNodeMarkup(g.mapping.slice(E).map(h+L),null,X(gt,T-v.colCount(L)));else{const Tt=g.mapping.slice(E).map(h+L);g.delete(Tt,Tt+G.nodeSize)}N+=gt.rowspan}}function J(g,{map:v,tableStart:m,table:h},T){var E;let N=m;for(let G=0;G<T;G++)N+=h.child(G).nodeSize;const Z=[];let L=T>0?-1:0;(function(g,v,m){var h;const T=W(v.type.schema).header_cell;for(let E=0;E<g.width;E++)if((null==(h=v.nodeAt(g.map[E+m*g.width]))?void 0:h.type)!=T)return!1;return!0})(v,h,T+L)&&(L=0==T||T==v.height?null:0);for(let G=0,gt=v.width*T;G<v.width;G++,gt++)if(T>0&&T<v.height&&v.map[gt]==v.map[gt-v.width]){const Tt=v.map[gt],wt=h.nodeAt(Tt).attrs;g.setNodeMarkup(m+Tt,null,ye(Xt({},wt),{rowspan:wt.rowspan+1})),G+=wt.colspan-1}else{const Tt=null==L?W(h.type.schema).cell:null==(E=h.nodeAt(v.map[gt+L*v.width]))?void 0:E.type,wt=null==Tt?void 0:Tt.createAndFill();wt&&Z.push(wt)}return g.insert(N,W(h.type.schema).row.create(null,Z)),g}function vt(g,{map:v,table:m,tableStart:h},T){let E=0;for(let L=0;L<T;L++)E+=m.child(L).nodeSize;const N=E+m.child(T).nodeSize,Z=g.mapping.maps.length;g.delete(E+h,N+h);for(let L=0,G=T*v.width;L<v.width;L++,G++){const gt=v.map[G];if(T>0&&gt==v.map[G-v.width]){const Tt=m.nodeAt(gt).attrs;g.setNodeMarkup(g.mapping.slice(Z).map(gt+h),null,ye(Xt({},Tt),{rowspan:Tt.rowspan-1})),L+=Tt.colspan-1}else if(T<v.width&&gt==v.map[G+v.width]){const Tt=m.nodeAt(gt),wt=Tt.attrs,Lt=Tt.type.create(ye(Xt({},wt),{rowspan:Tt.attrs.rowspan-1}),Tt.content),Qt=v.positionAt(T+1,L,m);g.insert(g.mapping.slice(Z).map(h+Qt),Lt),L+=wt.colspan-1}}}function zt(g){const v=g.content;return 1==v.childCount&&v.child(0).isTextblock&&0==v.child(0).childCount}function Vt(g,v){const m=g.selection;if(!(m instanceof K)||m.$anchorCell.pos==m.$headCell.pos)return!1;const h=w(g),{map:T}=h;if(function({width:g,height:v,map:m},h){let T=h.top*g+h.left,E=T,N=(h.bottom-1)*g+h.left,Z=T+(h.right-h.left-1);for(let L=h.top;L<h.bottom;L++){if(h.left>0&&m[E]==m[E-1]||h.right<g&&m[Z]==m[Z+1])return!0;E+=g,Z+=g}for(let L=h.left;L<h.right;L++){if(h.top>0&&m[T]==m[T-g]||h.bottom<v&&m[N]==m[N+g])return!0;T++,N++}return!1}(T,h))return!1;if(v){const E=g.tr,N={};let L,G,Z=$.HY.empty;for(let gt=h.top;gt<h.bottom;gt++)for(let Tt=h.left;Tt<h.right;Tt++){const wt=T.map[gt*T.width+Tt],Lt=h.table.nodeAt(wt);if(!N[wt]&&Lt)if(N[wt]=!0,null==L)L=wt,G=Lt;else{zt(Lt)||(Z=Z.append(Lt.content));const Qt=E.mapping.map(wt+h.tableStart);E.delete(Qt,Qt+Lt.nodeSize)}}if(null==L||null==G)return!0;if(E.setNodeMarkup(L+h.tableStart,null,ye(Xt({},P(G.attrs,G.attrs.colspan,h.right-h.left-G.attrs.colspan)),{rowspan:h.bottom-h.top})),Z.size){const gt=L+1+G.content.size,Tt=zt(G)?L+1:gt;E.replaceWith(Tt+h.tableStart,gt+h.tableStart,Z)}E.setSelection(new K(E.doc.resolve(L+h.tableStart))),v(E)}return!0}function ue(g,v){const m=W(g.schema);return function(g){return(v,m)=>{var h;const T=v.selection;let E,N;if(T instanceof K){if(T.$anchorCell.pos!=T.$headCell.pos)return!1;E=T.$anchorCell.nodeAfter,N=T.$anchorCell.pos}else{if(E=function(g){for(let v=g.depth;v>0;v--){const m=g.node(v).type.spec.tableRole;if("cell"===m||"header_cell"===m)return g.node(v)}return null}(T.$from),!E)return!1;N=null==(h=ut(T.$from))?void 0:h.pos}if(null==E||null==N||1==E.attrs.colspan&&1==E.attrs.rowspan)return!1;if(m){let Z=E.attrs;const L=[],G=Z.colwidth;Z.rowspan>1&&(Z=ye(Xt({},Z),{rowspan:1})),Z.colspan>1&&(Z=ye(Xt({},Z),{colspan:1}));const gt=w(v),Tt=v.tr;for(let Lt=0;Lt<gt.right-gt.left;Lt++)L.push(G?ye(Xt({},Z),{colwidth:G&&G[Lt]?[G[Lt]]:null}):Z);let wt;for(let Lt=gt.top;Lt<gt.bottom;Lt++){let Qt=gt.map.positionAt(Lt,gt.left,gt.table);Lt==gt.top&&(Qt+=E.nodeSize);for(let le=gt.left,ie=0;le<gt.right;le++,ie++)le==gt.left&&Lt==gt.top||Tt.insert(wt=Tt.mapping.map(Qt+gt.tableStart,1),g({node:E,row:Lt,col:le}).createAndFill(L[ie]))}Tt.setNodeMarkup(N,g({node:E,row:gt.top,col:gt.left}),L[0]),T instanceof K&&Tt.setSelection(new K(Tt.doc.resolve(T.$anchorCell.pos),wt?Tt.doc.resolve(wt):void 0)),m(Tt)}return!0}}(({node:h})=>m[h.type.spec.tableRole])(g,v)}function Ce(g,v,m){const h=v.map.cellsInRect({left:0,top:0,right:"row"==g?v.map.width:1,bottom:"column"==g?v.map.height:1});for(let T=0;T<h.length;T++){const E=v.table.nodeAt(h[T]);if(E&&E.type!==m.header_cell)return!1}return!0}function _e(g,v){return(v=v||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(g){return function(v,m){if(!xt(v))return!1;if(m){const h=W(v.schema),T=w(v),E=v.tr,N=T.map.cellsInRect("column"==g?{left:T.left,top:0,right:T.right,bottom:T.map.height}:"row"==g?{left:0,top:T.top,right:T.map.width,bottom:T.bottom}:T),Z=N.map(L=>T.table.nodeAt(L));for(let L=0;L<N.length;L++)Z[L].type==h.header_cell&&E.setNodeMarkup(T.tableStart+N[L],h.cell,Z[L].attrs);if(0==E.steps.length)for(let L=0;L<N.length;L++)E.setNodeMarkup(T.tableStart+N[L],h.header_cell,Z[L].attrs);m(E)}return!0}}(g):function(m,h){if(!xt(m))return!1;if(h){const T=W(m.schema),E=w(m),N=m.tr,Z=Ce("row",E,T),L=Ce("column",E,T),gt=("column"===g?Z:"row"===g&&L)?1:0,wt="column"==g?L?T.cell:T.header_cell:"row"==g?Z?T.cell:T.header_cell:T.cell;E.map.cellsInRect("column"==g?{left:0,top:gt,right:1,bottom:E.map.height}:"row"==g?{left:gt,top:0,right:E.map.width,bottom:1}:E).forEach(Lt=>{const Qt=Lt+E.tableStart,le=N.doc.nodeAt(Qt);le&&N.setNodeMarkup(Qt,wt,le.attrs)}),h(N)}return!0}}_e("row",{useDeprecatedLogic:!0}),_e("column",{useDeprecatedLogic:!0});var nn=_e("cell",{useDeprecatedLogic:!0});function hn(g){return function(v,m){if(!xt(v))return!1;const h=function(g,v){if(v<0){const m=g.nodeBefore;if(m)return g.pos-m.nodeSize;for(let h=g.index(-1)-1,T=g.before();h>=0;h--){const E=g.node(-1).child(h),N=E.lastChild;if(N)return T-1-N.nodeSize;T-=E.nodeSize}}else{if(g.index()<g.parent.childCount-1)return g.pos+g.nodeAfter.nodeSize;const m=g.node(-1);for(let h=g.indexAfter(-1),T=g.after();h<m.childCount;h++){const E=m.child(h);if(E.childCount)return T+1;T+=E.nodeSize}}return null}(bt(v),g);if(null==h)return!1;if(m){const T=v.doc.resolve(h);m(v.tr.setSelection(c.Bs.between(T,function(g){return g.node(0).resolve(g.pos+g.nodeAfter.nodeSize)}(T))).scrollIntoView())}return!0}}function zn({allowTableNodeSelection:g=!1}={}){return new c.Sy({key:tt,state:{init:()=>null,apply(v,m){const h=v.getMeta(tt);if(null!=h)return-1==h?null:h;if(null==m||!v.docChanged)return m;const{deleted:T,pos:E}=v.mapping.mapResult(m);return T?null:E}},props:{decorations:Pt,handleDOMEvents:{mousedown:Fe},createSelectionBetween:v=>null!=tt.getState(v.state)?v.state.selection:null,handleTripleClick:Ie,handleKeyDown:re,handlePaste:Ze},appendTransaction:(v,m,h)=>function(g,v,m){const h=(v||g).selection,T=(v||g).doc;let E,N;if(h instanceof c.qv&&(N=h.node.type.spec.tableRole)){if("cell"==N||"header_cell"==N)E=K.create(T,h.from);else if("row"==N){const Z=T.resolve(h.from+1);E=K.rowSelection(Z,Z)}else if(!m){const Z=Y.get(h.node),L=h.from+1;E=K.create(T,L+1,L+Z.map[Z.width*Z.height-1])}}else h instanceof c.Bs&&function({$from:g,$to:v}){if(g.pos==v.pos||g.pos<g.pos-6)return!1;let m=g.pos,h=v.pos,T=g.depth;for(;T>=0&&!(g.after(T+1)<g.end(T));T--,m++);for(let E=v.depth;E>=0&&!(v.before(E+1)>v.start(E));E--,h--);return m==h&&/row|table/.test(g.node(T).type.spec.tableRole)}(h)?E=c.Bs.create(T,h.from):h instanceof c.Bs&&function({$from:g,$to:v}){let m,h;for(let T=g.depth;T>0;T--){const E=g.node(T);if("cell"===E.type.spec.tableRole||"header_cell"===E.type.spec.tableRole){m=E;break}}for(let T=v.depth;T>0;T--){const E=v.node(T);if("cell"===E.type.spec.tableRole||"header_cell"===E.type.spec.tableRole){h=E;break}}return m!==h&&0===v.parentOffset}(h)&&(E=c.Bs.create(T,h.$from.start(),h.$from.end()));return E&&(v||(v=g.tr)).setSelection(E),v}(h,It(h,m),g)})}function Tn(g,v,m,h,T,E){let N=0,Z=!0,L=v.firstChild;const G=g.firstChild;for(let gt=0,Tt=0;gt<G.childCount;gt+=1){const{colspan:wt,colwidth:Lt}=G.child(gt).attrs;for(let Qt=0;Qt<wt;Qt+=1,Tt+=1){const le=T===Tt?E:Lt&&Lt[Qt],ie=le?`${le}px`:"";N+=le||h,le||(Z=!1),L?(L.style.width!==ie&&(L.style.width=ie),L=L.nextSibling):v.appendChild(document.createElement("col")).style.width=ie}}for(;L;){const gt=L.nextSibling;L.parentNode.removeChild(L),L=gt}Z?(m.style.width=`${N}px`,m.style.minWidth=""):(m.style.width="",m.style.minWidth=`${N}px`)}class On{constructor(v,m){this.node=v,this.cellMinWidth=m,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Tn(v,this.colgroup,this.table,m),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(v){return v.type===this.node.type&&(this.node=v,Tn(v,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(v){return"attributes"===v.type&&(v.target===this.table||this.colgroup.contains(v.target))}}function mn(g,v){return v?g.createChecked(null,v):g.createAndFill()}const gn=({editor:g})=>{const{selection:v}=g.state;if(!function(g){return g instanceof K}(v))return!1;let m=0;const h=(0,s.findParentNodeClosestToPos)(v.ranges[0].$from,E=>"table"===E.type.name);return null==h||h.node.descendants(E=>{if("table"===E.type.name)return!1;["tableCell","tableHeader"].includes(E.type.name)&&(m+=1)}),m===v.ranges.length&&(g.commands.deleteTable(),!0)},Qe=s.Node.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:On,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({HTMLAttributes:g}){return["table",(0,s.mergeAttributes)(this.options.HTMLAttributes,g),["tbody",0]]},addCommands:()=>({insertTable:({rows:g=3,cols:v=3,withHeaderRow:m=!0}={})=>({tr:h,dispatch:T,editor:E})=>{const N=function(g,v,m,h,T){const E=function(g){if(g.cached.tableNodeTypes)return g.cached.tableNodeTypes;const v={};return Object.keys(g.nodes).forEach(m=>{const h=g.nodes[m];h.spec.tableRole&&(v[h.spec.tableRole]=h)}),g.cached.tableNodeTypes=v,v}(g),N=[],Z=[];for(let G=0;G<m;G+=1){const gt=mn(E.cell,T);if(gt&&Z.push(gt),h){const Tt=mn(E.header_cell,T);Tt&&N.push(Tt)}}const L=[];for(let G=0;G<v;G+=1)L.push(E.row.createChecked(null,h&&0===G?N:Z));return E.table.createChecked(null,L)}(E.schema,g,v,m);if(T){const Z=h.selection.anchor+1;h.replaceSelectionWith(N).scrollIntoView().setSelection(c.Bs.near(h.doc.resolve(Z)))}return!0},addColumnBefore:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g);v(z(g.tr,m,m.left))}return!0}(g,v),addColumnAfter:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g);v(z(g.tr,m,m.right))}return!0}(g,v),deleteColumn:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g),h=g.tr;if(0==m.left&&m.right==m.map.width)return!1;for(let T=m.right-1;ne(h,m,T),T!=m.left;T--){const E=m.tableStart?h.doc.nodeAt(m.tableStart-1):h.doc;if(!E)throw RangeError("No table found");m.table=E,m.map=Y.get(E)}v(h)}return!0}(g,v),addRowBefore:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g);v(J(g.tr,m,m.top))}return!0}(g,v),addRowAfter:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g);v(J(g.tr,m,m.bottom))}return!0}(g,v),deleteRow:()=>({state:g,dispatch:v})=>function(g,v){if(!xt(g))return!1;if(v){const m=w(g),h=g.tr;if(0==m.top&&m.bottom==m.map.height)return!1;for(let T=m.bottom-1;vt(h,m,T),T!=m.top;T--){const E=m.tableStart?h.doc.nodeAt(m.tableStart-1):h.doc;if(!E)throw RangeError("No table found");m.table=E,m.map=Y.get(m.table)}v(h)}return!0}(g,v),deleteTable:()=>({state:g,dispatch:v})=>function(g,v){const m=g.selection.$anchor;for(let h=m.depth;h>0;h--)if("table"==m.node(h).type.spec.tableRole)return v&&v(g.tr.delete(m.before(h),m.after(h)).scrollIntoView()),!0;return!1}(g,v),mergeCells:()=>({state:g,dispatch:v})=>Vt(g,v),splitCell:()=>({state:g,dispatch:v})=>ue(g,v),toggleHeaderColumn:()=>({state:g,dispatch:v})=>_e("column")(g,v),toggleHeaderRow:()=>({state:g,dispatch:v})=>_e("row")(g,v),toggleHeaderCell:()=>({state:g,dispatch:v})=>nn(g,v),mergeOrSplit:()=>({state:g,dispatch:v})=>!!Vt(g,v)||ue(g,v),setCellAttribute:(g,v)=>({state:m,dispatch:h})=>function(g,v){return function(m,h){if(!xt(m))return!1;const T=bt(m);if(T.nodeAfter.attrs[g]===v)return!1;if(h){const E=m.tr;m.selection instanceof K?m.selection.forEachCell((N,Z)=>{N.attrs[g]!==v&&E.setNodeMarkup(Z,null,ye(Xt({},N.attrs),{[g]:v}))}):E.setNodeMarkup(T.pos,null,ye(Xt({},T.nodeAfter.attrs),{[g]:v})),h(E)}return!0}}(g,v)(m,h),goToNextCell:()=>({state:g,dispatch:v})=>hn(1)(g,v),goToPreviousCell:()=>({state:g,dispatch:v})=>hn(-1)(g,v),fixTables:()=>({state:g,dispatch:v})=>(v&&It(g),!0),setCellSelection:g=>({tr:v,dispatch:m})=>{if(m){const h=K.create(v.doc,g.anchorCell,g.headCell);v.setSelection(h)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:gn,"Mod-Backspace":gn,Delete:gn,"Mod-Delete":gn}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[ht({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],zn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:g=>({tableRole:(0,s.callOrReturn)((0,s.getExtensionField)(g,"tableRole",{name:g.name,options:g.options,storage:g.storage}))})}).extend({renderHTML({node:g,HTMLAttributes:v}){var m,h;let T=0,E=!0;try{const N=(null===(m=g.content)||void 0===m?void 0:m.content)[0];null===(h=null==N?void 0:N.content)||void 0===h||h.content.forEach(Z=>{Z.attrs.colwidth?Z.attrs.colwidth.forEach(L=>{L?T+=L:(E=!1,T+=this.options.cellMinWidth)}):(E=!1,T+=this.options.cellMinWidth*(Z.attrs.colspan||1))})}catch(N){E=!1}return v.style=E&&T>0?`width: ${T}px;`:T&&T>0?`min-width: ${T}px`:null,["div",{class:"tui-table-wrapper"},["table",(0,s.mergeAttributes)(this.options.HTMLAttributes,v),["tbody",0]]]}})},87187:(Gt,yt,a)=>{a.d(yt,{y:()=>j,d:()=>_});var s=a(12057),c=a(11046),$=a(74788);class I{constructor(Y,q,et){const pt=q.get($.z2F),ft=q.get($._Vd).resolveComponentFactory(Y);this.componentRef=ft.create(q,[]),this.updateProps(et),pt.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get el(){return this.componentRef.injector.get($.SBq)}get dom(){return this.el.nativeElement}updateProps(Y){Object.entries(Y).forEach(([q,et])=>{this.instance[q]=et})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}class _{}class j extends c.NodeView{constructor(Y,q,et){super(Y,q,et),this.contentDOMElement=null}mount(){const Y=this.options.injector,q=Y.get(s.K0);this.renderer=new I(this.component,Y,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(pt={})=>this.updateAttributes(pt),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.el.nativeElement.ondragstart=pt=>{this.onDragStart(pt)}),this.contentDOMElement=this.node.isLeaf?null:q.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(Y,q){return this.options.update?this.options.update(Y,q):Y.type===this.node.type&&(Y===this.node&&this.decorations===q||(this.node=Y,this.decorations=q,this.renderer.updateProps({node:Y,decorations:q}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const Y=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&Y&&!Y.contains(this.contentDOMElement)&&Y.appendChild(this.contentDOMElement)}}},31414:(Gt,yt,a)=>{a.d(yt,{zc:()=>qt.zc,dR:()=>qt.dR,F1:()=>qt.F1,Wf:()=>qt.Wf,VE:()=>It.TUI_EDITOR_MAX_IMAGE_WIDTH,kB:()=>It.TUI_EDITOR_MIN_IMAGE_WIDTH,mJ:()=>qt.mJ,bK:()=>qt.bK,p7:()=>qt.p7,H9:()=>s.H9,wl:()=>s.wl,aI:()=>$.a,BN:()=>Ot.BN,T_:()=>ft,GK:()=>et,_2:()=>K._,VM:()=>s.VM,$3:()=>Ot.$3,PD:()=>Pt,aU:()=>H.Db,Uv:()=>qt.Uv,Er:()=>lt.Er});var s=a(96472),c=a(8674),$=a(10215),I=a(12057),_=a(221),j=a(91489),F=a(80134),nt=a(98952),q=(a(96152),a(74788));let et=(()=>{class kt{}return kt.\u0275fac=function(re){return new(re||kt)},kt.\u0275mod=q.oAB({type:kt}),kt.\u0275inj=q.cJS({}),kt})();var pt=a(51618),Ot=a(86114);let ft=(()=>{class kt{}return kt.\u0275fac=function(re){return new(re||kt)},kt.\u0275mod=q.oAB({type:kt}),kt.\u0275inj=q.cJS({imports:[[I.ez,pt.yB,j.W,F.Jy,c.Fu,_.A,nt.dp,Ot.mJ,et]]}),kt})();a(46015);var Q=a(64762),W=a(24751),tt=a(91211),ut=a(76480),ot=a(44358),xt=a(52697),bt=a(23917),lt=a(88320),Rt=a(79588),Yt=a(44691);function Zt(kt,jt){if(1&kt&&q._UZ(0,"div",4),2&kt){const re=q.oxw();q.Udp("background",re.background)}}function Ht(kt,jt){if(1&kt){const re=q.EpF();q.TgZ(0,"tui-color-selector",5),q.NdJ("colorChange",function(Me){return q.CHM(re),q.oxw().value=Me}),q.qZA()}if(2&kt){const re=jt.$implicit,ae=q.oxw();q.Q6J("tuiActiveZoneParent",re)("colors",ae.colors)("color",ae.value)}}class Et extends ut.M${constructor(jt,re,ae){super(jt,re),this.domSanitizer=ae,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(jt){this.value=jt}onFocused(jt){this.updateFocused(jt)}getFallbackValue(){return"#000000"}sanitize(jt,re){return jt.startsWith("linear-gradient(")?re.bypassSecurityTrustStyle((0,lt.CH)((0,lt._N)((0,lt.U5)(jt)))):jt}}Et.\u0275fac=function(jt){return new(jt||Et)(q.Y36(W.a5,10),q.Y36(q.sBO),q.Y36(tt.H7))},Et.\u0275cmp=q.Xpm({type:Et,selectors:[["tui-input-color"]],viewQuery:function(jt,re){if(1&jt&&(q.Gf(xt.yc,5),q.Gf(bt.o1,5)),2&jt){let ae;q.iGM(ae=q.CRH())&&(re.textfield=ae.first),q.iGM(ae=q.CRH())&&(re.dropdown=ae.first)}},hostBindings:function(jt,re){1&jt&&q.NdJ("click",function(){return re.onClick()})},inputs:{colors:"colors"},features:[q._Bn([],[(0,nt.fx)({maxHeight:600})]),q.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(jt,re){if(1&jt&&(q.F$t(),q.TgZ(0,"tui-hosted-dropdown",0),q.NdJ("openChange",function(Me){return re.open=Me}),q.TgZ(1,"tui-primitive-textfield",1),q.NdJ("valueChange",function(Me){return re.value=Me})("focusedChange",function(Me){return re.onFocused(Me)}),q.Hsn(2),q.qZA(),q.qZA(),q.YNc(3,Zt,1,2,"ng-template",null,2,q.W1O),q.YNc(5,Ht,1,3,"ng-template",null,3,q.W1O)),2&jt){const ae=q.MAs(4),Me=q.MAs(6);q.Q6J("content",Me)("open",re.open),q.xp6(1),q.Q6J("tuiTextfieldIconLeft",ae)("pseudoFocus",re.computedFocused)("pseudoHover",re.pseudoHover)("pseudoActive",re.pseudoActive)("invalid",re.computedInvalid)("focusable",re.focusable)("nativeId",re.nativeId)("disabled",re.disabled)("readOnly",re.readOnly)("value",re.value)}},directives:[bt.o1,xt.yc,xt.B1,Rt.aR,Yt.s,_.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,Q.gn)([ot.UM],Et.prototype,"sanitize",null),a(69867);var H=a(18892),K=a(95161);a(13511);const Pt=[Promise.resolve().then(a.bind(a,66826)).then(({StarterKit:kt})=>kt).then(kt=>kt.configure({heading:{levels:[1,2,3,4,5,6]}})),a.e(3336).then(a.bind(a,73336)).then(({default:kt})=>kt.configure({types:["heading","paragraph"]})),Promise.resolve().then(a.bind(a,84402)).then(({default:kt})=>kt),a.e(7991).then(a.bind(a,17991)).then(({default:kt})=>kt),a.e(7147).then(a.bind(a,77147)).then(({default:kt})=>kt),a.e(5034).then(a.bind(a,25034)).then(({default:kt})=>kt),Promise.resolve().then(a.bind(a,47841)).then(({FontColor:kt})=>kt),Promise.resolve().then(a.bind(a,44632)).then(({default:kt})=>kt.configure({inline:!0,allowBase64:!0})),Promise.resolve().then(a.bind(a,50822)).then(({TuiLink:kt})=>kt),a.e(8629).then(a.bind(a,88629)).then(({TuiJumpAnchor:kt})=>kt),Promise.resolve().then(a.bind(a,41131)).then(({TuiFileLink:kt})=>kt),Promise.resolve().then(a.bind(a,13511)).then(({BackgroundColor:kt})=>kt),Promise.resolve().then(a.bind(a,14739)).then(({TuiTable:kt})=>kt.configure({resizable:!0})),a.e(5213).then(a.bind(a,45213)).then(({default:kt})=>kt),a.e(1397).then(a.bind(a,71397)).then(({default:kt})=>kt),a.e(8840).then(a.bind(a,38840)).then(({TableHeader:kt})=>kt),Promise.resolve().then(a.bind(a,73757)).then(({TuiTabExtension:kt})=>kt),Promise.resolve().then(a.bind(a,58676)).then(({TableCellBackground:kt})=>kt),a.e(7095).then(a.bind(a,77095)).then(({TuiDetailsContent:kt})=>kt),a.e(7095).then(a.bind(a,77095)).then(({TuiDetails:kt})=>kt),a.e(7095).then(a.bind(a,77095)).then(({TuiSummary:kt})=>kt),Promise.resolve().then(a.bind(a,83120)).then(({TuiFontSize:kt})=>kt)];a(41131),a(47841),a(83120),a(38981),a(91876);var It=a(45267),qt=(a(73757),a(50822),a(12585),a(66826),a(14739),a(58676),a(71831))},20755:(Gt,yt,a)=>{a.d(yt,{i:()=>et});var s=a(12057),c=a(74788),$=a(66749),I=a(27103),_=a(88320),j=a(29856),F=a(43190),nt=a(88002),Y=a(46782),q=a(39761);let et=(()=>{class pt extends j.y{constructor(ft,{nativeElement:st},Q){const W=(0,$.mL)(st,"mousedown").pipe((0,$.mp)(),(0,F.w)(tt=>{const ut=(0,$.mL)(Q,"mousemove").pipe((0,nt.U)(({clientX:ot,clientY:xt})=>(0,_.Ws)(ot,xt,st)),(0,Y.R)((0,$.mL)(Q,"mouseup")));return tt.target===st?ut.pipe((0,q.O)((0,_.Ws)(tt.clientX,tt.clientY,st))):ut}),(0,Y.R)(ft));super(tt=>W.subscribe(tt))}}return pt.\u0275fac=function(ft){return new(ft||pt)(c.LFG(I.a3,2),c.LFG(c.SBq),c.LFG(s.K0))},pt.\u0275prov=c.Yz7({token:pt,factory:pt.\u0275fac}),pt})()},71831:(Gt,yt,a)=>{a.d(yt,{Y1:()=>Zt,F4:()=>$,bG:()=>Yt,ZW:()=>Rt,zc:()=>pt,dR:()=>et,Mr:()=>tt,dj:()=>ft,F1:()=>Y,Wf:()=>c,UN:()=>ut,b$:()=>W,mJ:()=>j,$i:()=>Q,rf:()=>st,bK:()=>q,p7:()=>bt,Uv:()=>F});var s=a(74788);const c=new s.OlP("[TUI_EDITOR_EXTENSIONS]"),$=new s.OlP("[LAZY_EDITOR_EXTENSIONS]");var I=a(18892);const _={translate:"no",spellcheck:!1,colors:I.sw,blankColor:I.hK,linkOptions:I.pL,fontOptions:I.RR},j=new s.OlP("[TUI_EDITOR_OPTIONS]",{factory:()=>_});function F(Ht){return{provide:j,useValue:Object.assign(Object.assign({},_),Ht)}}var nt=a(54487);const Y=new s.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]",{factory:()=>nt.y}),q=new s.OlP("[TUI_EDITOR_VALUE_TRANSFORMER]"),et=new s.OlP("[TUI_ATTACH_FILES_OPTIONS]",{factory:()=>({accept:"*/*",multiple:!0})}),pt=new s.OlP("[TUI_ATTACH_FILES_LOADER]");var Ot=a(47232);const ft=new s.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]",{factory:()=>["Solid color","Gradient"]}),st=new s.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]",{factory:(0,Ot.v)("toolbarTools")}),Q=new s.OlP("[TUI_EDITOR_TABLE_COMMANDS]",{factory:(0,Ot.v)("editorTableCommands")}),W=new s.OlP("[TUI_EDITOR_LINK_TEXTS]",{factory:(0,Ot.v)("editorEditLink")}),tt=new s.OlP("[TUI_EDITOR_CODE_OPTIONS]",{factory:(0,Ot.v)("editorCodeOptions")}),ut=new s.OlP("[TUI_EDITOR_FONT_OPTIONS]",{factory:(0,Ot.v)("editorFontOptions")});var ot=a(66749),xt=a(88002);const bt=new s.OlP("[TUI_IMAGE_LOADER]",{factory:()=>Ht=>{const At=new FileReader;return At.readAsDataURL(Ht),(0,ot.mL)(At,"load").pipe((0,xt.U)(()=>String(At.result)))}});var lt=a(74235);const Rt=new s.OlP("[TIPTAP_EDITOR]"),Yt=new s.OlP("[LAZY_TIPTAP_EDITOR]",{factory:()=>{const Ht=new lt.t(1);return Promise.resolve().then(a.bind(a,11046)).then(At=>Ht.next(At.Editor)),Ht}}),Zt=new s.OlP("[INITIALIZATION_TIPTAP_CONTAINER]")},88320:(Gt,yt,a)=>{function s(H,K,Mt){const Pt=H.selection.$anchor;for(let Kt=Pt.depth;Kt>0;Kt--)if(Pt.node(Kt).type.name===Mt)return K&&K(H.tr.delete(Pt.before(Kt),Pt.after(Kt)).scrollIntoView()),!0;return!1}a.d(yt,{yU:()=>s,Ws:()=>$,U5:()=>I,Yz:()=>F,YX:()=>Y,Ap:()=>et,nC:()=>Et,Er:()=>pt,_N:()=>Yt,x6:()=>Ht,jx:()=>At,CH:()=>P});var c=a(85648);function $(H,K,Mt){const{left:Pt,top:Kt,width:oe,height:Jt}=Mt.getBoundingClientRect();return[(0,c.Ki)(H-Pt,0,oe)/oe,(0,c.Ki)(K-Kt,0,Jt)/Jt]}function I(H){return H.slice(0,Math.max(0,H.length-1)).replace("linear-gradient(","")}function j(H,K,Mt={}){return H.find(({attrs:Pt,type:Kt})=>Kt===K&&function(H,K){const Mt=Object.keys(K);return!Mt.length||!!Mt.filter(Pt=>K[Pt]===H[Pt]).length}(Pt,Mt))||null}function F(H,K,Mt={}){if(!H||!K)return null;const{node:Pt,offset:Kt}=H.parent.childAfter(H.parentOffset);if(!Pt)return null;const oe=j(Pt.marks,K,Mt);if(!oe)return null;let Jt=H.index(),se=H.start()+Kt,rt=Jt+1,It=se+Pt.nodeSize;for(j(Pt.marks,K,Mt);Jt>0&&oe.isInSet(H.parent.child(Jt-1).marks);)Jt-=1,se-=H.parent.child(Jt).nodeSize;for(;rt<H.parent.childCount&&j(H.parent.child(rt).marks,K,Mt);)It+=H.parent.child(rt).nodeSize,rt+=1;return{from:se,to:It}}var nt=a(27439);function Y(H){const K=[];return H.content.forEach(Mt=>{Mt instanceof nt.NB&&K.push([Mt.type.name,Mt.attrs])}),K}var q=a(11046);function et(H,K){const Mt=null!=K?K:H.selection.$head.parent.textContent,Pt=H.doc.cut(H.selection.from,H.selection.to);return Pt.content.size?(0,q.getHTMLFromFragment)(Pt.content,H.schema):Mt}function pt(H){const K=(new DOMParser).parseFromString(H,"text/html");return Ot(K.body),K.body.innerHTML}function Ot(H){for(const K of Array.from(H.children))if(K.children.length&&Ot(K),"FONT"===K.tagName)if(K.hasAttribute("size"))switch(K.getAttribute("size")){case"6":ft("h1",K);break;case"5":ft("h2",K);break;case"4":st("17px",K);break;case"3":st("15px",K);break;case"2":st("13px",K)}else K.hasAttribute("color")&&Q(K)}function ft(H,K){var Mt,Pt,Kt,oe,Jt,se,rt,It,Ut;const me=document.createElement(H);if(me.innerHTML=K.innerHTML,"P"===(null===(Mt=K.parentElement)||void 0===Mt?void 0:Mt.tagName)){const fe=null===(Kt=null===(Pt=K.parentElement)||void 0===Pt?void 0:Pt.parentElement)||void 0===Kt?void 0:Kt.insertBefore(me,K.parentElement);null===(oe=K.parentElement)||void 0===oe||oe.removeChild(K),(null==fe?void 0:fe.nextSibling)&&!(null===(se=null===(Jt=null==fe?void 0:fe.nextSibling)||void 0===Jt?void 0:Jt.textContent)||void 0===se?void 0:se.trim())&&(null===(It=null===(rt=fe.nextSibling)||void 0===rt?void 0:rt.parentElement)||void 0===It||It.removeChild(fe.nextSibling))}else null===(Ut=K.parentElement)||void 0===Ut||Ut.replaceChild(me,K)}function st(H,K){var Mt;const Pt=document.createElement("p"),Kt=document.createElement("span");Kt.setAttribute("style",`font-size: ${H}`),Kt.innerHTML=K.innerHTML,Pt.append(Kt),null===(Mt=K.parentElement)||void 0===Mt||Mt.replaceChild("P"===K.parentElement.tagName?Kt:Pt,K)}function Q(H){var K;const Mt=document.createElement("span");Mt.setAttribute("style",`color: ${H.getAttribute("color")}`),Mt.innerHTML=H.innerHTML,null===(K=H.parentElement)||void 0===K||K.replaceChild(Mt,H)}const Rt=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function Yt(H){const K=new RegExp(Rt.join(""),"gi"),Mt=H.startsWith("to")||H.match(/^\d/)?H.slice(Math.max(0,H.indexOf(",")+1)).trim():H,Pt=H.startsWith("to")?H.split(",")[0]:"to bottom";let Kt=[],oe=K.exec(Mt);for(;null!==oe;)Kt=Kt.concat({color:oe[1],position:Zt(oe[2],Kt.length)}),oe=K.exec(Mt);return Kt=Kt.filter(({color:Jt})=>Jt.startsWith("#")||Jt.startsWith("rgb")),{stops:Kt,side:Pt}}function Zt(H,K){const Mt=1===K?"100%":`${K}%`;return(null==H?void 0:H.includes("%"))?H:Mt}function Ht(H){return H.reduce((K,Mt)=>(K[Mt]={parseHTML:Pt=>null==Pt?void 0:Pt.getAttribute(`${Mt}`)},K),{})}function At(H){return H.split(";").reduce((K,Mt)=>{var Pt;const[Kt,oe]=null!==(Pt=Mt.split(":"))&&void 0!==Pt?Pt:[];return Kt&&oe&&(K[Kt.trim()]=oe.trim()),K},{})}function Et(H){var K;const Mt=(null===(K=H.endContainer.nodeValue)||void 0===K?void 0:K.length)||0;return H.endOffset-H.startOffset>0||H.endOffset-H.startOffset==0&&1===Mt||0!==H.startOffset&&Mt>1&&H.endOffset!==Mt}var X=a(2330);function P({stops:H,side:K}){return`linear-gradient(${K}, ${H.map(({color:Mt,position:Pt})=>`rgba(${(0,X.Mp)(Mt).join(", ")}) ${Pt}`).join(", ")})`}},70997:(Gt,yt,a)=>{a.d(yt,{fV:()=>$});var s=a(74788),c=a(70652);let $=(()=>{class I{}return I.\u0275fac=function(j){return new(j||I)},I.\u0275mod=s.oAB({type:I}),I.\u0275inj=s.cJS({imports:[c.JF,c.mG,c.Lx,c.Lq,c.u4]}),I})()},1336:(Gt,yt,a)=>{a.d(yt,{Xj:()=>_,Ih:()=>j});var s=a(74788),c=a(85648);class I{constructor(nt){this.$implicit=nt}}let _=(()=>{class F{constructor(Y,q){this.viewContainer=Y,this.templateRef=q}set tuiRepeatTimesOf(Y){const q=Math.floor((0,c.Ki)(Y,0,65536)),{length:et}=this.viewContainer;Y<et?this.removeContainers(et-Y):this.addContainers(q)}addContainers(Y){for(let q=this.viewContainer.length;q<Y;q++)this.viewContainer.createEmbeddedView(this.templateRef,new I(q))}removeContainers(Y){for(let q=0;q<Y;q++)this.viewContainer.remove()}}return F.\u0275fac=function(Y){return new(Y||F)(s.Y36(s.s_b),s.Y36(s.Rgc))},F.\u0275dir=s.lG2({type:F,selectors:[["","tuiRepeatTimes","","tuiRepeatTimesOf",""]],inputs:{tuiRepeatTimesOf:"tuiRepeatTimesOf"}}),F})(),j=(()=>{class F{}return F.\u0275fac=function(Y){return new(Y||F)},F.\u0275mod=s.oAB({type:F}),F.\u0275inj=s.cJS({}),F})()},28858:(Gt,yt,a)=>{a.d(yt,{EA:()=>Yt,aQ:()=>Zt,$H:()=>Ht});var s=a(74788),c=a(24751),$=a(72878),I=a(76480),_=a(57179),j=a(11927),F=a(85648),nt=a(99434),Y=a(12628),q=a(79588),et=a(79456),pt=a(43631),Ot=a(52697),ft=a(72764),st=a(56747),Q=a(12057),W=a(75093);function tt(At,Et){if(1&At){const X=s.EpF();s.ynx(0),s.TgZ(1,"section",2),s.TgZ(2,"button",3),s.NdJ("mousedown",function(H){s.CHM(X);const K=s.oxw(2);return K.onButtonMouseDown(H,K.plusButtonDisabled)})("click",function(){return s.CHM(X),s.oxw(2).increaseValue()}),s.qZA(),s.TgZ(3,"button",4),s.NdJ("mousedown",function(H){s.CHM(X);const K=s.oxw(2);return K.onButtonMouseDown(H,K.minusButtonDisabled)})("click",function(){return s.CHM(X),s.oxw(2).decreaseValue()}),s.qZA(),s.qZA(),s.BQk()}if(2&At){const X=Et.ngIf,P=s.oxw(2);s.xp6(2),s.Q6J("icon",P.iconUp)("appearance",P.options.appearance)("title",X[0])("disabled",P.plusButtonDisabled)("focusable",!1),s.xp6(1),s.Q6J("icon",P.iconDown)("appearance",P.options.appearance)("disabled",P.minusButtonDisabled)("focusable",!1)("title",X[1])}}function ut(At,Et){if(1&At&&(s.ynx(0),s.YNc(1,tt,4,10,"ng-container",1),s.ALo(2,"async"),s.BQk()),2&At){const X=s.oxw();s.xp6(1),s.Q6J("ngIf",s.lcZ(2,1,X.minusTexts$))}}const ot=["*",[["input"]]],xt=["*","input"],bt={icons:{up:"tuiIconPlus",down:"tuiIconMinus"},appearance:"textfield",hideButtons:!1,min:0,max:Number.MAX_SAFE_INTEGER,step:1,postfix:""},lt=new s.OlP("[TUI_INPUT_COUNT_OPTIONS]",{factory:()=>bt});let Yt=(()=>{class At extends I.F9{constructor(X,P,H,K,Mt,Pt,Kt){super(X,P),this.textfieldController=H,this.minusTexts$=K,this.isMobile=Mt,this.options=Pt,this.numberFormat=Kt,this.step=this.options.step,this.min=this.options.min,this.max=this.options.max,this.hideButtons=this.options.hideButtons,this.prefix="",this.postfix=this.options.postfix}get buttonsHidden(){return this.hideButtons||"table"===this.textfieldController.appearance}get iconUp(){return this.options.icons.up}get iconDown(){return this.options.icons.down}get nativeFocusableElement(){return!this.inputNumber||this.computedDisabled?null:this.inputNumber.nativeFocusableElement}get size(){return this.textfieldController.size}get focused(){return(0,_.V8)(this.nativeFocusableElement)}get minusButtonDisabled(){return!this.interactive||(0,j.Pc)(this.value)&&this.value<=this.min}get plusButtonDisabled(){return!this.interactive||(0,j.Pc)(this.value)&&this.value>=this.max}onButtonMouseDown(X,P=!1){P||!this.nativeFocusableElement||this.isMobile||(X.preventDefault(),this.nativeFocusableElement.focus())}onFocused(X){this.updateFocused(X)}onInputNumberChange(X){this.value=X}onValueChange(X){this.value=(0,$.vZ)(X,this.numberFormat.decimalSeparator)}decreaseValue(){this.readOnly||this.safeUpdateValue((this.value||0)-this.step)}increaseValue(){this.readOnly||this.safeUpdateValue((this.value||0)+this.step)}onKeydown(X){switch(X.key){case"ArrowUp":case"Up":this.increaseValue(),X.preventDefault();break;case"ArrowDown":case"Down":this.decreaseValue(),X.preventDefault()}}safeUpdateValue(X){this.value=(0,F.Ki)(X,this.min,this.max)}}return At.\u0275fac=function(X){return new(X||At)(s.Y36(c.a5,10),s.Y36(s.sBO),s.Y36(q.Cs),s.Y36(st.mT),s.Y36(nt.fL),s.Y36(lt),s.Y36(et.HO))},At.\u0275cmp=s.Xpm({type:At,selectors:[["tui-input-count"]],viewQuery:function(X,P){if(1&X&&s.Gf(ft.qS,5),2&X){let H;s.iGM(H=s.CRH())&&(P.inputNumber=H.first)}},hostVars:3,hostBindings:function(X,P){2&X&&(s.uIk("data-size",P.size),s.ekj("_hide-buttons",P.buttonsHidden))},inputs:{step:"step",min:"min",max:"max",hideButtons:"hideButtons",prefix:"prefix",postfix:"postfix"},features:[s._Bn([(0,nt.FT)(At),(0,I.wB)(At),q.Y0]),s.qOj],ngContentSelectors:xt,decls:4,vars:14,consts:[["decimal","never",1,"t-textfield",3,"pseudoFocus","pseudoHover","pseudoInvalid","pseudoActive","focusable","min","max","prefix","postfix","disabled","readOnly","nativeId","ngModel","ngModelChange","keydown","focusedChange"],[4,"ngIf"],[1,"t-buttons"],["tuiIconButton","","type","button","automation-id","tui-input-count__plus-button","size","s",1,"t-button","t-button_plus",3,"icon","appearance","title","disabled","focusable","mousedown","click"],["tuiIconButton","","type","button","automation-id","tui-input-count__minus-button","size","s",1,"t-button","t-button_minus",3,"icon","appearance","disabled","focusable","title","mousedown","click"]],template:function(X,P){1&X&&(s.F$t(ot),s.TgZ(0,"tui-input-number",0),s.NdJ("ngModelChange",function(K){return P.value=K})("keydown",function(K){return P.onKeydown(K)})("focusedChange",function(K){return P.onFocused(K)}),s.Hsn(1),s.Hsn(2,1,["ngProjectAs","input",5,["input"]]),s.qZA(),s.YNc(3,ut,3,3,"ng-container",1)),2&X&&(s.Q6J("pseudoFocus",P.pseudoFocus)("pseudoHover",P.pseudoHover)("pseudoInvalid",P.pseudoInvalid)("pseudoActive",P.pseudoActive)("focusable",P.focusable)("min",P.min)("max",P.max)("prefix",P.prefix)("postfix",P.postfix)("disabled",P.computedDisabled)("readOnly",P.readOnly)("nativeId",P.nativeId)("ngModel",P.value),s.xp6(3),s.Q6J("ngIf",!P.buttonsHidden))},directives:[ft.qS,ft.g5,c.JJ,c.On,Q.O5,Y.v0],pipes:[Q.Ov],styles:["[_nghost-%COMP%]{display:flex;font:var(--tui-font-text-s);border-radius:var(--tui-radius-m);height:var(--tui-height-m);color:var(--tui-text-01);text-align:left}._disabled[_nghost-%COMP%]{pointer-events:none}[data-size=l][_nghost-%COMP%]{font:var(--tui-font-text-m);height:var(--tui-height-l)}.t-textfield[_ngcontent-%COMP%]{position:relative;border-radius:inherit;text-align:inherit;flex-grow:1;min-width:0}[_nghost-%COMP%]:not(._hide-buttons)   .t-textfield[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0}.t-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:.125rem;height:100%}.t-buttons[_ngcontent-%COMP%]   .t-button[_ngcontent-%COMP%]{display:flex;width:calc(var(--tui-height-m) * .75);height:calc(50% - .0625rem)}.t-buttons[_ngcontent-%COMP%]   .t-button_plus[_ngcontent-%COMP%]{margin-bottom:.125rem;border-radius:0 var(--tui-radius-m) 0 0}.t-buttons[_ngcontent-%COMP%]   .t-button_minus[_ngcontent-%COMP%]{border-radius:0 0 var(--tui-radius-m)}[data-size=l][_nghost-%COMP%]   .t-buttons[_ngcontent-%COMP%]   .t-button[_ngcontent-%COMP%]{width:calc(var(--tui-height-l) * .75)}"],changeDetection:0}),At})(),Zt=(()=>{class At extends pt.D1{onValueChange(X){this.host.onValueChange(X)}ngAfterViewInit(){if(this.host.nativeFocusableElement){const{nativeFocusableElement:X}=this.host;X.autocomplete="off",X.inputMode="numeric",X.maxLength=X.maxLength>-1?X.maxLength:18}}}return At.\u0275fac=function(){let Et;return function(P){return(Et||(Et=s.n5z(At)))(P||At)}}(),At.\u0275dir=s.lG2({type:At,selectors:[["tui-input-count"]],features:[s._Bn([(0,et.cp)(At)]),s.qOj]}),At})(),Ht=(()=>{class At{}return At.\u0275fac=function(X){return new(X||At)},At.\u0275mod=s.oAB({type:At}),At.\u0275inj=s.cJS({imports:[[Q.ez,c.u5,Y.fN,Ot.KW,q.cn,W.S,ft._H]]}),At})()},92815:(Gt,yt,a)=>{a.d(yt,{l:()=>ft,z:()=>st});var s=a(74788),c=a(24751),$=a(13633),I=a(75059),_=a(76480),j=a(57179),F=a(99434),nt=a(93213),Y=a(12057),q=a(9013);const et=["native"];function pt(Q,W){1&Q&&(s.TgZ(0,"span",4),s.Hsn(1),s.qZA())}const Ot=["*"];let ft=(()=>{class Q extends _.M${constructor(tt,ut){super(tt,ut),this.maxLength=null,this.indent=-1}get nativeFocusableElement(){return this.native?this.native.nativeElement:null}get focused(){return(0,j.V8)(this.nativeFocusableElement)}get hasValue(){return""!==this.value}onValueChange(tt){this.value=tt}onFocused(tt){this.updateFocused(tt)}onScroll(){var tt;const ut=(null===(tt=this.native)||void 0===tt?void 0:tt.nativeElement.scrollLeft)||0;this.indent=-1-ut}getFallbackValue(){return""}}return Q.\u0275fac=function(tt){return new(tt||Q)(s.Y36(c.a5,10),s.Y36(s.sBO))},Q.\u0275cmp=s.Xpm({type:Q,selectors:[["tui-input-inline"]],viewQuery:function(tt,ut){if(1&tt&&s.Gf(et,5),2&tt){let ot;s.iGM(ot=s.CRH())&&(ut.native=ot.first)}},inputs:{maxLength:"maxLength"},features:[s._Bn([nt.E2,(0,F.FT)(Q)]),s.qOj],ngContentSelectors:Ot,decls:4,vars:10,consts:[[1,"t-before",3,"textContent"],["automation-id","tui-input-inline__placeholder","class","t-placeholder",4,"ngIf"],["automation-id","tui-input-inline__native","type","text","tuiMaskAccessor","",1,"t-native",3,"id","disabled","readOnly","tuiFocusable","ngModel","ngModelChange","scroll","tuiFocusedChange"],["native",""],["automation-id","tui-input-inline__placeholder",1,"t-placeholder"]],template:function(tt,ut){1&tt&&(s.F$t(),s._UZ(0,"span",0),s.YNc(1,pt,2,0,"span",1),s.TgZ(2,"input",2,3),s.NdJ("ngModelChange",function(xt){return ut.value=xt})("scroll",function(){return ut.onScroll()})("tuiFocusedChange",function(xt){return ut.onFocused(xt)}),s.qZA()),2&tt&&(s.Udp("text-indent",ut.indent,"px"),s.Q6J("textContent",ut.value),s.xp6(1),s.Q6J("ngIf",!ut.hasValue),s.xp6(1),s.Q6J("id",ut.id)("disabled",ut.computedDisabled)("readOnly",ut.readOnly)("tuiFocusable",ut.focusable)("ngModel",ut.value),s.uIk("maxLength",ut.maxLength))},directives:[Y.O5,q.j,c.Fj,$.t,c.JJ,c.On,I.U],styles:["[_nghost-%COMP%]{position:relative;display:inline-block;overflow:hidden;white-space:nowrap;box-sizing:border-box}.t-before[_ngcontent-%COMP%]{display:block;padding-right:.02em;margin-left:1px;white-space:pre}.t-placeholder[_ngcontent-%COMP%]{display:inline-block;min-width:1px}.t-native[_ngcontent-%COMP%]{position:absolute;top:0;left:0;background-color:transparent;padding:inherit;font:inherit;color:transparent;caret-color:#7d7d7d;box-sizing:border-box;width:100%;height:100%;border-width:0;text-align:inherit;letter-spacing:inherit;text-indent:inherit;text-transform:inherit;outline:none;mix-blend-mode:difference}"],changeDetection:0}),Q})(),st=(()=>{class Q{}return Q.\u0275fac=function(tt){return new(tt||Q)},Q.\u0275mod=s.oAB({type:Q}),Q.\u0275inj=s.cJS({imports:[[Y.ez,c.u5,$.u,I.F,q.c]]}),Q})()},11046:(Gt,yt,a)=>{a.r(yt),a.d(yt,{CommandManager:()=>M,Editor:()=>yo,Extension:()=>_e,InputRule:()=>Pe,Mark:()=>$n,Node:()=>io,NodeView:()=>Wo,PasteRule:()=>Ct,Tracker:()=>$o,callOrReturn:()=>l,combineTransactionSteps:()=>fn,createChainableState:()=>ht,createDocument:()=>Cn,createNodeFromContent:()=>Lt,createStyleTag:()=>vo,defaultBlockAt:()=>ro,deleteProps:()=>Re,elementFromString:()=>wt,escapeForRegEx:()=>bo,extensions:()=>Co,findChildren:()=>jn,findChildrenInRange:()=>In,findDuplicates:()=>ue,findParentNode:()=>Fn,findParentNodeClosestToPos:()=>so,fromString:()=>y,generateHTML:()=>ko,generateJSON:()=>Ao,generateText:()=>lo,getAttributes:()=>ao,getAttributesFromExtensions:()=>D,getChangedRanges:()=>So,getDebugJSON:()=>Bn,getExtensionField:()=>b,getHTMLFromFragment:()=>Yn,getMarkAttributes:()=>Vn,getMarkRange:()=>v,getMarkType:()=>m,getMarksBetween:()=>Xn,getNodeAttributes:()=>Qn,getNodeType:()=>V,getRenderedAttributes:()=>Dt,getSchema:()=>Un,getSchemaByResolvedExtensions:()=>z,getSchemaTypeByName:()=>dt,getSchemaTypeNameByName:()=>un,getSplittedAttributes:()=>ln,getText:()=>Ln,getTextBetween:()=>je,getTextContentFromNodes:()=>ne,getTextSerializersFromSchema:()=>Be,injectExtensionAttributesToParseRule:()=>O,inputRulesPlugin:()=>at,isActive:()=>uo,isEmptyObject:()=>d,isExtensionRulesEnabled:()=>St,isFunction:()=>R,isList:()=>xn,isMacOS:()=>Ae,isMarkActive:()=>Wn,isNodeActive:()=>he,isNodeEmpty:()=>po,isNodeSelection:()=>fo,isNumber:()=>vt,isPlainObject:()=>ce,isRegExp:()=>te,isString:()=>Mo,isTextSelection:()=>E,isiOS:()=>L,markInputRule:()=>zo,markPasteRule:()=>To,mergeAttributes:()=>mt,mergeDeep:()=>Ce,minMax:()=>N,nodeInputRule:()=>Fo,nodePasteRule:()=>Jo,objectIncludes:()=>sn,pasteRulesPlugin:()=>Vt,posToDOMRect:()=>Hn,removeDuplicates:()=>Gn,resolveFocusPosition:()=>Z,selectionToInsertionEnd:()=>Qt,splitExtensions:()=>B,textInputRule:()=>Uo,textPasteRule:()=>xo,textblockTypeInputRule:()=>oo,wrappingInputRule:()=>Yo});var s=a(62463),c=a(43594),$=a(31690),I=a(27439),_=a(38480);const j=(p,e)=>!p.selection.empty&&(e&&e(p.tr.deleteSelection().scrollIntoView()),!0);const nt=(p,e,t)=>{let n=function(p,e){let{$cursor:t}=p.selection;return!t||(e?!e.endOfTextblock("backward",p):t.parentOffset>0)?null:t}(p,t);if(!n)return!1;let o=ft(n);if(!o){let r=n.blockRange(),u=r&&(0,_.k9)(r);return null!=u&&(e&&e(p.tr.lift(r,u).scrollIntoView()),!0)}let i=o.nodeBefore;if(!i.type.spec.isolating&&K(p,o,e))return!0;if(0==n.parent.content.size&&(pt(i,"end")||s.qv.isSelectable(i))){let r=(0,_.dR)(p.doc,n.before(),n.after(),I.p2.empty);if(r&&r.slice.size<r.to-r.from){if(e){let u=p.tr.step(r);u.setSelection(pt(i,"end")?s.Y1.findFrom(u.doc.resolve(u.mapping.map(o.pos,-1)),-1):s.qv.create(u.doc,o.pos-i.nodeSize)),e(u.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=n.depth-1||(e&&e(p.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),0))};function pt(p,e,t=!1){for(let n=p;n;n="start"==e?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&1!=n.childCount)return!1}return!1}const Ot=(p,e,t)=>{let{$head:n,empty:o}=p.selection,i=n;if(!o)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",p):n.parentOffset>0)return!1;i=ft(n)}let r=i&&i.nodeBefore;return!(!r||!s.qv.isSelectable(r)||(e&&e(p.tr.setSelection(s.qv.create(p.doc,i.pos-r.nodeSize)).scrollIntoView()),0))};function ft(p){if(!p.parent.type.spec.isolating)for(let e=p.depth-1;e>=0;e--){if(p.index(e)>0)return p.doc.resolve(p.before(e+1));if(p.node(e).type.spec.isolating)break}return null}const Q=(p,e,t)=>{let n=function(p,e){let{$cursor:t}=p.selection;return!t||(e?!e.endOfTextblock("forward",p):t.parentOffset<t.parent.content.size)?null:t}(p,t);if(!n)return!1;let o=tt(n);if(!o)return!1;let i=o.nodeAfter;if(K(p,o,e))return!0;if(0==n.parent.content.size&&(pt(i,"start")||s.qv.isSelectable(i))){let r=(0,_.dR)(p.doc,n.before(),n.after(),I.p2.empty);if(r&&r.slice.size<r.to-r.from){if(e){let u=p.tr.step(r);u.setSelection(pt(i,"start")?s.Y1.findFrom(u.doc.resolve(u.mapping.map(o.pos)),1):s.qv.create(u.doc,u.mapping.map(o.pos))),e(u.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=n.depth-1||(e&&e(p.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),0))},W=(p,e,t)=>{let{$head:n,empty:o}=p.selection,i=n;if(!o)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",p):n.parentOffset<n.parent.content.size)return!1;i=tt(n)}let r=i&&i.nodeAfter;return!(!r||!s.qv.isSelectable(r)||(e&&e(p.tr.setSelection(s.qv.create(p.doc,i.pos)).scrollIntoView()),0))};function tt(p){if(!p.parent.type.spec.isolating)for(let e=p.depth-1;e>=0;e--){let t=p.node(e);if(p.index(e)+1<t.childCount)return p.doc.resolve(p.after(e+1));if(t.type.spec.isolating)break}return null}const bt=(p,e)=>{let{$head:t,$anchor:n}=p.selection;return!(!t.parent.type.spec.code||!t.sameParent(n)||(e&&e(p.tr.insertText("\n").scrollIntoView()),0))};function lt(p){for(let e=0;e<p.edgeCount;e++){let{type:t}=p.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Rt=(p,e)=>{let{$head:t,$anchor:n}=p.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let o=t.node(-1),i=t.indexAfter(-1),r=lt(o.contentMatchAt(i));if(!r||!o.canReplaceWith(i,i,r))return!1;if(e){let u=t.after(),f=p.tr.replaceWith(u,u,r.createAndFill());f.setSelection(s.Y1.near(f.doc.resolve(u),1)),e(f.scrollIntoView())}return!0},Yt=(p,e)=>{let t=p.selection,{$from:n,$to:o}=t;if(t instanceof s.C1||n.parent.inlineContent||o.parent.inlineContent)return!1;let i=lt(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let r=(!n.parentOffset&&o.index()<o.parent.childCount?n:o).pos,u=p.tr.insert(r,i.createAndFill());u.setSelection(s.Bs.create(u.doc,r+1)),e(u.scrollIntoView())}return!0},Zt=(p,e)=>{let{$cursor:t}=p.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if((0,_.Ax)(p.doc,i))return e&&e(p.tr.split(i).scrollIntoView()),!0}let n=t.blockRange(),o=n&&(0,_.k9)(n);return null!=o&&(e&&e(p.tr.lift(n,o).scrollIntoView()),!0)};var p;function K(p,e,t){let i,r,n=e.nodeBefore,o=e.nodeAfter;if(n.type.spec.isolating||o.type.spec.isolating)return!1;if(function(p,e,t){let n=e.nodeBefore,o=e.nodeAfter,i=e.index();return!(!(n&&o&&n.type.compatibleContent(o.type))||(!n.content.size&&e.parent.canReplace(i-1,i)?(t&&t(p.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!o.isTextblock&&!(0,_.Mn)(p.doc,e.pos)||(t&&t(p.tr.clearIncompatible(e.pos,n.type,n.contentMatchAt(n.childCount)).join(e.pos).scrollIntoView()),0)))}(p,e,t))return!0;let u=e.parent.canReplace(e.index(),e.index()+1);if(u&&(i=(r=n.contentMatchAt(n.childCount)).findWrapping(o.type))&&r.matchType(i[0]||o.type).validEnd){if(t){let A=e.pos+o.nodeSize,U=I.HY.empty;for(let _t=i.length-1;_t>=0;_t--)U=I.HY.from(i[_t].create(null,U));U=I.HY.from(n.copy(U));let it=p.tr.step(new _.FC(e.pos-1,A,e.pos,A,new I.p2(U,1,0),i.length,!0)),ct=A+2*i.length;(0,_.Mn)(it.doc,ct)&&it.join(ct),t(it.scrollIntoView())}return!0}let f=s.Y1.findFrom(e,1),C=f&&f.$from.blockRange(f.$to),k=C&&(0,_.k9)(C);if(null!=k&&k>=e.depth)return t&&t(p.tr.lift(C,k).scrollIntoView()),!0;if(u&&pt(o,"start",!0)&&pt(n,"end")){let A=n,U=[];for(;U.push(A),!A.isTextblock;)A=A.lastChild;let it=o,ct=1;for(;!it.isTextblock;it=it.firstChild)ct++;if(A.canReplace(A.childCount,A.childCount,it.content)){if(t){let _t=I.HY.empty;for(let $t=U.length-1;$t>=0;$t--)_t=I.HY.from(U[$t].copy(_t));t(p.tr.step(new _.FC(e.pos-U.length,e.pos+o.nodeSize,e.pos+ct,e.pos+o.nodeSize-ct,new I.p2(_t,U.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Mt(p){return function(e,t){let n=e.selection,o=p<0?n.$from:n.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(t&&t(e.tr.setSelection(s.Bs.create(e.doc,p<0?o.start(i):o.end(i)))),!0)}}const Pt=Mt(-1),Kt=Mt(1);function Jt(p,e=null){return function(t,n){let o=!1;for(let i=0;i<t.selection.ranges.length&&!o;i++){let{$from:{pos:r},$to:{pos:u}}=t.selection.ranges[i];t.doc.nodesBetween(r,u,(f,C)=>{if(o)return!1;if(f.isTextblock&&!f.hasMarkup(p,e))if(f.type==p)o=!0;else{let k=t.doc.resolve(C),A=k.index();o=k.parent.canReplaceWith(A,A+1,p)}})}if(!o)return!1;if(n){let i=t.tr;for(let r=0;r<t.selection.ranges.length;r++){let{$from:{pos:u},$to:{pos:f}}=t.selection.ranges[r];i.setBlockType(u,f,p,e)}n(i.scrollIntoView())}return!0}}function me(...p){return function(e,t,n){for(let o=0;o<p.length;o++)if(p[o](e,t,n))return!0;return!1}}let fe=me(j,nt,Ot),ee=me(j,Q,W);const Wt={Enter:me(bt,Yt,Zt,(e,t)=>{let{$from:n,$to:o}=e.selection;if(e.selection instanceof s.qv&&e.selection.node.isBlock)return!(!n.parentOffset||!(0,_.Ax)(e.doc,n.pos)||(t&&t(e.tr.split(n.pos).scrollIntoView()),0));if(!n.parent.isBlock)return!1;if(t){let i=o.parentOffset==o.parent.content.size,r=e.tr;(e.selection instanceof s.Bs||e.selection instanceof s.C1)&&r.deleteSelection();let u=0==n.depth?null:lt(n.node(-1).contentMatchAt(n.indexAfter(-1))),f=p,C=f?[f]:i&&u?[{type:u}]:void 0,k=(0,_.Ax)(r.doc,r.mapping.map(n.pos),1,C);if(!C&&!k&&(0,_.Ax)(r.doc,r.mapping.map(n.pos),1,u?[{type:u}]:void 0)&&(u&&(C=[{type:u}]),k=!0),k&&(r.split(r.mapping.map(n.pos),1,C),!i&&!n.parentOffset&&n.parent.type!=u)){let A=r.mapping.map(n.before()),U=r.doc.resolve(A);u&&n.node(-1).canReplaceWith(U.index(),U.index()+1,u)&&r.setNodeMarkup(r.mapping.map(n.before()),u)}t(r.scrollIntoView())}return!0}),"Mod-Enter":Rt,Backspace:fe,"Mod-Backspace":fe,"Shift-Backspace":fe,Delete:ee,"Mod-Delete":ee,"Mod-a":(p,e)=>(e&&e(p.tr.setSelection(new s.C1(p.doc))),!0)},Nt={"Ctrl-h":Wt.Backspace,"Alt-Backspace":Wt["Mod-Backspace"],"Ctrl-d":Wt.Delete,"Ctrl-Alt-Backspace":Wt["Mod-Delete"],"Alt-Delete":Wt["Mod-Delete"],"Alt-d":Wt["Mod-Delete"],"Ctrl-a":Pt,"Ctrl-e":Kt};for(let p in Wt)Nt[p]=Wt[p];function ht(p){const{state:e,transaction:t}=p;let{selection:n}=t,{doc:o}=t,{storedMarks:i}=t;return ye(Xt({},e),{apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return n},get doc(){return o},get tr(){return n=t.selection,o=t.doc,i=t.storedMarks,t}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class M{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:o}=t,{tr:i}=n,r=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([u,f])=>[u,(...k)=>{const A=f(...k)(r);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(i),A}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:o,state:i}=this,{view:r}=o,u=[],f=!!e,C=e||i.tr,A=ye(Xt({},Object.fromEntries(Object.entries(n).map(([U,it])=>[U,(..._t)=>{const Bt=this.buildProps(C,t),$t=it(..._t)(Bt);return u.push($t),A}]))),{run:()=>(!f&&t&&!C.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(C),u.every(U=>!0===U))});return A}createCan(e){const{rawCommands:t,state:n}=this,i=e||n.tr,r=this.buildProps(i,!1),u=Object.fromEntries(Object.entries(t).map(([f,C])=>[f,(...k)=>C(...k)(ye(Xt({},r),{dispatch:void 0}))]));return ye(Xt({},u),{chain:()=>this.createChain(i,!1)})}buildProps(e,t=!0){const{rawCommands:n,editor:o,state:i}=this,{view:r}=o;i.storedMarks&&e.setStoredMarks(i.storedMarks);const u={tr:e,editor:o,view:r,state:ht({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([f,C])=>[f,(...k)=>C(...k)(u)]))}};return u}}function b(p,e,t){return void 0===p.config[e]&&p.parent?b(p.parent,e,t):"function"==typeof p.config[e]?p.config[e].bind(ye(Xt({},t),{parent:p.parent?b(p.parent,e,t):null})):p.config[e]}function B(p){return{baseExtensions:p.filter(o=>"extension"===o.type),nodeExtensions:p.filter(o=>"node"===o.type),markExtensions:p.filter(o=>"mark"===o.type)}}function D(p){const e=[],{nodeExtensions:t,markExtensions:n}=B(p),o=[...t,...n],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return p.forEach(r=>{const f=b(r,"addGlobalAttributes",{name:r.name,options:r.options,storage:r.storage});f&&f().forEach(k=>{k.types.forEach(A=>{Object.entries(k.attributes).forEach(([U,it])=>{e.push({type:A,name:U,attribute:Xt(Xt({},i),it)})})})})}),o.forEach(r=>{const f=b(r,"addAttributes",{name:r.name,options:r.options,storage:r.storage});if(!f)return;const C=f();Object.entries(C).forEach(([k,A])=>{const U=Xt(Xt({},i),A);"function"==typeof(null==U?void 0:U.default)&&(U.default=U.default()),(null==U?void 0:U.isRequired)&&void 0===(null==U?void 0:U.default)&&delete U.default,e.push({type:r.name,name:k,attribute:U})})}),e}function V(p,e){if("string"==typeof p){if(!e.nodes[p])throw Error(`There is no node type named '${p}'. Maybe you forgot to add the extension?`);return e.nodes[p]}return p}function mt(...p){return p.filter(e=>!!e).reduce((e,t)=>{const n=Xt({},e);return Object.entries(t).forEach(([o,i])=>{n[o]=n[o]?"class"===o?[n[o],i].join(" "):"style"===o?[n[o],i].join("; "):i:i}),n},{})}function Dt(p,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(p.attrs)||{}:{[t.name]:p.attrs[t.name]}).reduce((t,n)=>mt(t,n),{})}function R(p){return"function"==typeof p}function l(p,e,...t){return R(p)?e?p.bind(e)(...t):p(...t):p}function d(p={}){return 0===Object.keys(p).length&&p.constructor===Object}function y(p){return"string"!=typeof p?p:p.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(p):"true"===p||"false"!==p&&p}function O(p,e){return p.style?p:ye(Xt({},p),{getAttrs:t=>{const n=p.getAttrs?p.getAttrs(t):p.attrs;if(!1===n)return!1;const o=e.reduce((i,r)=>{const u=r.attribute.parseHTML?r.attribute.parseHTML(t):y(t.getAttribute(r.name));return null==u?i:ye(Xt({},i),{[r.name]:u})},{});return Xt(Xt({},n),o)}})}function w(p){return Object.fromEntries(Object.entries(p).filter(([e,t])=>("attrs"!==e||!d(t))&&null!=t))}function z(p,e){var t;const n=D(p),{nodeExtensions:o,markExtensions:i}=B(p),r=null===(t=o.find(C=>b(C,"topNode")))||void 0===t?void 0:t.name,u=Object.fromEntries(o.map(C=>{const k=n.filter($t=>$t.type===C.name),A={name:C.name,options:C.options,storage:C.storage,editor:e},U=p.reduce(($t,de)=>{const Se=b(de,"extendNodeSchema",A);return Xt(Xt({},$t),Se?Se(C):{})},{}),it=w(ye(Xt({},U),{content:l(b(C,"content",A)),marks:l(b(C,"marks",A)),group:l(b(C,"group",A)),inline:l(b(C,"inline",A)),atom:l(b(C,"atom",A)),selectable:l(b(C,"selectable",A)),draggable:l(b(C,"draggable",A)),code:l(b(C,"code",A)),defining:l(b(C,"defining",A)),isolating:l(b(C,"isolating",A)),attrs:Object.fromEntries(k.map($t=>{var de;return[$t.name,{default:null===(de=null==$t?void 0:$t.attribute)||void 0===de?void 0:de.default}]}))})),ct=l(b(C,"parseHTML",A));ct&&(it.parseDOM=ct.map($t=>O($t,k)));const _t=b(C,"renderHTML",A);_t&&(it.toDOM=$t=>_t({node:$t,HTMLAttributes:Dt($t,k)}));const Bt=b(C,"renderText",A);return Bt&&(it.toText=Bt),[C.name,it]})),f=Object.fromEntries(i.map(C=>{const k=n.filter(Bt=>Bt.type===C.name),A={name:C.name,options:C.options,storage:C.storage,editor:e},U=p.reduce((Bt,$t)=>{const de=b($t,"extendMarkSchema",A);return Xt(Xt({},Bt),de?de(C):{})},{}),it=w(ye(Xt({},U),{inclusive:l(b(C,"inclusive",A)),excludes:l(b(C,"excludes",A)),group:l(b(C,"group",A)),spanning:l(b(C,"spanning",A)),code:l(b(C,"code",A)),attrs:Object.fromEntries(k.map(Bt=>{var $t;return[Bt.name,{default:null===($t=null==Bt?void 0:Bt.attribute)||void 0===$t?void 0:$t.default}]}))})),ct=l(b(C,"parseHTML",A));ct&&(it.parseDOM=ct.map(Bt=>O(Bt,k)));const _t=b(C,"renderHTML",A);return _t&&(it.toDOM=Bt=>_t({mark:Bt,HTMLAttributes:Dt(Bt,k)})),[C.name,it]}));return new I.V_({topNode:r,nodes:u,marks:f})}function dt(p,e){return e.nodes[p]||e.marks[p]||null}function St(p,e){return Array.isArray(e)?e.some(t=>("string"==typeof t?t:t.name)===p.name):e}const ne=(p,e=500)=>{let t="";const n=p.parentOffset;return p.parent.nodesBetween(Math.max(0,n-e),n,(o,i,r,u)=>{var f,C;t+=((null===(C=(f=o.type.spec).toText)||void 0===C?void 0:C.call(f,{node:o,pos:i,parent:r,index:u}))||o.textContent||"%leaf%").slice(0,Math.max(0,n-i))}),t};function te(p){return"[object RegExp]"===Object.prototype.toString.call(p)}class Pe{constructor(e){this.find=e.find,this.handler=e.handler}}function S(p){var e;const{editor:t,from:n,to:o,text:i,rules:r,plugin:u}=p,{view:f}=t;if(f.composing)return!1;const C=f.state.doc.resolve(n);if(C.parent.type.spec.code||(null===(e=C.nodeBefore||C.nodeAfter)||void 0===e?void 0:e.marks.find(U=>U.type.spec.code)))return!1;let k=!1;const A=ne(C)+i;return r.forEach(U=>{if(k)return;const it=((p,e)=>{if(te(e))return e.exec(p);const t=e(p);if(!t)return null;const n=[t.text];return n.index=t.index,n.input=p,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(t.replaceWith)),n})(A,U.find);if(!it)return;const ct=f.state.tr,_t=ht({state:f.state,transaction:ct}),Bt={from:n-(it[0].length-i.length),to:o},{commands:$t,chain:de,can:Se}=new M({editor:t,state:_t});null===U.handler({state:_t,range:Bt,match:it,commands:$t,chain:de,can:Se})||!ct.steps.length||(ct.setMeta(u,{transform:ct,from:n,to:o,text:i}),f.dispatch(ct),k=!0)}),k}function at(p){const{editor:e,rules:t}=p,n=new s.Sy({state:{init:()=>null,apply:(o,i)=>o.getMeta(n)||(o.selectionSet||o.docChanged?null:i)},props:{handleTextInput:(o,i,r,u)=>S({editor:e,from:i,to:r,text:u,rules:t,plugin:n}),handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:i}=o.state.selection;i&&S({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:n})}),!1)},handleKeyDown(o,i){if("Enter"!==i.key)return!1;const{$cursor:r}=o.state.selection;return!!r&&S({editor:e,from:r.pos,to:r.pos,text:"\n",rules:t,plugin:n})}},isInputRules:!0});return n}function vt(p){return"number"==typeof p}class Ct{constructor(e){this.find=e.find,this.handler=e.handler}}function Vt(p){const{editor:e,rules:t}=p;let n=null,o=!1,i=!1;return t.map(u=>new s.Sy({view(f){const C=k=>{var A;n=(null===(A=f.dom.parentElement)||void 0===A?void 0:A.contains(k.target))?f.dom.parentElement:null};return window.addEventListener("dragstart",C),{destroy(){window.removeEventListener("dragstart",C)}}},props:{handleDOMEvents:{drop:f=>(i=n===f.dom.parentElement,!1),paste:(f,C)=>{var k;const A=null===(k=C.clipboardData)||void 0===k?void 0:k.getData("text/html");return o=!!(null==A?void 0:A.includes("data-pm-slice")),!1}}},appendTransaction:(f,C,k)=>{const A=f[0],U="paste"===A.getMeta("uiEvent")&&!o,it="drop"===A.getMeta("uiEvent")&&!i;if(!U&&!it)return;const ct=C.doc.content.findDiffStart(k.doc.content),_t=C.doc.content.findDiffEnd(k.doc.content);if(!vt(ct)||!_t||ct===_t.b)return;const Bt=k.tr,$t=ht({state:k,transaction:Bt});return function(p){const{editor:e,state:t,from:n,to:o,rule:i}=p,{commands:r,chain:u,can:f}=new M({editor:e,state:t}),C=[];return t.doc.nodesBetween(n,o,(A,U)=>{if(!A.isTextblock||A.type.spec.code)return;const it=Math.max(n,U),ct=Math.min(o,U+A.content.size);((p,e)=>{if(te(e))return[...p.matchAll(e)];const t=e(p);return t?t.map(n=>{const o=[n.text];return o.index=n.index,o.input=p,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(n.replaceWith)),o}):[]})(A.textBetween(it-U,ct-U,void 0,"\ufffc"),i.find).forEach($t=>{if(void 0===$t.index)return;const de=it+$t.index+1,Se=de+$t[0].length,He={from:t.tr.mapping.map(de),to:t.tr.mapping.map(Se)},$e=i.handler({state:t,range:He,match:$t,commands:r,chain:u,can:f});C.push($e)})}),C.every(A=>null!==A)}({editor:e,state:$t,from:Math.max(ct-1,0),to:_t.b-1,rule:u})&&Bt.steps.length?Bt:void 0}}))}function ue(p){const e=p.filter((t,n)=>p.indexOf(t)!==n);return[...new Set(e)]}class pe{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=pe.resolve(e),this.schema=z(this.extensions,t),this.extensions.forEach(n=>{var o;this.editor.extensionStorage[n.name]=n.storage;const i={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:dt(n.name,this.schema)};"mark"===n.type&&(null===(o=l(b(n,"keepOnSplit",i)))||void 0===o||o)&&this.splittableMarks.push(n.name);const r=b(n,"onBeforeCreate",i);r&&this.editor.on("beforeCreate",r);const u=b(n,"onCreate",i);u&&this.editor.on("create",u);const f=b(n,"onUpdate",i);f&&this.editor.on("update",f);const C=b(n,"onSelectionUpdate",i);C&&this.editor.on("selectionUpdate",C);const k=b(n,"onTransaction",i);k&&this.editor.on("transaction",k);const A=b(n,"onFocus",i);A&&this.editor.on("focus",A);const U=b(n,"onBlur",i);U&&this.editor.on("blur",U);const it=b(n,"onDestroy",i);it&&this.editor.on("destroy",it)})}static resolve(e){const t=pe.sort(pe.flatten(e)),n=ue(t.map(o=>o.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(o=>`'${o}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const o=b(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return o?[t,...this.flatten(o())]:t}).flat(10)}static sort(e){return e.sort((n,o)=>{const i=b(n,"priority")||100,r=b(o,"priority")||100;return i>r?-1:i<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const o=b(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:dt(t.name,this.schema)});return o?Xt(Xt({},e),o()):e},{})}get plugins(){const{editor:e}=this,t=pe.sort([...this.extensions].reverse()),n=[],o=[],i=t.map(r=>{const u={name:r.name,options:r.options,storage:r.storage,editor:e,type:dt(r.name,this.schema)},f=[],C=b(r,"addKeyboardShortcuts",u);let k={};if("mark"===r.type&&r.config.exitable&&(k.ArrowRight=()=>$n.handleExit({editor:e,mark:r})),C){const _t=Object.fromEntries(Object.entries(C()).map(([Bt,$t])=>[Bt,()=>$t({editor:e})]));k=Xt(Xt({},k),_t)}const A=(0,$.h)(k);f.push(A);const U=b(r,"addInputRules",u);St(r,e.options.enableInputRules)&&U&&n.push(...U());const it=b(r,"addPasteRules",u);St(r,e.options.enablePasteRules)&&it&&o.push(...it());const ct=b(r,"addProseMirrorPlugins",u);if(ct){const _t=ct();f.push(..._t)}return f}).flat();return[at({editor:e,rules:n}),...Vt({editor:e,rules:o}),...i]}get attributes(){return D(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=B(this.extensions);return Object.fromEntries(t.filter(n=>!!b(n,"addNodeView")).map(n=>{const o=this.attributes.filter(f=>f.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:e,type:V(n.name,this.schema)},r=b(n,"addNodeView",i);return r?[n.name,(f,C,k,A)=>{const U=Dt(f,o);return r()({editor:e,node:f,getPos:k,decorations:A,HTMLAttributes:U,extension:n})}]:[]}))}}function ce(p){return"Object"===function(p){return Object.prototype.toString.call(p).slice(8,-1)}(p)&&p.constructor===Object&&Object.getPrototypeOf(p)===Object.prototype}function Ce(p,e){const t=Xt({},p);return ce(p)&&ce(e)&&Object.keys(e).forEach(n=>{ce(e[n])?n in p?t[n]=Ce(p[n],e[n]):Object.assign(t,{[n]:e[n]}):Object.assign(t,{[n]:e[n]})}),t}class _e{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),e),this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=l(b(this,"addOptions",{name:this.name}))),this.storage=l(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new _e(e)}configure(e={}){const t=this.extend();return t.options=Ce(this.options,e),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new _e(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=l(b(t,"addOptions",{name:t.name})),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}}function je(p,e,t){const{from:n,to:o}=e,{blockSeparator:i="\n\n",textSerializers:r={}}=t||{};let u="",f=!0;return p.nodesBetween(n,o,(C,k,A,U)=>{var it;const ct=null==r?void 0:r[C.type.name];ct?(C.isBlock&&!f&&(u+=i,f=!0),A&&(u+=ct({node:C,pos:k,parent:A,index:U,range:e}))):C.isText?(u+=null===(it=null==C?void 0:C.text)||void 0===it?void 0:it.slice(Math.max(n,k)-k,o-k),f=!1):C.isBlock&&!f&&(u+=i,f=!0)}),u}function Be(p){return Object.fromEntries(Object.entries(p.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const nn=_e.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new s.Sy({key:new s.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:p}=this,{state:e,schema:t}=p,{doc:n,selection:o}=e,{ranges:i}=o;return je(n,{from:Math.min(...i.map(k=>k.$from.pos)),to:Math.max(...i.map(k=>k.$to.pos))},{textSerializers:Be(t)})}}})]}});function sn(p,e,t={strict:!0}){const n=Object.keys(e);return!n.length||n.every(o=>t.strict?e[o]===p[o]:te(e[o])?e[o].test(p[o]):e[o]===p[o])}function Qe(p,e,t={}){return p.find(n=>n.type===e&&sn(n.attrs,t))}function g(p,e,t={}){return!!Qe(p,e,t)}function v(p,e,t={}){if(!p||!e)return;let n=p.parent.childAfter(p.parentOffset);if(p.parentOffset===n.offset&&0!==n.offset&&(n=p.parent.childBefore(p.parentOffset)),!n.node)return;const o=Qe([...n.node.marks],e,t);if(!o)return;let i=n.index,r=p.start()+n.offset,u=i+1,f=r+n.node.nodeSize;for(Qe([...n.node.marks],e,t);i>0&&o.isInSet(p.parent.child(i-1).marks);)i-=1,r-=p.parent.child(i).nodeSize;for(;u<p.parent.childCount&&g([...p.parent.child(u).marks],e,t);)f+=p.parent.child(u).nodeSize,u+=1;return{from:r,to:f}}function m(p,e){if("string"==typeof p){if(!e.marks[p])throw Error(`There is no mark type named '${p}'. Maybe you forgot to add the extension?`);return e.marks[p]}return p}function E(p){return p instanceof s.Bs}function N(p=0,e=0,t=0){return Math.min(Math.max(p,e),t)}function Z(p,e=null){if(!e)return null;const t=s.Y1.atStart(p),n=s.Y1.atEnd(p);if("start"===e||!0===e)return t;if("end"===e)return n;const o=t.from,i=n.to;return"all"===e?s.Bs.create(p,N(0,o,i),N(p.content.size,o,i)):s.Bs.create(p,N(e,o,i),N(e,o,i))}function L(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function wt(p){const e=`<body>${p}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function Lt(p,e,t){if(t=Xt({slice:!0,parseOptions:{}},t),"object"==typeof p&&null!==p)try{return Array.isArray(p)&&p.length>0?I.HY.fromArray(p.map(n=>e.nodeFromJSON(n))):e.nodeFromJSON(p)}catch(n){return console.warn("[tiptap warn]: Invalid content.","Passed value:",p,"Error:",n),Lt("",e,t)}if("string"==typeof p){const n=I.aw.fromSchema(e);return t.slice?n.parseSlice(wt(p),t.parseOptions).content:n.parse(wt(p),t.parseOptions)}return Lt("",e,t)}function Qt(p,e,t){const n=p.steps.length-1;if(n<e)return;const o=p.steps[n];if(!(o instanceof _.Pu||o instanceof _.FC))return;let r=0;p.mapping.maps[n].forEach((u,f,C,k)=>{0===r&&(r=k)}),p.setSelection(s.Y1.near(p.doc.resolve(r),t))}function Ae(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function he(p,e,t={}){const{from:n,to:o,empty:i}=p.selection,r=e?V(e,p.schema):null,u=[];p.doc.nodesBetween(n,o,(A,U)=>{if(A.isText)return;const it=Math.max(n,U),ct=Math.min(o,U+A.nodeSize);u.push({node:A,from:it,to:ct})});const f=o-n,C=u.filter(A=>!r||r.name===A.node.type.name).filter(A=>sn(A.node.attrs,t,{strict:!1}));return i?!!C.length:C.reduce((A,U)=>A+U.to-U.from,0)>=f}function un(p,e){return e.nodes[p]?"node":e.marks[p]?"mark":null}function Re(p,e){const t="string"==typeof e?[e]:e;return Object.keys(p).reduce((n,o)=>(t.includes(o)||(n[o]=p[o]),n),{})}function Cn(p,e,t={}){return Lt(p,e,{slice:!1,parseOptions:t})}function fn(p,e){const t=new _.wx(p);return e.forEach(n=>{n.steps.forEach(o=>{t.step(o)})}),t}function ro(p){for(let e=0;e<p.edgeCount;e+=1){const{type:t}=p.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function jn(p,e){const t=[];return p.descendants((n,o)=>{e(n)&&t.push({node:n,pos:o})}),t}function In(p,e,t){const n=[];return p.nodesBetween(e.from,e.to,(o,i)=>{t(o)&&n.push({node:o,pos:i})}),n}function so(p,e){for(let t=p.depth;t>0;t-=1){const n=p.node(t);if(e(n))return{pos:t>0?p.before(t):0,start:p.start(t),depth:t,node:n}}}function Fn(p){return e=>so(e.$from,p)}function Yn(p,e){const t=I.PW.fromSchema(e).serializeFragment(p),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(t),o.innerHTML}function Un(p,e){return z(pe.resolve(p),e)}function ko(p,e){const t=Un(e);return Yn(I.NB.fromJSON(t,p).content,t)}function Ao(p,e){const t=Un(e),n=wt(p);return I.aw.fromSchema(t).parse(n).toJSON()}function Ln(p,e){return je(p,{from:0,to:p.content.size},e)}function lo(p,e,t){const{blockSeparator:n="\n\n",textSerializers:o={}}=t||{},i=Un(e);return Ln(I.NB.fromJSON(i,p),{blockSeparator:n,textSerializers:Xt(Xt({},Be(i)),o)})}function Vn(p,e){const t=m(e,p.schema),{from:n,to:o,empty:i}=p.selection,r=[];i?(p.storedMarks&&r.push(...p.storedMarks),r.push(...p.selection.$head.marks())):p.doc.nodesBetween(n,o,f=>{r.push(...f.marks)});const u=r.find(f=>f.type.name===t.name);return u?Xt({},u.attrs):{}}function Qn(p,e){const t=V(e,p.schema),{from:n,to:o}=p.selection,i=[];p.doc.nodesBetween(n,o,u=>{i.push(u)});const r=i.reverse().find(u=>u.type.name===t.name);return r?Xt({},r.attrs):{}}function ao(p,e){const t=un("string"==typeof e?e:e.name,p.schema);return"node"===t?Qn(p,e):"mark"===t?Vn(p,e):{}}function Gn(p,e=JSON.stringify){const t={};return p.filter(n=>{const o=e(n);return!Object.prototype.hasOwnProperty.call(t,o)&&(t[o]=!0)})}function So(p){const{mapping:e,steps:t}=p,n=[];return e.maps.forEach((o,i)=>{const r=[];if(o.ranges.length)o.forEach((u,f)=>{r.push({from:u,to:f})});else{const{from:u,to:f}=t[i];if(void 0===u||void 0===f)return;r.push({from:u,to:f})}r.forEach(({from:u,to:f})=>{const C=e.slice(i).map(u,-1),k=e.slice(i).map(f),A=e.invert().map(C,-1),U=e.invert().map(k);n.push({oldRange:{from:A,to:U},newRange:{from:C,to:k}})})}),function(p){const e=Gn(p);return 1===e.length?e:e.filter((t,n)=>!e.filter((i,r)=>r!==n).some(i=>t.oldRange.from>=i.oldRange.from&&t.oldRange.to<=i.oldRange.to&&t.newRange.from>=i.newRange.from&&t.newRange.to<=i.newRange.to))}(n)}function Bn(p,e=0){const n=p.type===p.type.schema.topNodeType?0:1,o=e,i=o+p.nodeSize,r=p.marks.map(C=>{const k={type:C.type.name};return Object.keys(C.attrs).length&&(k.attrs=Xt({},C.attrs)),k}),u=Xt({},p.attrs),f={type:p.type.name,from:o,to:i};return Object.keys(u).length&&(f.attrs=u),r.length&&(f.marks=r),p.content.childCount&&(f.content=[],p.forEach((C,k)=>{var A;null===(A=f.content)||void 0===A||A.push(Bn(C,e+k+n))})),p.text&&(f.text=p.text),f}function Xn(p,e,t){const n=[];return p===e?t.resolve(p).marks().forEach(o=>{const r=v(t.resolve(p-1),o.type);!r||n.push(Xt({mark:o},r))}):t.nodesBetween(p,e,(o,i)=>{n.push(...o.marks.map(r=>({from:i,to:i+o.nodeSize,mark:r})))}),n}function ln(p,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const o=p.find(i=>i.type===e&&i.name===n);return!!o&&o.attribute.keepOnSplit}))}function Wn(p,e,t={}){const{empty:n,ranges:o}=p.selection,i=e?m(e,p.schema):null;if(n)return!!(p.storedMarks||p.selection.$from.marks()).filter(A=>!i||i.name===A.type.name).find(A=>sn(A.attrs,t,{strict:!1}));let r=0;const u=[];if(o.forEach(({$from:A,$to:U})=>{const it=A.pos,ct=U.pos;p.doc.nodesBetween(it,ct,(_t,Bt)=>{if(!_t.isText&&!_t.marks.length)return;const $t=Math.max(it,Bt),de=Math.min(ct,Bt+_t.nodeSize);r+=de-$t,u.push(..._t.marks.map(He=>({mark:He,from:$t,to:de})))})}),0===r)return!1;const f=u.filter(A=>!i||i.name===A.mark.type.name).filter(A=>sn(A.mark.attrs,t,{strict:!1})).reduce((A,U)=>A+U.to-U.from,0),C=u.filter(A=>!i||A.mark.type!==i&&A.mark.type.excludes(i)).reduce((A,U)=>A+U.to-U.from,0);return(f>0?f+C:f)>=r}function uo(p,e,t={}){if(!e)return he(p,null,t)||Wn(p,null,t);const n=un(e,p.schema);return"node"===n?he(p,e,t):"mark"===n&&Wn(p,e,t)}function xn(p,e){const{nodeExtensions:t}=B(e),n=t.find(r=>r.name===p);if(!n)return!1;const i=l(b(n,"group",{name:n.name,options:n.options,storage:n.storage}));return"string"==typeof i&&i.split(" ").includes("list")}function po(p){var e;const t=null===(e=p.type.createAndFill())||void 0===e?void 0:e.toJSON(),n=p.toJSON();return JSON.stringify(t)===JSON.stringify(n)}function fo(p){return p instanceof s.qv}function Hn(p,e,t){const o=p.state.doc.content.size,i=N(e,0,o),r=N(t,0,o),u=p.coordsAtPos(i),f=p.coordsAtPos(r,-1),C=Math.min(u.top,f.top),k=Math.max(u.bottom,f.bottom),A=Math.min(u.left,f.left),U=Math.max(u.right,f.right),$t={top:C,bottom:k,left:A,right:U,width:U-A,height:k-C,x:A,y:C};return ye(Xt({},$t),{toJSON:()=>$t})}function Ye(p,e){const t=p.storedMarks||p.selection.$to.parentOffset&&p.selection.$from.marks();if(t){const n=t.filter(o=>null==e?void 0:e.includes(o.type.name));p.tr.ensureMarks(n)}}const Jn=(p,e)=>{const t=Fn(r=>r.type===e)(p.selection);if(!t)return!0;const n=p.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(void 0===n)return!0;const o=p.doc.nodeAt(n);return t.node.type===(null==o?void 0:o.type)&&(0,_.Mn)(p.doc,t.pos)&&p.join(t.pos),!0},eo=(p,e)=>{const t=Fn(r=>r.type===e)(p.selection);if(!t)return!0;const n=p.doc.resolve(t.start).after(t.depth);if(void 0===n)return!0;const o=p.doc.nodeAt(n);return t.node.type===(null==o?void 0:o.type)&&(0,_.Mn)(p.doc,n)&&p.join(n),!0};var No=Object.freeze({__proto__:null,blur:()=>({editor:p,view:e})=>(requestAnimationFrame(()=>{var t;p.isDestroyed||(e.dom.blur(),null===(t=null==window?void 0:window.getSelection())||void 0===t||t.removeAllRanges())}),!0),clearContent:(p=!1)=>({commands:e})=>e.setContent("",p),clearNodes:()=>({state:p,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:o}=n;return t&&o.forEach(({$from:i,$to:r})=>{p.doc.nodesBetween(i.pos,r.pos,(u,f)=>{if(u.type.isText)return;const{doc:C,mapping:k}=e,A=C.resolve(k.map(f)),U=C.resolve(k.map(f+u.nodeSize)),it=A.blockRange(U);if(!it)return;const ct=(0,_.k9)(it);if(u.type.isTextblock){const{defaultType:_t}=A.parent.contentMatchAt(A.index());e.setNodeMarkup(it.start,_t)}(ct||0===ct)&&e.lift(it,ct)})}),!0},command:p=>e=>p(e),createParagraphNear:()=>({state:p,dispatch:e})=>Yt(p,e),deleteCurrentNode:()=>({tr:p,dispatch:e})=>{const{selection:t}=p,n=t.$anchor.node();if(n.content.size>0)return!1;const o=p.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===n.type){if(e){const u=o.before(i),f=o.after(i);p.delete(u,f).scrollIntoView()}return!0}return!1},deleteNode:p=>({tr:e,state:t,dispatch:n})=>{const o=V(p,t.schema),i=e.selection.$anchor;for(let r=i.depth;r>0;r-=1)if(i.node(r).type===o){if(n){const f=i.before(r),C=i.after(r);e.delete(f,C).scrollIntoView()}return!0}return!1},deleteRange:p=>({tr:e,dispatch:t})=>{const{from:n,to:o}=p;return t&&e.delete(n,o),!0},deleteSelection:()=>({state:p,dispatch:e})=>j(p,e),enter:()=>({commands:p})=>p.keyboardShortcut("Enter"),exitCode:()=>({state:p,dispatch:e})=>Rt(p,e),extendMarkRange:(p,e={})=>({tr:t,state:n,dispatch:o})=>{const i=m(p,n.schema),{doc:r,selection:u}=t,{$from:f,from:C,to:k}=u;if(o){const A=v(f,i,e);if(A&&A.from<=C&&A.to>=k){const U=s.Bs.create(r,A.from,A.to);t.setSelection(U)}}return!0},first:p=>e=>{const t="function"==typeof p?p(e):p;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1},focus:(p=null,e={})=>({editor:t,view:n,tr:o,dispatch:i})=>{e=Xt({scrollIntoView:!0},e);const r=()=>{L()&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),(null==e?void 0:e.scrollIntoView)&&t.commands.scrollIntoView())})};if(n.hasFocus()&&null===p||!1===p)return!0;if(i&&null===p&&!E(t.state.selection))return r(),!0;const u=Z(o.doc,p)||t.state.selection,f=t.state.selection.eq(u);return i&&(f||o.setSelection(u),f&&o.storedMarks&&o.setStoredMarks(o.storedMarks),r()),!0},forEach:(p,e)=>t=>p.every((n,o)=>e(n,ye(Xt({},t),{index:o}))),insertContent:(p,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},p,e),insertContentAt:(p,e,t)=>({tr:n,dispatch:o,editor:i})=>{if(o){t=Xt({parseOptions:{},updateSelection:!0},t);const r=Lt(e,i.schema,{parseOptions:Xt({preserveWhitespace:"full"},t.parseOptions)});if("<>"===r.toString())return!0;let{from:u,to:f}="number"==typeof p?{from:p,to:p}:p,C=!0,k=!0;if(((p=>p.toString().startsWith("<"))(r)?r:[r]).forEach(U=>{U.check(),C=!!C&&U.isText&&0===U.marks.length,k=!!k&&U.isBlock}),u===f&&k){const{parent:U}=n.doc.resolve(u);U.isTextblock&&!U.type.spec.code&&!U.childCount&&(u-=1,f+=1)}C?Array.isArray(e)?n.insertText(e.map(U=>U.text||"").join(""),u,f):n.insertText("object"==typeof e&&e&&e.text?e.text:e,u,f):n.replaceWith(u,f,r),t.updateSelection&&Qt(n,n.steps.length-1,-1)}return!0},joinUp:()=>({state:p,dispatch:e})=>((p,e)=>{let o,t=p.selection,n=t instanceof s.qv;if(n){if(t.node.isTextblock||!(0,_.Mn)(p.doc,t.from))return!1;o=t.from}else if(o=(0,_.GJ)(p.doc,t.from,-1),null==o)return!1;if(e){let i=p.tr.join(o);n&&i.setSelection(s.qv.create(i.doc,o-p.doc.resolve(o).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0})(p,e),joinDown:()=>({state:p,dispatch:e})=>((p,e)=>{let n,t=p.selection;if(t instanceof s.qv){if(t.node.isTextblock||!(0,_.Mn)(p.doc,t.to))return!1;n=t.to}else if(n=(0,_.GJ)(p.doc,t.to,1),null==n)return!1;return e&&e(p.tr.join(n).scrollIntoView()),!0})(p,e),joinBackward:()=>({state:p,dispatch:e})=>nt(p,e),joinForward:()=>({state:p,dispatch:e})=>Q(p,e),keyboardShortcut:p=>({editor:e,view:t,tr:n,dispatch:o})=>{const i=function(p){const e=p.split(/-(?!$)/);let n,o,i,r,t=e[e.length-1];"Space"===t&&(t=" ");for(let u=0;u<e.length-1;u+=1){const f=e[u];if(/^(cmd|meta|m)$/i.test(f))r=!0;else if(/^a(lt)?$/i.test(f))n=!0;else if(/^(c|ctrl|control)$/i.test(f))o=!0;else if(/^s(hift)?$/i.test(f))i=!0;else{if(!/^mod$/i.test(f))throw new Error(`Unrecognized modifier name: ${f}`);L()||Ae()?r=!0:o=!0}}return n&&(t=`Alt-${t}`),o&&(t=`Ctrl-${t}`),r&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}(p).split(/-(?!$)/),r=i.find(C=>!["Alt","Ctrl","Meta","Shift"].includes(C)),u=new KeyboardEvent("keydown",{key:"Space"===r?" ":r,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),f=e.captureTransaction(()=>{t.someProp("handleKeyDown",C=>C(t,u))});return null==f||f.steps.forEach(C=>{const k=C.map(n.mapping);k&&o&&n.maybeStep(k)}),!0},lift:(p,e={})=>({state:t,dispatch:n})=>!!he(t,V(p,t.schema),e)&&((p,e)=>{let{$from:t,$to:n}=p.selection,o=t.blockRange(n),i=o&&(0,_.k9)(o);return null!=i&&(e&&e(p.tr.lift(o,i).scrollIntoView()),!0)})(t,n),liftEmptyBlock:()=>({state:p,dispatch:e})=>Zt(p,e),liftListItem:p=>({state:e,dispatch:t})=>function(p){return function(e,t){let{$from:n,$to:o}=e.selection,i=n.blockRange(o,r=>r.childCount>0&&r.firstChild.type==p);return!!i&&(!t||(n.node(i.depth-1).type==p?function(p,e,t,n){let o=p.tr,i=n.end,r=n.$to.end(n.depth);i<r&&(o.step(new _.FC(i-1,r,i,r,new I.p2(I.HY.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new I.Ts(o.doc.resolve(n.$from.pos),o.doc.resolve(r),n.depth));const u=(0,_.k9)(n);if(null==u)return!1;o.lift(n,u);let f=o.mapping.map(i,-1)-1;return(0,_.Mn)(o.doc,f)&&o.join(f),e(o.scrollIntoView()),!0}(e,t,p,i):function(p,e,t){let n=p.tr,o=t.parent;for(let it=t.end,ct=t.endIndex-1,_t=t.startIndex;ct>_t;ct--)it-=o.child(ct).nodeSize,n.delete(it-1,it+1);let i=n.doc.resolve(t.start),r=i.nodeAfter;if(n.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let u=0==t.startIndex,f=t.endIndex==o.childCount,C=i.node(-1),k=i.index(-1);if(!C.canReplace(k+(u?0:1),k+1,r.content.append(f?I.HY.empty:I.HY.from(o))))return!1;let A=i.pos,U=A+r.nodeSize;return n.step(new _.FC(A-(u?1:0),U+(f?1:0),A+1,U-1,new I.p2((u?I.HY.empty:I.HY.from(o.copy(I.HY.empty))).append(f?I.HY.empty:I.HY.from(o.copy(I.HY.empty))),u?0:1,f?0:1),u?0:1)),e(n.scrollIntoView()),!0}(e,t,i)))}}(V(p,e.schema))(e,t),newlineInCode:()=>({state:p,dispatch:e})=>bt(p,e),resetAttributes:(p,e)=>({tr:t,state:n,dispatch:o})=>{let i=null,r=null;const u=un("string"==typeof p?p:p.name,n.schema);return!!u&&("node"===u&&(i=V(p,n.schema)),"mark"===u&&(r=m(p,n.schema)),o&&t.selection.ranges.forEach(f=>{n.doc.nodesBetween(f.$from.pos,f.$to.pos,(C,k)=>{i&&i===C.type&&t.setNodeMarkup(k,void 0,Re(C.attrs,e)),r&&C.marks.length&&C.marks.forEach(A=>{r===A.type&&t.addMark(k,k+C.nodeSize,r.create(Re(A.attrs,e)))})})}),!0)},scrollIntoView:()=>({tr:p,dispatch:e})=>(e&&p.scrollIntoView(),!0),selectAll:()=>({tr:p,commands:e})=>e.setTextSelection({from:0,to:p.doc.content.size}),selectNodeBackward:()=>({state:p,dispatch:e})=>Ot(p,e),selectNodeForward:()=>({state:p,dispatch:e})=>W(p,e),selectParentNode:()=>({state:p,dispatch:e})=>((p,e)=>{let o,{$from:t,to:n}=p.selection,i=t.sharedDepth(n);return 0!=i&&(o=t.before(i),e&&e(p.tr.setSelection(s.qv.create(p.doc,o))),!0)})(p,e),selectTextblockEnd:()=>({state:p,dispatch:e})=>Kt(p,e),selectTextblockStart:()=>({state:p,dispatch:e})=>Pt(p,e),setContent:(p,e=!1,t={})=>({tr:n,editor:o,dispatch:i})=>{const{doc:r}=n,u=Cn(p,o.schema,t);return i&&n.replaceWith(0,r.content.size,u).setMeta("preventUpdate",!e),!0},setMark:(p,e={})=>({tr:t,state:n,dispatch:o})=>{const{selection:i}=t,{empty:r,ranges:u}=i,f=m(p,n.schema);if(o)if(r){const C=Vn(n,f);t.addStoredMark(f.create(Xt(Xt({},C),e)))}else u.forEach(C=>{const k=C.$from.pos,A=C.$to.pos;n.doc.nodesBetween(k,A,(U,it)=>{const ct=Math.max(it,k),_t=Math.min(it+U.nodeSize,A);U.marks.find($t=>$t.type===f)?U.marks.forEach($t=>{f===$t.type&&t.addMark(ct,_t,f.create(Xt(Xt({},$t.attrs),e)))}):t.addMark(ct,_t,f.create(e))})});return function(p,e,t){var n;const{selection:o}=e;let i=null;if(E(o)&&(i=o.$cursor),i){const u=null!==(n=p.storedMarks)&&void 0!==n?n:i.marks();return!!t.isInSet(u)||!u.some(f=>f.type.excludes(t))}const{ranges:r}=o;return r.some(({$from:u,$to:f})=>{let C=0===u.depth&&p.doc.inlineContent&&p.doc.type.allowsMarkType(t);return p.doc.nodesBetween(u.pos,f.pos,(k,A,U)=>{if(C)return!1;if(k.isInline){const it=!U||U.type.allowsMarkType(t),ct=!!t.isInSet(k.marks)||!k.marks.some(_t=>_t.type.excludes(t));C=it&&ct}return!C}),C})}(n,t,f)},setMeta:(p,e)=>({tr:t})=>(t.setMeta(p,e),!0),setNode:(p,e={})=>({state:t,dispatch:n,chain:o})=>{const i=V(p,t.schema);return i.isTextblock?o().command(({commands:r})=>!!Jt(i,e)(t)||r.clearNodes()).command(({state:r})=>Jt(i,e)(r,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:p=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,o=N(p,0,n.content.size),i=s.qv.create(n,o);e.setSelection(i)}return!0},setTextSelection:p=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:o,to:i}="number"==typeof p?{from:p,to:p}:p,r=s.Bs.atStart(n).from,u=s.Bs.atEnd(n).to,f=N(o,r,u),C=N(i,r,u),k=s.Bs.create(n,f,C);e.setSelection(k)}return!0},sinkListItem:p=>({state:e,dispatch:t})=>function(p){return function(e,t){let{$from:n,$to:o}=e.selection,i=n.blockRange(o,C=>C.childCount>0&&C.firstChild.type==p);if(!i)return!1;let r=i.startIndex;if(0==r)return!1;let u=i.parent,f=u.child(r-1);if(f.type!=p)return!1;if(t){let C=f.lastChild&&f.lastChild.type==u.type,k=I.HY.from(C?p.create():null),A=new I.p2(I.HY.from(p.create(null,I.HY.from(u.type.create(null,k)))),C?3:1,0),U=i.start,it=i.end;t(e.tr.step(new _.FC(U-(C?3:1),it,U,it,A,1,!0)).scrollIntoView())}return!0}}(V(p,e.schema))(e,t),splitBlock:({keepMarks:p=!0}={})=>({tr:e,state:t,dispatch:n,editor:o})=>{const{selection:i,doc:r}=e,{$from:u,$to:f}=i,k=ln(o.extensionManager.attributes,u.node().type.name,u.node().attrs);if(i instanceof s.qv&&i.node.isBlock)return!(!u.parentOffset||!(0,_.Ax)(r,u.pos)||(n&&(p&&Ye(t,o.extensionManager.splittableMarks),e.split(u.pos).scrollIntoView()),0));if(!u.parent.isBlock)return!1;if(n){const A=f.parentOffset===f.parent.content.size;i instanceof s.Bs&&e.deleteSelection();const U=0===u.depth?void 0:ro(u.node(-1).contentMatchAt(u.indexAfter(-1)));let it=A&&U?[{type:U,attrs:k}]:void 0,ct=(0,_.Ax)(e.doc,e.mapping.map(u.pos),1,it);if(!it&&!ct&&(0,_.Ax)(e.doc,e.mapping.map(u.pos),1,U?[{type:U}]:void 0)&&(ct=!0,it=U?[{type:U,attrs:k}]:void 0),ct&&(e.split(e.mapping.map(u.pos),1,it),U&&!A&&!u.parentOffset&&u.parent.type!==U)){const _t=e.mapping.map(u.before()),Bt=e.doc.resolve(_t);u.node(-1).canReplaceWith(Bt.index(),Bt.index()+1,U)&&e.setNodeMarkup(e.mapping.map(u.before()),U)}p&&Ye(t,o.extensionManager.splittableMarks),e.scrollIntoView()}return!0},splitListItem:p=>({tr:e,state:t,dispatch:n,editor:o})=>{var i;const r=V(p,t.schema),{$from:u,$to:f}=t.selection,C=t.selection.node;if(C&&C.isBlock||u.depth<2||!u.sameParent(f))return!1;const k=u.node(-1);if(k.type!==r)return!1;const A=o.extensionManager.attributes;if(0===u.parent.content.size&&u.node(-1).childCount===u.indexAfter(-1)){if(2===u.depth||u.node(-3).type!==r||u.index(-2)!==u.node(-2).childCount-1)return!1;if(n){let Bt=I.HY.empty;const $t=u.index(-1)?1:u.index(-2)?2:3;for(let an=u.depth-$t;an>=u.depth-3;an-=1)Bt=I.HY.from(u.node(an).copy(Bt));const de=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,Se=ln(A,u.node().type.name,u.node().attrs),He=(null===(i=r.contentMatch.defaultType)||void 0===i?void 0:i.createAndFill(Se))||void 0;Bt=Bt.append(I.HY.from(r.createAndFill(null,He)||void 0));const $e=u.before(u.depth-($t-1));e.replace($e,u.after(-de),new I.p2(Bt,4-$t,0));let ze=-1;e.doc.nodesBetween($e,e.doc.content.size,(an,Pn)=>{if(ze>-1)return!1;an.isTextblock&&0===an.content.size&&(ze=Pn+1)}),ze>-1&&e.setSelection(s.Bs.near(e.doc.resolve(ze))),e.scrollIntoView()}return!0}const U=f.pos===u.end()?k.contentMatchAt(0).defaultType:null,it=ln(A,k.type.name,k.attrs),ct=ln(A,u.node().type.name,u.node().attrs);e.delete(u.pos,f.pos);const _t=U?[{type:r,attrs:it},{type:U,attrs:ct}]:[{type:r,attrs:it}];if(!(0,_.Ax)(e.doc,u.pos,2))return!1;if(n){const{selection:Bt,storedMarks:$t}=t,{splittableMarks:de}=o.extensionManager,Se=$t||Bt.$to.parentOffset&&Bt.$from.marks();if(e.split(u.pos,2,_t).scrollIntoView(),!Se||!n)return!0;const He=Se.filter($e=>de.includes($e.type.name));e.ensureMarks(He)}return!0},toggleList:(p,e,t,n={})=>({editor:o,tr:i,state:r,dispatch:u,chain:f,commands:C,can:k})=>{const{extensions:A,splittableMarks:U}=o.extensionManager,it=V(p,r.schema),ct=V(e,r.schema),{selection:_t,storedMarks:Bt}=r,{$from:$t,$to:de}=_t,Se=$t.blockRange(de),He=Bt||_t.$to.parentOffset&&_t.$from.marks();if(!Se)return!1;const $e=Fn(ze=>xn(ze.type.name,A))(_t);if(Se.depth>=1&&$e&&Se.depth-$e.depth<=1){if($e.node.type===it)return C.liftListItem(ct);if(xn($e.node.type.name,A)&&it.validContent($e.node.content)&&u)return f().command(()=>(i.setNodeMarkup($e.pos,it),!0)).command(()=>Jn(i,it)).command(()=>eo(i,it)).run()}return t&&He&&u?f().command(()=>{const ze=k().wrapInList(it,n),an=He.filter(Pn=>U.includes(Pn.type.name));return i.ensureMarks(an),!!ze||C.clearNodes()}).wrapInList(it,n).command(()=>Jn(i,it)).command(()=>eo(i,it)).run():f().command(()=>!!k().wrapInList(it,n)||C.clearNodes()).wrapInList(it,n).command(()=>Jn(i,it)).command(()=>eo(i,it)).run()},toggleMark:(p,e={},t={})=>({state:n,commands:o})=>{const{extendEmptyMarkRange:i=!1}=t,r=m(p,n.schema);return Wn(n,r,e)?o.unsetMark(r,{extendEmptyMarkRange:i}):o.setMark(r,e)},toggleNode:(p,e,t={})=>({state:n,commands:o})=>{const i=V(p,n.schema),r=V(e,n.schema);return he(n,i,t)?o.setNode(r):o.setNode(i,t)},toggleWrap:(p,e={})=>({state:t,commands:n})=>{const o=V(p,t.schema);return he(t,o,e)?n.lift(o):n.wrapIn(o,e)},undoInputRule:()=>({state:p,dispatch:e})=>{const t=p.plugins;for(let n=0;n<t.length;n+=1){const o=t[n];let i;if(o.spec.isInputRules&&(i=o.getState(p))){if(e){const r=p.tr,u=i.transform;for(let f=u.steps.length-1;f>=0;f-=1)r.step(u.steps[f].invert(u.docs[f]));if(i.text){const f=r.doc.resolve(i.from).marks();r.replaceWith(i.from,i.to,p.schema.text(i.text,f))}else r.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>({tr:p,dispatch:e})=>{const{selection:t}=p,{empty:n,ranges:o}=t;return n||e&&o.forEach(i=>{p.removeMark(i.$from.pos,i.$to.pos)}),!0},unsetMark:(p,e={})=>({tr:t,state:n,dispatch:o})=>{var i;const{extendEmptyMarkRange:r=!1}=e,{selection:u}=t,f=m(p,n.schema),{$from:C,empty:k,ranges:A}=u;if(!o)return!0;if(k&&r){let{from:U,to:it}=u;const ct=null===(i=C.marks().find(Bt=>Bt.type===f))||void 0===i?void 0:i.attrs,_t=v(C,f,ct);_t&&(U=_t.from,it=_t.to),t.removeMark(U,it,f)}else A.forEach(U=>{t.removeMark(U.$from.pos,U.$to.pos,f)});return t.removeStoredMark(f),!0},updateAttributes:(p,e={})=>({tr:t,state:n,dispatch:o})=>{let i=null,r=null;const u=un("string"==typeof p?p:p.name,n.schema);return!!u&&("node"===u&&(i=V(p,n.schema)),"mark"===u&&(r=m(p,n.schema)),o&&t.selection.ranges.forEach(f=>{const C=f.$from.pos,k=f.$to.pos;n.doc.nodesBetween(C,k,(A,U)=>{i&&i===A.type&&t.setNodeMarkup(U,void 0,Xt(Xt({},A.attrs),e)),r&&A.marks.length&&A.marks.forEach(it=>{if(r===it.type){const ct=Math.max(U,C),_t=Math.min(U+A.nodeSize,k);t.addMark(ct,_t,r.create(Xt(Xt({},it.attrs),e)))}})})}),!0)},wrapIn:(p,e={})=>({state:t,dispatch:n})=>function(p,e=null){return function(t,n){let{$from:o,$to:i}=t.selection,r=o.blockRange(i),u=r&&(0,_.nd)(r,p,e);return!!u&&(n&&n(t.tr.wrap(r,u).scrollIntoView()),!0)}}(V(p,t.schema),e)(t,n),wrapInList:(p,e={})=>({state:t,dispatch:n})=>function(p,e=null){return function(t,n){let{$from:o,$to:i}=t.selection,r=o.blockRange(i),u=!1,f=r;if(!r)return!1;if(r.depth>=2&&o.node(r.depth-1).type.compatibleContent(p)&&0==r.startIndex){if(0==o.index(r.depth-1))return!1;let k=t.doc.resolve(r.start-2);f=new I.Ts(k,k,r.depth),r.endIndex<r.parent.childCount&&(r=new I.Ts(o,t.doc.resolve(i.end(r.depth)),r.depth)),u=!0}let C=(0,_.nd)(f,p,e,r);return!!C&&(n&&n(function(p,e,t,n,o){let i=I.HY.empty;for(let k=t.length-1;k>=0;k--)i=I.HY.from(t[k].type.create(t[k].attrs,i));p.step(new _.FC(e.start-(n?2:0),e.end,e.start,e.end,new I.p2(i,0,0),t.length,!0));let r=0;for(let k=0;k<t.length;k++)t[k].type==o&&(r=k+1);let u=t.length-r,f=e.start+t.length-(n?2:0),C=e.parent;for(let k=e.startIndex,A=e.endIndex,U=!0;k<A;k++,U=!1)!U&&(0,_.Ax)(p.doc,f,u)&&(p.split(f,u),f+=2*u),f+=C.child(k).nodeSize;return p}(t.tr,r,C,u,p).scrollIntoView()),!0)}}(V(p,t.schema),e)(t,n)});const go=_e.create({name:"commands",addCommands:()=>Xt({},No)}),_o=_e.create({name:"editable",addProseMirrorPlugins(){return[new s.Sy({key:new s.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ro=_e.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:p}=this;return[new s.Sy({key:new s.H$("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{p.isFocused=!0;const n=p.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{p.isFocused=!1;const n=p.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),Lo=_e.create({name:"keymap",addKeyboardShortcuts(){const p=()=>this.editor.commands.first(({commands:r})=>[()=>r.undoInputRule(),()=>r.command(({tr:u})=>{const{selection:f,doc:C}=u,{empty:k,$anchor:A}=f,{pos:U,parent:it}=A,ct=s.Y1.atStart(C).from===U;return!(!(k&&ct&&it.type.isTextblock)||it.textContent.length)&&r.clearNodes()}),()=>r.deleteSelection(),()=>r.joinBackward(),()=>r.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:r})=>[()=>r.deleteSelection(),()=>r.deleteCurrentNode(),()=>r.joinForward(),()=>r.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:r})=>[()=>r.newlineInCode(),()=>r.createParagraphNear(),()=>r.liftEmptyBlock(),()=>r.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:p,"Mod-Backspace":p,"Shift-Backspace":p,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},o=Xt({},n),i=ye(Xt({},n),{"Ctrl-h":p,"Alt-Backspace":p,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return L()||Ae()?i:o},addProseMirrorPlugins(){return[new s.Sy({key:new s.H$("clearDocument"),appendTransaction:(p,e,t)=>{if(!p.some(ct=>ct.docChanged)||e.doc.eq(t.doc))return;const{empty:o,from:i,to:r}=e.selection,u=s.Y1.atStart(e.doc).from,f=s.Y1.atEnd(e.doc).to;if(o||i!==u||r!==f||0!==t.doc.textBetween(0,t.doc.content.size," "," ").length)return;const A=t.tr,U=ht({state:t,transaction:A}),{commands:it}=new M({editor:this.editor,state:U});return it.clearNodes(),A.steps.length?A:void 0}})]}}),Bo=_e.create({name:"tabindex",addProseMirrorPlugins(){return[new s.Sy({key:new s.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Co=Object.freeze({__proto__:null,ClipboardTextSerializer:nn,Commands:go,Editable:_o,FocusEvents:Ro,Keymap:Lo,Tabindex:Bo});function vo(p,e){const t=document.querySelector("style[data-tiptap-style]");if(null!==t)return t;const n=document.createElement("style");return e&&n.setAttribute("nonce",e),n.setAttribute("data-tiptap-style",""),n.innerHTML=p,document.getElementsByTagName("head")[0].appendChild(n),n}class yo extends class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(o=>o.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(o=>o!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=vo('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(e={}){this.options=Xt(Xt({},this.options),e),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=R(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],o=this.state.reconfigure({plugins:n});this.view.updateState(o)}unregisterPlugin(e){if(this.isDestroyed)return;const t="string"==typeof e?`${e}$`:e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter(o=>!o.key.startsWith(t))});this.view.updateState(n)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(Co):[],...this.options.extensions].filter(n=>["extension","node","mark"].includes(null==n?void 0:n.type));this.extensionManager=new pe(t,this)}createCommandManager(){this.commandManager=new M({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Cn(this.options.content,this.schema,this.options.parseOptions),t=Z(e,this.options.autofocus);this.view=new c.tk(this.options.element,ye(Xt({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:s.yy.create({doc:e,selection:t||void 0})}));const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(r=>{var u;return null===(u=this.capturedTransaction)||void 0===u?void 0:u.step(r)}):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const o=e.getMeta("focus"),i=e.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return ao(this.state,e)}isActive(e,t){return uo(this.state,"string"==typeof e?e:null,"string"==typeof e?t:e)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Yn(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return Ln(this.state.doc,{blockSeparator:t,textSerializers:Xt(Xt({},Be(this.schema)),n)})}get isEmpty(){return po(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}}function zo(p){return new Pe({find:p.find,handler:({state:e,range:t,match:n})=>{const o=l(p.getAttributes,void 0,n);if(!1===o||null===o)return null;const{tr:i}=e,r=n[n.length-1],u=n[0];let f=t.to;if(r){const C=u.search(/\S/),k=t.from+u.indexOf(r),A=k+r.length;if(Xn(t.from,t.to,e.doc).filter(it=>it.mark.type.excluded.find(_t=>_t===p.type&&_t!==it.mark.type)).filter(it=>it.to>k).length)return null;A<t.to&&i.delete(A,t.to),k>t.from&&i.delete(t.from+C,k),f=t.from+C+r.length,i.addMark(t.from+C,f,p.type.create(o||{})),i.removeStoredMark(p.type)}}})}function Fo(p){return new Pe({find:p.find,handler:({state:e,range:t,match:n})=>{const o=l(p.getAttributes,void 0,n)||{},{tr:i}=e,r=t.from;let u=t.to;if(n[1]){let C=r+n[0].lastIndexOf(n[1]);C>u?C=u:u=C+n[1].length,i.insertText(n[0][n[0].length-1],r+n[0].length-1),i.replaceWith(C,u,p.type.create(o))}else n[0]&&i.replaceWith(r,u,p.type.create(o))}})}function oo(p){return new Pe({find:p.find,handler:({state:e,range:t,match:n})=>{const o=e.doc.resolve(t.from),i=l(p.getAttributes,void 0,n)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),p.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,p.type,i)}})}function Uo(p){return new Pe({find:p.find,handler:({state:e,range:t,match:n})=>{let o=p.replace,i=t.from;const r=t.to;if(n[1]){const u=n[0].lastIndexOf(n[1]);o+=n[0].slice(u+n[1].length),i+=u;const f=i-r;f>0&&(o=n[0].slice(u-f,u)+o,i=r)}e.tr.insertText(o,i,r)}})}function Yo(p){return new Pe({find:p.find,handler:({state:e,range:t,match:n,chain:o})=>{const i=l(p.getAttributes,void 0,n)||{},r=e.tr.delete(t.from,t.to),f=r.doc.resolve(t.from).blockRange(),C=f&&(0,_.nd)(f,p.type,i);if(!C)return null;if(r.wrap(f,C),p.keepMarks&&p.editor){const{selection:A,storedMarks:U}=e,{splittableMarks:it}=p.editor.extensionManager,ct=U||A.$to.parentOffset&&A.$from.marks();if(ct){const _t=ct.filter(Bt=>it.includes(Bt.type.name));r.ensureMarks(_t)}}if(p.keepAttributes){const A="bulletList"===p.type.name||"orderedList"===p.type.name?"listItem":"taskList";o().updateAttributes(A,i).run()}const k=r.doc.resolve(t.from-1).nodeBefore;k&&k.type===p.type&&(0,_.Mn)(r.doc,t.from-1)&&(!p.joinPredicate||p.joinPredicate(n,k))&&r.join(t.from-1)}})}class $n{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),e),this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=l(b(this,"addOptions",{name:this.name}))),this.storage=l(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new $n(e)}configure(e={}){const t=this.extend();return t.options=Ce(this.options,e),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new $n(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=l(b(t,"addOptions",{name:t.name})),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const r=o.marks();if(!r.find(C=>(null==C?void 0:C.type.name)===t.name))return!1;const f=r.find(C=>(null==C?void 0:C.type.name)===t.name);return f&&n.removeStoredMark(f),n.insertText(" ",o.pos),e.view.dispatch(n),!0}return!1}}class io{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),e),this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=l(b(this,"addOptions",{name:this.name}))),this.storage=l(b(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new io(e)}configure(e={}){const t=this.extend();return t.options=Ce(this.options,e),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new io(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=l(b(t,"addOptions",{name:t.name})),t.storage=l(b(t,"addStorage",{name:t.name,options:t.options})),t}}class Wo{constructor(e,t,n){this.isDragging=!1,this.component=e,this.editor=t.editor,this.options=Xt({stopEvent:null,ignoreMutation:null},n),this.extension=t.extension,this.node=t.node,this.decorations=t.decorations,this.getPos=t.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var t,n,o,i,r,u,f;const{view:C}=this.editor,k=e.target,A=3===k.nodeType?null===(t=k.parentElement)||void 0===t?void 0:t.closest("[data-drag-handle]"):k.closest("[data-drag-handle]");if(!this.dom||(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(k))||!A)return;let U=0,it=0;if(this.dom!==A){const Bt=this.dom.getBoundingClientRect(),$t=A.getBoundingClientRect(),de=null!==(o=e.offsetX)&&void 0!==o?o:null===(i=e.nativeEvent)||void 0===i?void 0:i.offsetX,Se=null!==(r=e.offsetY)&&void 0!==r?r:null===(u=e.nativeEvent)||void 0===u?void 0:u.offsetY;U=$t.x-Bt.x+de,it=$t.y-Bt.y+Se}null===(f=e.dataTransfer)||void 0===f||f.setDragImage(this.dom,U,it);const ct=s.qv.create(C.state.doc,this.getPos()),_t=C.state.tr.setSelection(ct);C.dispatch(_t)}stopEvent(e){var t;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:e});const n=e.target;if(!this.dom.contains(n)||(null===(t=this.contentDOM)||void 0===t?void 0:t.contains(n)))return!1;const i=e.type.startsWith("drag"),r="drop"===e.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!r&&!i)return!0;const{isEditable:f}=this.editor,{isDragging:C}=this,k=!!this.node.type.spec.draggable,A=s.qv.isSelectable(this.node),U="copy"===e.type,it="paste"===e.type,ct="cut"===e.type,_t="mousedown"===e.type;if(!k&&A&&i&&e.preventDefault(),k&&i&&!C)return e.preventDefault(),!1;if(k&&f&&!C&&_t){const Bt=n.closest("[data-drag-handle]");Bt&&(this.dom===Bt||this.dom.contains(Bt))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(C||r||U||it||ct||_t&&A)}ignoreMutation(e){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:e}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===e.type||this.dom.contains(e.target)&&"childList"===e.type&&L()&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(n=>n.isContentEditable)||(this.contentDOM!==e.target||"attributes"!==e.type)&&this.contentDOM.contains(e.target))))}updateAttributes(e){this.editor.commands.command(({tr:t})=>{const n=this.getPos();return t.setNodeMarkup(n,void 0,Xt(Xt({},this.node.attrs),e)),!0})}deleteNode(){const e=this.getPos();this.editor.commands.deleteRange({from:e,to:e+this.node.nodeSize})}}function To(p){return new Ct({find:p.find,handler:({state:e,range:t,match:n})=>{const o=l(p.getAttributes,void 0,n);if(!1===o||null===o)return null;const{tr:i}=e,r=n[n.length-1],u=n[0];let f=t.to;if(r){const C=u.search(/\S/),k=t.from+u.indexOf(r),A=k+r.length;if(Xn(t.from,t.to,e.doc).filter(it=>it.mark.type.excluded.find(_t=>_t===p.type&&_t!==it.mark.type)).filter(it=>it.to>k).length)return null;A<t.to&&i.delete(A,t.to),k>t.from&&i.delete(t.from+C,k),f=t.from+C+r.length,i.addMark(t.from+C,f,p.type.create(o||{})),i.removeStoredMark(p.type)}}})}function bo(p){return p.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function Mo(p){return"string"==typeof p}function Jo(p){return new Ct({find:p.find,handler({match:e,chain:t,range:n}){const o=l(p.getAttributes,void 0,e);if(!1===o||null===o)return null;e.input&&t().deleteRange(n).insertContentAt(n.from,{type:p.type.name,attrs:o})}})}function xo(p){return new Ct({find:p.find,handler:({state:e,range:t,match:n})=>{let o=p.replace,i=t.from;const r=t.to;if(n[1]){const u=n[0].lastIndexOf(n[1]);o+=n[0].slice(u+n[1].length),i+=u;const f=i-r;f>0&&(o=n[0].slice(u-f,u)+o,i=r)}e.tr.insertText(o,i,r)}})}class $o{constructor(e){this.transaction=e,this.currentStep=this.transaction.steps.length}map(e){let t=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((o,i)=>{const r=i.getMap().mapResult(o);return r.deleted&&(t=!0),r.pos},e),deleted:t}}}},54424:(Gt,yt,a)=>{a.r(yt),a.d(yt,{Heading:()=>c,default:()=>c});var s=a(11046);const c=s.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map($=>({tag:`h${$}`,attrs:{level:$}}))},renderHTML({node:$,HTMLAttributes:I}){return[`h${this.options.levels.includes($.attrs.level)?$.attrs.level:this.options.levels[0]}`,(0,s.mergeAttributes)(this.options.HTMLAttributes,I),0]},addCommands(){return{setHeading:$=>({commands:I})=>!!this.options.levels.includes($.level)&&I.setNode(this.name,$),toggleHeading:$=>({commands:I})=>!!this.options.levels.includes($.level)&&I.toggleNode(this.name,"paragraph",$)}},addKeyboardShortcuts(){return this.options.levels.reduce(($,I)=>ye(Xt({},$),{[`Mod-Alt-${I}`]:()=>this.editor.commands.toggleHeading({level:I})}),{})},addInputRules(){return this.options.levels.map($=>(0,s.textblockTypeInputRule)({find:new RegExp(`^(#{1,${$}})\\s$`),type:this.type,getAttributes:{level:$}}))}})},44632:(Gt,yt,a)=>{a.r(yt),a.d(yt,{Image:()=>$,default:()=>$,inputRegex:()=>c});var s=a(11046);const c=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,$=s.Node.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:I}){return["img",(0,s.mergeAttributes)(this.options.HTMLAttributes,I)]},addCommands(){return{setImage:I=>({commands:_})=>_.insertContent({type:this.name,attrs:I})}},addInputRules(){return[(0,s.nodeInputRule)({find:c,type:this.type,getAttributes:I=>{const[,,_,j,F]=I;return{src:j,alt:_,title:F}}})]}})},84402:(Gt,yt,a)=>{a.r(yt),a.d(yt,{TextStyle:()=>c,default:()=>c});var s=a(11046);const c=s.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:$=>!!$.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:$}){return["span",(0,s.mergeAttributes)(this.options.HTMLAttributes,$),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:$,commands:I})=>{const _=(0,s.getMarkAttributes)($,this.type);return!!Object.entries(_).some(([,F])=>!!F)||I.unsetMark(this.name)}}}})},31690:(Gt,yt,a)=>{a.d(yt,{$:()=>ft,h:()=>Ot});for(var s={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},$="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),I="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),_=0;_<10;_++)s[48+_]=s[96+_]=String(_);for(_=1;_<=24;_++)s[_+111]="F"+_;for(_=65;_<=90;_++)s[_]=String.fromCharCode(_+32),c[_]=String.fromCharCode(_);for(var j in s)c.hasOwnProperty(j)||(c[j]=s[j]);var nt=a(62463);const Y="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function q(st){let tt,ut,ot,xt,Q=st.split(/-(?!$)/),W=Q[Q.length-1];"Space"==W&&(W=" ");for(let bt=0;bt<Q.length-1;bt++){let lt=Q[bt];if(/^(cmd|meta|m)$/i.test(lt))xt=!0;else if(/^a(lt)?$/i.test(lt))tt=!0;else if(/^(c|ctrl|control)$/i.test(lt))ut=!0;else if(/^s(hift)?$/i.test(lt))ot=!0;else{if(!/^mod$/i.test(lt))throw new Error("Unrecognized modifier name: "+lt);Y?xt=!0:ut=!0}}return tt&&(W="Alt-"+W),ut&&(W="Ctrl-"+W),xt&&(W="Meta-"+W),ot&&(W="Shift-"+W),W}function pt(st,Q,W=!0){return Q.altKey&&(st="Alt-"+st),Q.ctrlKey&&(st="Ctrl-"+st),Q.metaKey&&(st="Meta-"+st),W&&Q.shiftKey&&(st="Shift-"+st),st}function Ot(st){return new nt.Sy({props:{handleKeyDown:ft(st)}})}function ft(st){let Q=function(st){let Q=Object.create(null);for(let W in st)Q[q(W)]=st[W];return Q}(st);return function(W,tt){let ot,ut=function(st){var W=!($&&st.metaKey&&st.shiftKey&&!st.ctrlKey&&!st.altKey||I&&st.shiftKey&&st.key&&1==st.key.length||"Unidentified"==st.key)&&st.key||(st.shiftKey?c:s)[st.keyCode]||st.key||"Unidentified";return"Esc"==W&&(W="Escape"),"Del"==W&&(W="Delete"),"Left"==W&&(W="ArrowLeft"),"Up"==W&&(W="ArrowUp"),"Right"==W&&(W="ArrowRight"),"Down"==W&&(W="ArrowDown"),W}(tt),xt=Q[pt(ut,tt)];if(xt&&xt(W.state,W.dispatch,W))return!0;if(1==ut.length&&" "!=ut){if(tt.shiftKey){let bt=Q[pt(ut,tt,!1)];if(bt&&bt(W.state,W.dispatch,W))return!0}if((tt.shiftKey||tt.altKey||tt.metaKey||ut.charCodeAt(0)>127)&&(ot=s[tt.keyCode])&&ot!=ut){let bt=Q[pt(ot,tt)];if(bt&&bt(W.state,W.dispatch,W))return!0}}return!1}}},27439:(Gt,yt,a)=>{function s(R){this.content=R}a.d(yt,{aw:()=>xe,PW:()=>V,HY:()=>_,vc:()=>Y,ZU:()=>ae,NB:()=>X,Ts:()=>At,e4:()=>q,V_:()=>Me,p2:()=>et}),s.prototype={constructor:s,find:function(R){for(var l=0;l<this.content.length;l+=2)if(this.content[l]===R)return l;return-1},get:function(R){var l=this.find(R);return-1==l?void 0:this.content[l+1]},update:function(R,l,d){var y=d&&d!=R?this.remove(d):this,O=y.find(R),w=y.content.slice();return-1==O?w.push(d||R,l):(w[O+1]=l,d&&(w[O]=d)),new s(w)},remove:function(R){var l=this.find(R);if(-1==l)return this;var d=this.content.slice();return d.splice(l,2),new s(d)},addToStart:function(R,l){return new s([R,l].concat(this.remove(R).content))},addToEnd:function(R,l){var d=this.remove(R).content.slice();return d.push(R,l),new s(d)},addBefore:function(R,l,d){var y=this.remove(l),O=y.content.slice(),w=y.find(R);return O.splice(-1==w?O.length:w,0,l,d),new s(O)},forEach:function(R){for(var l=0;l<this.content.length;l+=2)R(this.content[l],this.content[l+1])},prepend:function(R){return(R=s.from(R)).size?new s(R.content.concat(this.subtract(R).content)):this},append:function(R){return(R=s.from(R)).size?new s(this.subtract(R).content.concat(R.content)):this},subtract:function(R){var l=this;R=s.from(R);for(var d=0;d<R.content.length;d+=2)l=l.remove(R.content[d]);return l},toObject:function(){var R={};return this.forEach(function(l,d){R[l]=d}),R},get size(){return this.content.length>>1}},s.from=function(R){if(R instanceof s)return R;var l=[];if(R)for(var d in R)l.push(d,R[d]);return new s(l)};const c=s;function $(R,l,d){for(let y=0;;y++){if(y==R.childCount||y==l.childCount)return R.childCount==l.childCount?null:d;let O=R.child(y),w=l.child(y);if(O!=w){if(!O.sameMarkup(w))return d;if(O.isText&&O.text!=w.text){for(let z=0;O.text[z]==w.text[z];z++)d++;return d}if(O.content.size||w.content.size){let z=$(O.content,w.content,d+1);if(null!=z)return z}d+=O.nodeSize}else d+=O.nodeSize}}function I(R,l,d,y){for(let O=R.childCount,w=l.childCount;;){if(0==O||0==w)return O==w?null:{a:d,b:y};let z=R.child(--O),dt=l.child(--w),St=z.nodeSize;if(z!=dt){if(!z.sameMarkup(dt))return{a:d,b:y};if(z.isText&&z.text!=dt.text){let ne=0,te=Math.min(z.text.length,dt.text.length);for(;ne<te&&z.text[z.text.length-ne-1]==dt.text[dt.text.length-ne-1];)ne++,d--,y--;return{a:d,b:y}}if(z.content.size||dt.content.size){let ne=I(z.content,dt.content,d-1,y-1);if(ne)return ne}d-=St,y-=St}else d-=St,y-=St}}class _{constructor(l,d){if(this.content=l,this.size=d||0,null==d)for(let y=0;y<l.length;y++)this.size+=l[y].nodeSize}nodesBetween(l,d,y,O=0,w){for(let z=0,dt=0;dt<d;z++){let St=this.content[z],ne=dt+St.nodeSize;if(ne>l&&!1!==y(St,O+dt,w||null,z)&&St.content.size){let te=dt+1;St.nodesBetween(Math.max(0,l-te),Math.min(St.content.size,d-te),y,O+te)}dt=ne}}descendants(l){this.nodesBetween(0,this.size,l)}textBetween(l,d,y,O){let w="",z=!0;return this.nodesBetween(l,d,(dt,St)=>{dt.isText?(w+=dt.text.slice(Math.max(l,St)-St,d-St),z=!y):dt.isLeaf?(O?w+="function"==typeof O?O(dt):O:dt.type.spec.leafText&&(w+=dt.type.spec.leafText(dt)),z=!y):!z&&dt.isBlock&&(w+=y,z=!0)},0),w}append(l){if(!l.size)return this;if(!this.size)return l;let d=this.lastChild,y=l.firstChild,O=this.content.slice(),w=0;for(d.isText&&d.sameMarkup(y)&&(O[O.length-1]=d.withText(d.text+y.text),w=1);w<l.content.length;w++)O.push(l.content[w]);return new _(O,this.size+l.size)}cut(l,d=this.size){if(0==l&&d==this.size)return this;let y=[],O=0;if(d>l)for(let w=0,z=0;z<d;w++){let dt=this.content[w],St=z+dt.nodeSize;St>l&&((z<l||St>d)&&(dt=dt.isText?dt.cut(Math.max(0,l-z),Math.min(dt.text.length,d-z)):dt.cut(Math.max(0,l-z-1),Math.min(dt.content.size,d-z-1))),y.push(dt),O+=dt.nodeSize),z=St}return new _(y,O)}cutByIndex(l,d){return l==d?_.empty:0==l&&d==this.content.length?this:new _(this.content.slice(l,d))}replaceChild(l,d){let y=this.content[l];if(y==d)return this;let O=this.content.slice(),w=this.size+d.nodeSize-y.nodeSize;return O[l]=d,new _(O,w)}addToStart(l){return new _([l].concat(this.content),this.size+l.nodeSize)}addToEnd(l){return new _(this.content.concat(l),this.size+l.nodeSize)}eq(l){if(this.content.length!=l.content.length)return!1;for(let d=0;d<this.content.length;d++)if(!this.content[d].eq(l.content[d]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(l){let d=this.content[l];if(!d)throw new RangeError("Index "+l+" out of range for "+this);return d}maybeChild(l){return this.content[l]||null}forEach(l){for(let d=0,y=0;d<this.content.length;d++){let O=this.content[d];l(O,y,d),y+=O.nodeSize}}findDiffStart(l,d=0){return $(this,l,d)}findDiffEnd(l,d=this.size,y=l.size){return I(this,l,d,y)}findIndex(l,d=-1){if(0==l)return F(0,l);if(l==this.size)return F(this.content.length,l);if(l>this.size||l<0)throw new RangeError(`Position ${l} outside of fragment (${this})`);for(let y=0,O=0;;y++){let z=O+this.child(y).nodeSize;if(z>=l)return z==l||d>0?F(y+1,z):F(y,O);O=z}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(l=>l.toJSON()):null}static fromJSON(l,d){if(!d)return _.empty;if(!Array.isArray(d))throw new RangeError("Invalid input for Fragment.fromJSON");return new _(d.map(l.nodeFromJSON))}static fromArray(l){if(!l.length)return _.empty;let d,y=0;for(let O=0;O<l.length;O++){let w=l[O];y+=w.nodeSize,O&&w.isText&&l[O-1].sameMarkup(w)?(d||(d=l.slice(0,O)),d[d.length-1]=w.withText(d[d.length-1].text+w.text)):d&&d.push(w)}return new _(d||l,y)}static from(l){if(!l)return _.empty;if(l instanceof _)return l;if(Array.isArray(l))return this.fromArray(l);if(l.attrs)return new _([l],l.nodeSize);throw new RangeError("Can not convert "+l+" to a Fragment"+(l.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}_.empty=new _([],0);const j={index:0,offset:0};function F(R,l){return j.index=R,j.offset=l,j}function nt(R,l){if(R===l)return!0;if(!R||"object"!=typeof R||!l||"object"!=typeof l)return!1;let d=Array.isArray(R);if(Array.isArray(l)!=d)return!1;if(d){if(R.length!=l.length)return!1;for(let y=0;y<R.length;y++)if(!nt(R[y],l[y]))return!1}else{for(let y in R)if(!(y in l)||!nt(R[y],l[y]))return!1;for(let y in l)if(!(y in R))return!1}return!0}let Y=(()=>{class R{constructor(d,y){this.type=d,this.attrs=y}addToSet(d){let y,O=!1;for(let w=0;w<d.length;w++){let z=d[w];if(this.eq(z))return d;if(this.type.excludes(z.type))y||(y=d.slice(0,w));else{if(z.type.excludes(this.type))return d;!O&&z.type.rank>this.type.rank&&(y||(y=d.slice(0,w)),y.push(this),O=!0),y&&y.push(z)}}return y||(y=d.slice()),O||y.push(this),y}removeFromSet(d){for(let y=0;y<d.length;y++)if(this.eq(d[y]))return d.slice(0,y).concat(d.slice(y+1));return d}isInSet(d){for(let y=0;y<d.length;y++)if(this.eq(d[y]))return!0;return!1}eq(d){return this==d||this.type==d.type&&nt(this.attrs,d.attrs)}toJSON(){let d={type:this.type.name};for(let y in this.attrs){d.attrs=this.attrs;break}return d}static fromJSON(d,y){if(!y)throw new RangeError("Invalid input for Mark.fromJSON");let O=d.marks[y.type];if(!O)throw new RangeError(`There is no mark type ${y.type} in this schema`);return O.create(y.attrs)}static sameSet(d,y){if(d==y)return!0;if(d.length!=y.length)return!1;for(let O=0;O<d.length;O++)if(!d[O].eq(y[O]))return!1;return!0}static setFrom(d){if(!d||Array.isArray(d)&&0==d.length)return R.none;if(d instanceof R)return[d];let y=d.slice();return y.sort((O,w)=>O.type.rank-w.type.rank),y}}return R.none=[],R})();class q extends Error{}class et{constructor(l,d,y){this.content=l,this.openStart=d,this.openEnd=y}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(l,d){let y=Ot(this.content,l+this.openStart,d);return y&&new et(y,this.openStart,this.openEnd)}removeBetween(l,d){return new et(pt(this.content,l+this.openStart,d+this.openStart),this.openStart,this.openEnd)}eq(l){return this.content.eq(l.content)&&this.openStart==l.openStart&&this.openEnd==l.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let l={content:this.content.toJSON()};return this.openStart>0&&(l.openStart=this.openStart),this.openEnd>0&&(l.openEnd=this.openEnd),l}static fromJSON(l,d){if(!d)return et.empty;let y=d.openStart||0,O=d.openEnd||0;if("number"!=typeof y||"number"!=typeof O)throw new RangeError("Invalid input for Slice.fromJSON");return new et(_.fromJSON(l,d.content),y,O)}static maxOpen(l,d=!0){let y=0,O=0;for(let w=l.firstChild;w&&!w.isLeaf&&(d||!w.type.spec.isolating);w=w.firstChild)y++;for(let w=l.lastChild;w&&!w.isLeaf&&(d||!w.type.spec.isolating);w=w.lastChild)O++;return new et(l,y,O)}}function pt(R,l,d){let{index:y,offset:O}=R.findIndex(l),w=R.maybeChild(y),{index:z,offset:dt}=R.findIndex(d);if(O==l||w.isText){if(dt!=d&&!R.child(z).isText)throw new RangeError("Removing non-flat range");return R.cut(0,l).append(R.cut(d))}if(y!=z)throw new RangeError("Removing non-flat range");return R.replaceChild(y,w.copy(pt(w.content,l-O-1,d-O-1)))}function Ot(R,l,d,y){let{index:O,offset:w}=R.findIndex(l),z=R.maybeChild(O);if(w==l||z.isText)return y&&!y.canReplace(O,O,d)?null:R.cut(0,l).append(d).append(R.cut(l));let dt=Ot(z.content,l-w-1,d);return dt&&R.replaceChild(O,z.copy(dt))}function ft(R,l,d){if(d.openStart>R.depth)throw new q("Inserted content deeper than insertion position");if(R.depth-d.openStart!=l.depth-d.openEnd)throw new q("Inconsistent open depths");return st(R,l,d,0)}function st(R,l,d,y){let O=R.index(y),w=R.node(y);if(O==l.index(y)&&y<R.depth-d.openStart){let z=st(R,l,d,y+1);return w.copy(w.content.replaceChild(O,z))}if(d.content.size){if(d.openStart||d.openEnd||R.depth!=y||l.depth!=y){let{start:z,end:dt}=function(R,l){let d=l.depth-R.openStart,O=l.node(d).copy(R.content);for(let w=d-1;w>=0;w--)O=l.node(w).copy(_.from(O));return{start:O.resolveNoCache(R.openStart+d),end:O.resolveNoCache(O.content.size-R.openEnd-d)}}(d,R);return ot(w,xt(R,z,dt,l,y))}{let z=R.parent,dt=z.content;return ot(z,dt.cut(0,R.parentOffset).append(d.content).append(dt.cut(l.parentOffset)))}}return ot(w,bt(R,l,y))}function Q(R,l){if(!l.type.compatibleContent(R.type))throw new q("Cannot join "+l.type.name+" onto "+R.type.name)}function W(R,l,d){let y=R.node(d);return Q(y,l.node(d)),y}function tt(R,l){let d=l.length-1;d>=0&&R.isText&&R.sameMarkup(l[d])?l[d]=R.withText(l[d].text+R.text):l.push(R)}function ut(R,l,d,y){let O=(l||R).node(d),w=0,z=l?l.index(d):O.childCount;R&&(w=R.index(d),R.depth>d?w++:R.textOffset&&(tt(R.nodeAfter,y),w++));for(let dt=w;dt<z;dt++)tt(O.child(dt),y);l&&l.depth==d&&l.textOffset&&tt(l.nodeBefore,y)}function ot(R,l){return R.type.checkContent(l),R.copy(l)}function xt(R,l,d,y,O){let w=R.depth>O&&W(R,l,O+1),z=y.depth>O&&W(d,y,O+1),dt=[];return ut(null,R,O,dt),w&&z&&l.index(O)==d.index(O)?(Q(w,z),tt(ot(w,xt(R,l,d,y,O+1)),dt)):(w&&tt(ot(w,bt(R,l,O+1)),dt),ut(l,d,O,dt),z&&tt(ot(z,bt(d,y,O+1)),dt)),ut(y,null,O,dt),new _(dt)}function bt(R,l,d){let y=[];return ut(null,R,d,y),R.depth>d&&tt(ot(W(R,l,d+1),bt(R,l,d+1)),y),ut(l,null,d,y),new _(y)}et.empty=new et(_.empty,0,0);class Rt{constructor(l,d,y){this.pos=l,this.path=d,this.parentOffset=y,this.depth=d.length/3-1}resolveDepth(l){return null==l?this.depth:l<0?this.depth+l:l}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(l){return this.path[3*this.resolveDepth(l)]}index(l){return this.path[3*this.resolveDepth(l)+1]}indexAfter(l){return l=this.resolveDepth(l),this.index(l)+(l!=this.depth||this.textOffset?1:0)}start(l){return 0==(l=this.resolveDepth(l))?0:this.path[3*l-1]+1}end(l){return l=this.resolveDepth(l),this.start(l)+this.node(l).content.size}before(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position before the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]}after(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position after the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]+this.path[3*l].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let l=this.parent,d=this.index(this.depth);if(d==l.childCount)return null;let y=this.pos-this.path[this.path.length-1],O=l.child(d);return y?l.child(d).cut(y):O}get nodeBefore(){let l=this.index(this.depth),d=this.pos-this.path[this.path.length-1];return d?this.parent.child(l).cut(0,d):0==l?null:this.parent.child(l-1)}posAtIndex(l,d){d=this.resolveDepth(d);let y=this.path[3*d],O=0==d?0:this.path[3*d-1]+1;for(let w=0;w<l;w++)O+=y.child(w).nodeSize;return O}marks(){let l=this.parent,d=this.index();if(0==l.content.size)return Y.none;if(this.textOffset)return l.child(d).marks;let y=l.maybeChild(d-1),O=l.maybeChild(d);if(!y){let dt=y;y=O,O=dt}let w=y.marks;for(var z=0;z<w.length;z++)!1===w[z].type.spec.inclusive&&(!O||!w[z].isInSet(O.marks))&&(w=w[z--].removeFromSet(w));return w}marksAcross(l){let d=this.parent.maybeChild(this.index());if(!d||!d.isInline)return null;let y=d.marks,O=l.parent.maybeChild(l.index());for(var w=0;w<y.length;w++)!1===y[w].type.spec.inclusive&&(!O||!y[w].isInSet(O.marks))&&(y=y[w--].removeFromSet(y));return y}sharedDepth(l){for(let d=this.depth;d>0;d--)if(this.start(d)<=l&&this.end(d)>=l)return d;return 0}blockRange(l=this,d){if(l.pos<this.pos)return l.blockRange(this);for(let y=this.depth-(this.parent.inlineContent||this.pos==l.pos?1:0);y>=0;y--)if(l.pos<=this.end(y)&&(!d||d(this.node(y))))return new At(this,l,y);return null}sameParent(l){return this.pos-this.parentOffset==l.pos-l.parentOffset}max(l){return l.pos>this.pos?l:this}min(l){return l.pos<this.pos?l:this}toString(){let l="";for(let d=1;d<=this.depth;d++)l+=(l?"/":"")+this.node(d).type.name+"_"+this.index(d-1);return l+":"+this.parentOffset}static resolve(l,d){if(!(d>=0&&d<=l.content.size))throw new RangeError("Position "+d+" out of range");let y=[],O=0,w=d;for(let z=l;;){let{index:dt,offset:St}=z.content.findIndex(w),ne=w-St;if(y.push(z,dt,O+St),!ne||(z=z.child(dt),z.isText))break;w=ne-1,O+=St+1}return new Rt(d,y,w)}static resolveCached(l,d){for(let O=0;O<Yt.length;O++){let w=Yt[O];if(w.pos==d&&w.doc==l)return w}let y=Yt[Zt]=Rt.resolve(l,d);return Zt=(Zt+1)%Ht,y}}let Yt=[],Zt=0,Ht=12;class At{constructor(l,d,y){this.$from=l,this.$to=d,this.depth=y}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Et=Object.create(null);class X{constructor(l,d,y,O=Y.none){this.type=l,this.attrs=d,this.marks=O,this.content=y||_.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(l){return this.content.child(l)}maybeChild(l){return this.content.maybeChild(l)}forEach(l){this.content.forEach(l)}nodesBetween(l,d,y,O=0){this.content.nodesBetween(l,d,y,O,this)}descendants(l){this.nodesBetween(0,this.content.size,l)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(l,d,y,O){return this.content.textBetween(l,d,y,O)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(l){return this==l||this.sameMarkup(l)&&this.content.eq(l.content)}sameMarkup(l){return this.hasMarkup(l.type,l.attrs,l.marks)}hasMarkup(l,d,y){return this.type==l&&nt(this.attrs,d||l.defaultAttrs||Et)&&Y.sameSet(this.marks,y||Y.none)}copy(l=null){return l==this.content?this:new X(this.type,this.attrs,l,this.marks)}mark(l){return l==this.marks?this:new X(this.type,this.attrs,this.content,l)}cut(l,d=this.content.size){return 0==l&&d==this.content.size?this:this.copy(this.content.cut(l,d))}slice(l,d=this.content.size,y=!1){if(l==d)return et.empty;let O=this.resolve(l),w=this.resolve(d),z=y?0:O.sharedDepth(d),dt=O.start(z),ne=O.node(z).content.cut(O.pos-dt,w.pos-dt);return new et(ne,O.depth-z,w.depth-z)}replace(l,d,y){return ft(this.resolve(l),this.resolve(d),y)}nodeAt(l){for(let d=this;;){let{index:y,offset:O}=d.content.findIndex(l);if(d=d.maybeChild(y),!d)return null;if(O==l||d.isText)return d;l-=O+1}}childAfter(l){let{index:d,offset:y}=this.content.findIndex(l);return{node:this.content.maybeChild(d),index:d,offset:y}}childBefore(l){if(0==l)return{node:null,index:0,offset:0};let{index:d,offset:y}=this.content.findIndex(l);if(y<l)return{node:this.content.child(d),index:d,offset:y};let O=this.content.child(d-1);return{node:O,index:d-1,offset:y-O.nodeSize}}resolve(l){return Rt.resolveCached(this,l)}resolveNoCache(l){return Rt.resolve(this,l)}rangeHasMark(l,d,y){let O=!1;return d>l&&this.nodesBetween(l,d,w=>(y.isInSet(w.marks)&&(O=!0),!O)),O}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let l=this.type.name;return this.content.size&&(l+="("+this.content.toStringInner()+")"),H(this.marks,l)}contentMatchAt(l){let d=this.type.contentMatch.matchFragment(this.content,0,l);if(!d)throw new Error("Called contentMatchAt on a node with invalid content");return d}canReplace(l,d,y=_.empty,O=0,w=y.childCount){let z=this.contentMatchAt(l).matchFragment(y,O,w),dt=z&&z.matchFragment(this.content,d);if(!dt||!dt.validEnd)return!1;for(let St=O;St<w;St++)if(!this.type.allowsMarks(y.child(St).marks))return!1;return!0}canReplaceWith(l,d,y,O){if(O&&!this.type.allowsMarks(O))return!1;let w=this.contentMatchAt(l).matchType(y),z=w&&w.matchFragment(this.content,d);return!!z&&z.validEnd}canAppend(l){return l.content.size?this.canReplace(this.childCount,this.childCount,l.content):this.type.compatibleContent(l.type)}check(){this.type.checkContent(this.content);let l=Y.none;for(let d=0;d<this.marks.length;d++)l=this.marks[d].addToSet(l);if(!Y.sameSet(l,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(d=>d.type.name)}`);this.content.forEach(d=>d.check())}toJSON(){let l={type:this.type.name};for(let d in this.attrs){l.attrs=this.attrs;break}return this.content.size&&(l.content=this.content.toJSON()),this.marks.length&&(l.marks=this.marks.map(d=>d.toJSON())),l}static fromJSON(l,d){if(!d)throw new RangeError("Invalid input for Node.fromJSON");let y=null;if(d.marks){if(!Array.isArray(d.marks))throw new RangeError("Invalid mark data for Node.fromJSON");y=d.marks.map(l.markFromJSON)}if("text"==d.type){if("string"!=typeof d.text)throw new RangeError("Invalid text node in JSON");return l.text(d.text,y)}let O=_.fromJSON(l,d.content);return l.nodeType(d.type).create(d.attrs,O,y)}}X.prototype.text=void 0;class P extends X{constructor(l,d,y,O){if(super(l,d,null,O),!y)throw new RangeError("Empty text nodes are not allowed");this.text=y}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):H(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(l,d){return this.text.slice(l,d)}get nodeSize(){return this.text.length}mark(l){return l==this.marks?this:new P(this.type,this.attrs,this.text,l)}withText(l){return l==this.text?this:new P(this.type,this.attrs,l,this.marks)}cut(l=0,d=this.text.length){return 0==l&&d==this.text.length?this:this.withText(this.text.slice(l,d))}eq(l){return this.sameMarkup(l)&&this.text==l.text}toJSON(){let l=super.toJSON();return l.text=this.text,l}}function H(R,l){for(let d=R.length-1;d>=0;d--)l=R[d].type.name+"("+l+")";return l}class K{constructor(l){this.validEnd=l,this.next=[],this.wrapCache=[]}static parse(l,d){let y=new Mt(l,d);if(null==y.next)return K.empty;let O=Pt(y);y.next&&y.err("Unexpected trailing text");let w=function(R){let l=Object.create(null);return function d(y){let O=[];y.forEach(z=>{R[z].forEach(({term:dt,to:St})=>{if(!dt)return;let ne;for(let te=0;te<O.length;te++)O[te][0]==dt&&(ne=O[te][1]);fe(R,St).forEach(te=>{ne||O.push([dt,ne=[]]),-1==ne.indexOf(te)&&ne.push(te)})})});let w=l[y.join(",")]=new K(y.indexOf(R.length-1)>-1);for(let z=0;z<O.length;z++){let dt=O[z][1].sort(me);w.next.push({type:O[z][0],next:l[dt.join(",")]||d(dt)})}return w}(fe(R,0))}(function(R){let l=[[]];return O(function w(z,dt){if("choice"==z.type)return z.exprs.reduce((St,ne)=>St.concat(w(ne,dt)),[]);if("seq"!=z.type){if("star"==z.type){let St=d();return y(dt,St),O(w(z.expr,St),St),[y(St)]}if("plus"==z.type){let St=d();return O(w(z.expr,dt),St),O(w(z.expr,St),St),[y(St)]}if("opt"==z.type)return[y(dt)].concat(w(z.expr,dt));if("range"==z.type){let St=dt;for(let ne=0;ne<z.min;ne++){let te=d();O(w(z.expr,St),te),St=te}if(-1==z.max)O(w(z.expr,St),St);else for(let ne=z.min;ne<z.max;ne++){let te=d();y(St,te),O(w(z.expr,St),te),St=te}return[y(St)]}if("name"==z.type)return[y(dt,void 0,z.value)];throw new Error("Unknown expr type")}for(let St=0;;St++){let ne=w(z.exprs[St],dt);if(St==z.exprs.length-1)return ne;O(ne,dt=d())}}(R,0),d()),l;function d(){return l.push([])-1}function y(z,dt,St){let ne={term:St,to:dt};return l[z].push(ne),ne}function O(z,dt){z.forEach(St=>St.to=dt)}}(O));return function(R,l){for(let d=0,y=[R];d<y.length;d++){let O=y[d],w=!O.validEnd,z=[];for(let dt=0;dt<O.next.length;dt++){let{type:St,next:ne}=O.next[dt];z.push(St.name),w&&!(St.isText||St.hasRequiredAttrs())&&(w=!1),-1==y.indexOf(ne)&&y.push(ne)}w&&l.err("Only non-generatable nodes ("+z.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(w,y),w}matchType(l){for(let d=0;d<this.next.length;d++)if(this.next[d].type==l)return this.next[d].next;return null}matchFragment(l,d=0,y=l.childCount){let O=this;for(let w=d;O&&w<y;w++)O=O.matchType(l.child(w).type);return O}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let l=0;l<this.next.length;l++){let{type:d}=this.next[l];if(!d.isText&&!d.hasRequiredAttrs())return d}return null}compatible(l){for(let d=0;d<this.next.length;d++)for(let y=0;y<l.next.length;y++)if(this.next[d].type==l.next[y].type)return!0;return!1}fillBefore(l,d=!1,y=0){let O=[this];return function w(z,dt){let St=z.matchFragment(l,y);if(St&&(!d||St.validEnd))return _.from(dt.map(ne=>ne.createAndFill()));for(let ne=0;ne<z.next.length;ne++){let{type:te,next:Pe}=z.next[ne];if(!te.isText&&!te.hasRequiredAttrs()&&-1==O.indexOf(Pe)){O.push(Pe);let J=w(Pe,dt.concat(te));if(J)return J}}return null}(this,[])}findWrapping(l){for(let y=0;y<this.wrapCache.length;y+=2)if(this.wrapCache[y]==l)return this.wrapCache[y+1];let d=this.computeWrapping(l);return this.wrapCache.push(l,d),d}computeWrapping(l){let d=Object.create(null),y=[{match:this,type:null,via:null}];for(;y.length;){let O=y.shift(),w=O.match;if(w.matchType(l)){let z=[];for(let dt=O;dt.type;dt=dt.via)z.push(dt.type);return z.reverse()}for(let z=0;z<w.next.length;z++){let{type:dt,next:St}=w.next[z];!dt.isLeaf&&!dt.hasRequiredAttrs()&&!(dt.name in d)&&(!O.type||St.validEnd)&&(y.push({match:dt.contentMatch,type:dt,via:O}),d[dt.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(l){if(l>=this.next.length)throw new RangeError(`There's no ${l}th edge in this content match`);return this.next[l]}toString(){let l=[];return function d(y){l.push(y);for(let O=0;O<y.next.length;O++)-1==l.indexOf(y.next[O].next)&&d(y.next[O].next)}(this),l.map((y,O)=>{let w=O+(y.validEnd?"*":" ")+" ";for(let z=0;z<y.next.length;z++)w+=(z?", ":"")+y.next[z].type.name+"->"+l.indexOf(y.next[z].next);return w}).join("\n")}}K.empty=new K(!0);class Mt{constructor(l,d){this.string=l,this.nodeTypes=d,this.inline=null,this.pos=0,this.tokens=l.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(l){return this.next==l&&(this.pos++||!0)}err(l){throw new SyntaxError(l+" (in content expression '"+this.string+"')")}}function Pt(R){let l=[];do{l.push(Kt(R))}while(R.eat("|"));return 1==l.length?l[0]:{type:"choice",exprs:l}}function Kt(R){let l=[];do{l.push(oe(R))}while(R.next&&")"!=R.next&&"|"!=R.next);return 1==l.length?l[0]:{type:"seq",exprs:l}}function oe(R){let l=function(R){if(R.eat("(")){let l=Pt(R);return R.eat(")")||R.err("Missing closing paren"),l}if(!/\W/.test(R.next)){let l=function(R,l){let d=R.nodeTypes,y=d[l];if(y)return[y];let O=[];for(let w in d){let z=d[w];z.groups.indexOf(l)>-1&&O.push(z)}return 0==O.length&&R.err("No node type or group '"+l+"' found"),O}(R,R.next).map(d=>(null==R.inline?R.inline=d.isInline:R.inline!=d.isInline&&R.err("Mixing inline and block content"),{type:"name",value:d}));return R.pos++,1==l.length?l[0]:{type:"choice",exprs:l}}R.err("Unexpected token '"+R.next+"'")}(R);for(;;)if(R.eat("+"))l={type:"plus",expr:l};else if(R.eat("*"))l={type:"star",expr:l};else if(R.eat("?"))l={type:"opt",expr:l};else{if(!R.eat("{"))break;l=se(R,l)}return l}function Jt(R){/\D/.test(R.next)&&R.err("Expected number, got '"+R.next+"'");let l=Number(R.next);return R.pos++,l}function se(R,l){let d=Jt(R),y=d;return R.eat(",")&&(y="}"!=R.next?Jt(R):-1),R.eat("}")||R.err("Unclosed braced range"),{type:"range",min:d,max:y,expr:l}}function me(R,l){return l-R}function fe(R,l){let d=[];return function y(O){let w=R[O];if(1==w.length&&!w[0].term)return y(w[0].to);d.push(O);for(let z=0;z<w.length;z++){let{term:dt,to:St}=w[z];!dt&&-1==d.indexOf(St)&&y(St)}}(l),d.sort(me)}function Nt(R){let l=Object.create(null);for(let d in R){let y=R[d];if(!y.hasDefault)return null;l[d]=y.default}return l}function qt(R,l){let d=Object.create(null);for(let y in R){let O=l&&l[y];if(void 0===O){let w=R[y];if(!w.hasDefault)throw new RangeError("No value supplied for attribute "+y);O=w.default}d[y]=O}return d}function kt(R){let l=Object.create(null);if(R)for(let d in R)l[d]=new re(R[d]);return l}class jt{constructor(l,d,y){this.name=l,this.schema=d,this.spec=y,this.markSet=null,this.groups=y.group?y.group.split(" "):[],this.attrs=kt(y.attrs),this.defaultAttrs=Nt(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(y.inline||"text"==l),this.isText="text"==l}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==K.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let l in this.attrs)if(this.attrs[l].isRequired)return!0;return!1}compatibleContent(l){return this==l||this.contentMatch.compatible(l.contentMatch)}computeAttrs(l){return!l&&this.defaultAttrs?this.defaultAttrs:qt(this.attrs,l)}create(l=null,d,y){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new X(this,this.computeAttrs(l),_.from(d),Y.setFrom(y))}createChecked(l=null,d,y){return d=_.from(d),this.checkContent(d),new X(this,this.computeAttrs(l),d,Y.setFrom(y))}createAndFill(l=null,d,y){if(l=this.computeAttrs(l),(d=_.from(d)).size){let z=this.contentMatch.fillBefore(d);if(!z)return null;d=z.append(d)}let O=this.contentMatch.matchFragment(d),w=O&&O.fillBefore(_.empty,!0);return w?new X(this,l,d.append(w),Y.setFrom(y)):null}validContent(l){let d=this.contentMatch.matchFragment(l);if(!d||!d.validEnd)return!1;for(let y=0;y<l.childCount;y++)if(!this.allowsMarks(l.child(y).marks))return!1;return!0}checkContent(l){if(!this.validContent(l))throw new RangeError(`Invalid content for node ${this.name}: ${l.toString().slice(0,50)}`)}allowsMarkType(l){return null==this.markSet||this.markSet.indexOf(l)>-1}allowsMarks(l){if(null==this.markSet)return!0;for(let d=0;d<l.length;d++)if(!this.allowsMarkType(l[d].type))return!1;return!0}allowedMarks(l){if(null==this.markSet)return l;let d;for(let y=0;y<l.length;y++)this.allowsMarkType(l[y].type)?d&&d.push(l[y]):d||(d=l.slice(0,y));return d?d.length?d:Y.none:l}static compile(l,d){let y=Object.create(null);l.forEach((w,z)=>y[w]=new jt(w,d,z));let O=d.spec.topNode||"doc";if(!y[O])throw new RangeError("Schema is missing its top node type ('"+O+"')");if(!y.text)throw new RangeError("Every schema needs a 'text' type");for(let w in y.text.attrs)throw new RangeError("The text node type should not have attributes");return y}}class re{constructor(l){this.hasDefault=Object.prototype.hasOwnProperty.call(l,"default"),this.default=l.default}get isRequired(){return!this.hasDefault}}class ae{constructor(l,d,y,O){this.name=l,this.rank=d,this.schema=y,this.spec=O,this.attrs=kt(O.attrs),this.excluded=null;let w=Nt(this.attrs);this.instance=w?new Y(this,w):null}create(l=null){return!l&&this.instance?this.instance:new Y(this,qt(this.attrs,l))}static compile(l,d){let y=Object.create(null),O=0;return l.forEach((w,z)=>y[w]=new ae(w,O++,d,z)),y}removeFromSet(l){for(var d=0;d<l.length;d++)l[d].type==this&&(l=l.slice(0,d).concat(l.slice(d+1)),d--);return l}isInSet(l){for(let d=0;d<l.length;d++)if(l[d].type==this)return l[d]}excludes(l){return this.excluded.indexOf(l)>-1}}class Me{constructor(l){this.cached=Object.create(null);let d=this.spec={};for(let O in l)d[O]=l[O];d.nodes=c.from(l.nodes),d.marks=c.from(l.marks||{}),this.nodes=jt.compile(this.spec.nodes,this),this.marks=ae.compile(this.spec.marks,this);let y=Object.create(null);for(let O in this.nodes){if(O in this.marks)throw new RangeError(O+" can not be both a node and a mark");let w=this.nodes[O],z=w.spec.content||"",dt=w.spec.marks;w.contentMatch=y[z]||(y[z]=K.parse(z,this.nodes)),w.inlineContent=w.contentMatch.inlineContent,w.markSet="_"==dt?null:dt?Ne(this,dt.split(" ")):""!=dt&&w.inlineContent?null:[]}for(let O in this.marks){let w=this.marks[O],z=w.spec.excludes;w.excluded=null==z?[w]:""==z?[]:Ne(this,z.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(l,d=null,y,O){if("string"==typeof l)l=this.nodeType(l);else{if(!(l instanceof jt))throw new RangeError("Invalid node type: "+l);if(l.schema!=this)throw new RangeError("Node type from different schema used ("+l.name+")")}return l.createChecked(d,y,O)}text(l,d){let y=this.nodes.text;return new P(y,y.defaultAttrs,l,Y.setFrom(d))}mark(l,d){return"string"==typeof l&&(l=this.marks[l]),l.create(d)}nodeFromJSON(l){return X.fromJSON(this,l)}markFromJSON(l){return Y.fromJSON(this,l)}nodeType(l){let d=this.nodes[l];if(!d)throw new RangeError("Unknown node type: "+l);return d}}function Ne(R,l){let d=[];for(let y=0;y<l.length;y++){let O=l[y],w=R.marks[O],z=w;if(w)d.push(w);else for(let dt in R.marks){let St=R.marks[dt];("_"==O||St.spec.group&&St.spec.group.split(" ").indexOf(O)>-1)&&d.push(z=St)}if(!z)throw new SyntaxError("Unknown mark type: '"+l[y]+"'")}return d}class xe{constructor(l,d){this.schema=l,this.rules=d,this.tags=[],this.styles=[],d.forEach(y=>{y.tag?this.tags.push(y):y.style&&this.styles.push(y)}),this.normalizeLists=!this.tags.some(y=>{if(!/^(ul|ol)\b/.test(y.tag)||!y.node)return!1;let O=l.nodes[y.node];return O.contentMatch.matchType(O)})}parse(l,d={}){let y=new Oe(this,d,!1);return y.addAll(l,d.from,d.to),y.finish()}parseSlice(l,d={}){let y=new Oe(this,d,!0);return y.addAll(l,d.from,d.to),et.maxOpen(y.finish())}matchTag(l,d,y){for(let O=y?this.tags.indexOf(y)+1:0;O<this.tags.length;O++){let w=this.tags[O];if(M(l,w.tag)&&(void 0===w.namespace||l.namespaceURI==w.namespace)&&(!w.context||d.matchesContext(w.context))){if(w.getAttrs){let z=w.getAttrs(l);if(!1===z)continue;w.attrs=z||void 0}return w}}}matchStyle(l,d,y,O){for(let w=O?this.styles.indexOf(O)+1:0;w<this.styles.length;w++){let z=this.styles[w],dt=z.style;if(!(0!=dt.indexOf(l)||z.context&&!y.matchesContext(z.context)||dt.length>l.length&&(61!=dt.charCodeAt(l.length)||dt.slice(l.length+1)!=d))){if(z.getAttrs){let St=z.getAttrs(d);if(!1===St)continue;z.attrs=St||void 0}return z}}}static schemaRules(l){let d=[];function y(O){let w=null==O.priority?50:O.priority,z=0;for(;z<d.length;z++){let dt=d[z];if((null==dt.priority?50:dt.priority)<w)break}d.splice(z,0,O)}for(let O in l.marks){let w=l.marks[O].spec.parseDOM;w&&w.forEach(z=>{y(z=b(z)),z.mark||z.ignore||z.clearMark||(z.mark=O)})}for(let O in l.nodes){let w=l.nodes[O].spec.parseDOM;w&&w.forEach(z=>{y(z=b(z)),z.node||z.ignore||z.mark||(z.node=O)})}return d}static fromSchema(l){return l.cached.domParser||(l.cached.domParser=new xe(l,xe.schemaRules(l)))}}const Ie={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ze={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Fe={ol:!0,ul:!0};function Le(R,l,d){return null!=l?(l?1:0)|("full"===l?2:0):R&&"pre"==R.whitespace?3:-5&d}class be{constructor(l,d,y,O,w,z,dt){this.type=l,this.attrs=d,this.marks=y,this.pendingMarks=O,this.solid=w,this.options=dt,this.content=[],this.activeMarks=Y.none,this.stashMarks=[],this.match=z||(4&dt?null:l.contentMatch)}findWrapping(l){if(!this.match){if(!this.type)return[];let d=this.type.contentMatch.fillBefore(_.from(l));if(!d){let O,y=this.type.contentMatch;return(O=y.findWrapping(l.type))?(this.match=y,O):null}this.match=this.type.contentMatch.matchFragment(d)}return this.match.findWrapping(l.type)}finish(l){if(!(1&this.options)){let O,y=this.content[this.content.length-1];if(y&&y.isText&&(O=/[ \t\r\n\u000c]+$/.exec(y.text))){let w=y;y.text.length==O[0].length?this.content.pop():this.content[this.content.length-1]=w.withText(w.text.slice(0,w.text.length-O[0].length))}}let d=_.from(this.content);return!l&&this.match&&(d=d.append(this.match.fillBefore(_.empty,!0))),this.type?this.type.create(this.attrs,d,this.marks):d}popFromStashMark(l){for(let d=this.stashMarks.length-1;d>=0;d--)if(l.eq(this.stashMarks[d]))return this.stashMarks.splice(d,1)[0]}applyPending(l){for(let d=0,y=this.pendingMarks;d<y.length;d++){let O=y[d];(this.type?this.type.allowsMarkType(O.type):B(O.type,l))&&!O.isInSet(this.activeMarks)&&(this.activeMarks=O.addToSet(this.activeMarks),this.pendingMarks=O.removeFromSet(this.pendingMarks))}}inlineContext(l){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:l.parentNode&&!Ie.hasOwnProperty(l.parentNode.nodeName.toLowerCase())}}class Oe{constructor(l,d,y){this.parser=l,this.options=d,this.isOpen=y,this.open=0;let w,O=d.topNode,z=Le(null,d.preserveWhitespace,0)|(y?4:0);w=O?new be(O.type,O.attrs,Y.none,Y.none,!0,d.topMatch||O.type.contentMatch,z):new be(y?null:l.schema.topNodeType,null,Y.none,Y.none,!0,null,z),this.nodes=[w],this.find=d.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(l){if(3==l.nodeType)this.addTextNode(l);else if(1==l.nodeType){let d=l.getAttribute("style");if(d){let y=this.readStyles(function(R){let d,l=/\s*([\w-]+)\s*:\s*([^;]+)/g,y=[];for(;d=l.exec(R);)y.push(d[1],d[2].trim());return y}(d));if(!y)return;let[O,w]=y,z=this.top;for(let dt=0;dt<w.length;dt++)this.removePendingMark(w[dt],z);for(let dt=0;dt<O.length;dt++)this.addPendingMark(O[dt]);this.addElement(l);for(let dt=0;dt<O.length;dt++)this.removePendingMark(O[dt],z);for(let dt=0;dt<w.length;dt++)this.addPendingMark(w[dt])}else this.addElement(l)}}addTextNode(l){let d=l.nodeValue,y=this.top;if(2&y.options||y.inlineContext(l)||/[^ \t\r\n\u000c]/.test(d)){if(1&y.options)d=2&y.options?d.replace(/\r\n?/g,"\n"):d.replace(/\r?\n|\r/g," ");else if(d=d.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(d)&&this.open==this.nodes.length-1){let O=y.content[y.content.length-1],w=l.previousSibling;(!O||w&&"BR"==w.nodeName||O.isText&&/[ \t\r\n\u000c]$/.test(O.text))&&(d=d.slice(1))}d&&this.insertNode(this.parser.schema.text(d)),this.findInText(l)}else this.findInside(l)}addElement(l,d){let O,y=l.nodeName.toLowerCase();Fe.hasOwnProperty(y)&&this.parser.normalizeLists&&function(R){for(let l=R.firstChild,d=null;l;l=l.nextSibling){let y=1==l.nodeType?l.nodeName.toLowerCase():null;y&&Fe.hasOwnProperty(y)&&d?(d.appendChild(l),l=d):"li"==y?d=l:y&&(d=null)}}(l);let w=this.options.ruleFromNode&&this.options.ruleFromNode(l)||(O=this.parser.matchTag(l,this,d));if(w?w.ignore:Ze.hasOwnProperty(y))this.findInside(l),this.ignoreFallback(l);else if(!w||w.skip||w.closeParent){w&&w.closeParent?this.open=Math.max(0,this.open-1):w&&w.skip.nodeType&&(l=w.skip);let z,dt=this.top,St=this.needsBlock;if(Ie.hasOwnProperty(y))dt.content.length&&dt.content[0].isInline&&this.open&&(this.open--,dt=this.top),z=!0,dt.type||(this.needsBlock=!0);else if(!l.firstChild)return void this.leafFallback(l);this.addAll(l),z&&this.sync(dt),this.needsBlock=St}else this.addElementByRule(l,w,!1===w.consuming?O:void 0)}leafFallback(l){"BR"==l.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(l.ownerDocument.createTextNode("\n"))}ignoreFallback(l){"BR"==l.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(l){let d=Y.none,y=Y.none;for(let O=0;O<l.length;O+=2)for(let w;;){let z=this.parser.matchStyle(l[O],l[O+1],this,w);if(!z)break;if(z.ignore)return null;if(z.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(dt=>{z.clearMark(dt)&&(y=dt.addToSet(y))}):d=this.parser.schema.marks[z.mark].create(z.attrs).addToSet(d),!1!==z.consuming)break;w=z}return[d,y]}addElementByRule(l,d,y){let O,w,z;d.node?(w=this.parser.schema.nodes[d.node],w.isLeaf?this.insertNode(w.create(d.attrs))||this.leafFallback(l):O=this.enter(w,d.attrs||null,d.preserveWhitespace)):(z=this.parser.schema.marks[d.mark].create(d.attrs),this.addPendingMark(z));let dt=this.top;if(w&&w.isLeaf)this.findInside(l);else if(y)this.addElement(l,y);else if(d.getContent)this.findInside(l),d.getContent(l,this.parser.schema).forEach(St=>this.insertNode(St));else{let St=l;"string"==typeof d.contentElement?St=l.querySelector(d.contentElement):"function"==typeof d.contentElement?St=d.contentElement(l):d.contentElement&&(St=d.contentElement),this.findAround(l,St,!0),this.addAll(St)}O&&this.sync(dt)&&this.open--,z&&this.removePendingMark(z,dt)}addAll(l,d,y){let O=d||0;for(let w=d?l.childNodes[d]:l.firstChild,z=null==y?null:l.childNodes[y];w!=z;w=w.nextSibling,++O)this.findAtPoint(l,O),this.addDOM(w);this.findAtPoint(l,O)}findPlace(l){let d,y;for(let O=this.open;O>=0;O--){let w=this.nodes[O],z=w.findWrapping(l);if(z&&(!d||d.length>z.length)&&(d=z,y=w,!z.length)||w.solid)break}if(!d)return!1;this.sync(y);for(let O=0;O<d.length;O++)this.enterInner(d[O],null,!1);return!0}insertNode(l){if(l.isInline&&this.needsBlock&&!this.top.type){let d=this.textblockFromContext();d&&this.enterInner(d)}if(this.findPlace(l)){this.closeExtra();let d=this.top;d.applyPending(l.type),d.match&&(d.match=d.match.matchType(l.type));let y=d.activeMarks;for(let O=0;O<l.marks.length;O++)(!d.type||d.type.allowsMarkType(l.marks[O].type))&&(y=l.marks[O].addToSet(y));return d.content.push(l.mark(y)),!0}return!1}enter(l,d,y){let O=this.findPlace(l.create(d));return O&&this.enterInner(l,d,!0,y),O}enterInner(l,d=null,y=!1,O){this.closeExtra();let w=this.top;w.applyPending(l),w.match=w.match&&w.match.matchType(l);let z=Le(l,O,w.options);4&w.options&&0==w.content.length&&(z|=4),this.nodes.push(new be(l,d,w.activeMarks,w.pendingMarks,y,null,z)),this.open++}closeExtra(l=!1){let d=this.nodes.length-1;if(d>this.open){for(;d>this.open;d--)this.nodes[d-1].content.push(this.nodes[d].finish(l));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(l){for(let d=this.open;d>=0;d--)if(this.nodes[d]==l)return this.open=d,!0;return!1}get currentPos(){this.closeExtra();let l=0;for(let d=this.open;d>=0;d--){let y=this.nodes[d].content;for(let O=y.length-1;O>=0;O--)l+=y[O].nodeSize;d&&l++}return l}findAtPoint(l,d){if(this.find)for(let y=0;y<this.find.length;y++)this.find[y].node==l&&this.find[y].offset==d&&(this.find[y].pos=this.currentPos)}findInside(l){if(this.find)for(let d=0;d<this.find.length;d++)null==this.find[d].pos&&1==l.nodeType&&l.contains(this.find[d].node)&&(this.find[d].pos=this.currentPos)}findAround(l,d,y){if(l!=d&&this.find)for(let O=0;O<this.find.length;O++)null==this.find[O].pos&&1==l.nodeType&&l.contains(this.find[O].node)&&d.compareDocumentPosition(this.find[O].node)&(y?2:4)&&(this.find[O].pos=this.currentPos)}findInText(l){if(this.find)for(let d=0;d<this.find.length;d++)this.find[d].node==l&&(this.find[d].pos=this.currentPos-(l.nodeValue.length-this.find[d].offset))}matchesContext(l){if(l.indexOf("|")>-1)return l.split(/\s*\|\s*/).some(this.matchesContext,this);let d=l.split("/"),y=this.options.context,O=!(this.isOpen||y&&y.parent.type!=this.nodes[0].type),w=(O?0:1)-(y?y.depth+1:0),z=(dt,St)=>{for(;dt>=0;dt--){let ne=d[dt];if(""==ne){if(dt==d.length-1||0==dt)continue;for(;St>=w;St--)if(z(dt-1,St))return!0;return!1}{let te=St>0||0==St&&O?this.nodes[St].type:y&&St>=w?y.node(St-w).type:null;if(!te||te.name!=ne&&-1==te.groups.indexOf(ne))return!1;St--}}return!0};return z(d.length-1,this.open)}textblockFromContext(){let l=this.options.context;if(l)for(let d=l.depth;d>=0;d--){let y=l.node(d).contentMatchAt(l.indexAfter(d)).defaultType;if(y&&y.isTextblock&&y.defaultAttrs)return y}for(let d in this.parser.schema.nodes){let y=this.parser.schema.nodes[d];if(y.isTextblock&&y.defaultAttrs)return y}}addPendingMark(l){let d=function(R,l){for(let d=0;d<l.length;d++)if(R.eq(l[d]))return l[d]}(l,this.top.pendingMarks);d&&this.top.stashMarks.push(d),this.top.pendingMarks=l.addToSet(this.top.pendingMarks)}removePendingMark(l,d){for(let y=this.open;y>=0;y--){let O=this.nodes[y];if(O.pendingMarks.lastIndexOf(l)>-1)O.pendingMarks=l.removeFromSet(O.pendingMarks);else{O.activeMarks=l.removeFromSet(O.activeMarks);let z=O.popFromStashMark(l);z&&O.type&&O.type.allowsMarkType(z.type)&&(O.activeMarks=z.addToSet(O.activeMarks))}if(O==d)break}}}function M(R,l){return(R.matches||R.msMatchesSelector||R.webkitMatchesSelector||R.mozMatchesSelector).call(R,l)}function b(R){let l={};for(let d in R)l[d]=R[d];return l}function B(R,l){let d=l.schema.nodes;for(let y in d){let O=d[y];if(!O.allowsMarkType(R))continue;let w=[],z=dt=>{w.push(dt);for(let St=0;St<dt.edgeCount;St++){let{type:ne,next:te}=dt.edge(St);if(ne==l||w.indexOf(te)<0&&z(te))return!0}};if(z(O.contentMatch))return!0}}class V{constructor(l,d){this.nodes=l,this.marks=d}serializeFragment(l,d={},y){y||(y=Dt(d).createDocumentFragment());let O=y,w=[];return l.forEach(z=>{if(w.length||z.marks.length){let dt=0,St=0;for(;dt<w.length&&St<z.marks.length;){let ne=z.marks[St];if(this.marks[ne.type.name]){if(!ne.eq(w[dt][0])||!1===ne.type.spec.spanning)break;dt++,St++}else St++}for(;dt<w.length;)O=w.pop()[1];for(;St<z.marks.length;){let ne=z.marks[St++],te=this.serializeMark(ne,z.isInline,d);te&&(w.push([ne,O]),O.appendChild(te.dom),O=te.contentDOM||te.dom)}}O.appendChild(this.serializeNodeInner(z,d))}),y}serializeNodeInner(l,d){let{dom:y,contentDOM:O}=V.renderSpec(Dt(d),this.nodes[l.type.name](l));if(O){if(l.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(l.content,d,O)}return y}serializeNode(l,d={}){let y=this.serializeNodeInner(l,d);for(let O=l.marks.length-1;O>=0;O--){let w=this.serializeMark(l.marks[O],l.isInline,d);w&&((w.contentDOM||w.dom).appendChild(y),y=w.dom)}return y}serializeMark(l,d,y={}){let O=this.marks[l.type.name];return O&&V.renderSpec(Dt(y),O(l,d))}static renderSpec(l,d,y=null){if("string"==typeof d)return{dom:l.createTextNode(d)};if(null!=d.nodeType)return{dom:d};if(d.dom&&null!=d.dom.nodeType)return d;let O=d[0],w=O.indexOf(" ");w>0&&(y=O.slice(0,w),O=O.slice(w+1));let z,dt=y?l.createElementNS(y,O):l.createElement(O),St=d[1],ne=1;if(St&&"object"==typeof St&&null==St.nodeType&&!Array.isArray(St)){ne=2;for(let te in St)if(null!=St[te]){let Pe=te.indexOf(" ");Pe>0?dt.setAttributeNS(te.slice(0,Pe),te.slice(Pe+1),St[te]):dt.setAttribute(te,St[te])}}for(let te=ne;te<d.length;te++){let Pe=d[te];if(0===Pe){if(te<d.length-1||te>ne)throw new RangeError("Content hole must be the only child of its parent node");return{dom:dt,contentDOM:dt}}{let{dom:J,contentDOM:S}=V.renderSpec(l,Pe,y);if(dt.appendChild(J),S){if(z)throw new RangeError("Multiple content holes");z=S}}}return{dom:dt,contentDOM:z}}static fromSchema(l){return l.cached.domSerializer||(l.cached.domSerializer=new V(this.nodesFromSchema(l),this.marksFromSchema(l)))}static nodesFromSchema(l){let d=mt(l.nodes);return d.text||(d.text=y=>y.text),d}static marksFromSchema(l){return mt(l.marks)}}function mt(R){let l={};for(let d in R){let y=R[d].spec.toDOM;y&&(l[d]=y)}return l}function Dt(R){return R.document||window.document}},62463:(Gt,yt,a)=>{a.d(yt,{C1:()=>pt,yy:()=>Rt,qv:()=>q,Sy:()=>Zt,H$:()=>Et,Y1:()=>I,xm:()=>_,Bs:()=>nt});var s=a(27439),c=a(38480);const $=Object.create(null);class I{constructor(P,H,K){this.$anchor=P,this.$head=H,this.ranges=K||[new _(P.min(H),P.max(H))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let P=this.ranges;for(let H=0;H<P.length;H++)if(P[H].$from.pos!=P[H].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(P,H=s.p2.empty){let K=H.content.lastChild,Mt=null;for(let oe=0;oe<H.openEnd;oe++)Mt=K,K=K.lastChild;let Pt=P.steps.length,Kt=this.ranges;for(let oe=0;oe<Kt.length;oe++){let{$from:Jt,$to:se}=Kt[oe],rt=P.mapping.slice(Pt);P.replaceRange(rt.map(Jt.pos),rt.map(se.pos),oe?s.p2.empty:H),0==oe&&st(P,Pt,(K?K.isInline:Mt&&Mt.isTextblock)?-1:1)}}replaceWith(P,H){let K=P.steps.length,Mt=this.ranges;for(let Pt=0;Pt<Mt.length;Pt++){let{$from:Kt,$to:oe}=Mt[Pt],Jt=P.mapping.slice(K),se=Jt.map(Kt.pos),rt=Jt.map(oe.pos);Pt?P.deleteRange(se,rt):(P.replaceRangeWith(se,rt,H),st(P,K,H.isInline?-1:1))}}static findFrom(P,H,K=!1){let Mt=P.parent.inlineContent?new nt(P):ft(P.node(0),P.parent,P.pos,P.index(),H,K);if(Mt)return Mt;for(let Pt=P.depth-1;Pt>=0;Pt--){let Kt=H<0?ft(P.node(0),P.node(Pt),P.before(Pt+1),P.index(Pt),H,K):ft(P.node(0),P.node(Pt),P.after(Pt+1),P.index(Pt)+1,H,K);if(Kt)return Kt}return null}static near(P,H=1){return this.findFrom(P,H)||this.findFrom(P,-H)||new pt(P.node(0))}static atStart(P){return ft(P,P,0,0,1)||new pt(P)}static atEnd(P){return ft(P,P,P.content.size,P.childCount,-1)||new pt(P)}static fromJSON(P,H){if(!H||!H.type)throw new RangeError("Invalid input for Selection.fromJSON");let K=$[H.type];if(!K)throw new RangeError(`No selection type ${H.type} defined`);return K.fromJSON(P,H)}static jsonID(P,H){if(P in $)throw new RangeError("Duplicate use of selection JSON ID "+P);return $[P]=H,H.prototype.jsonID=P,H}getBookmark(){return nt.between(this.$anchor,this.$head).getBookmark()}}I.prototype.visible=!0;class _{constructor(P,H){this.$from=P,this.$to=H}}let j=!1;function F(X){!j&&!X.parent.inlineContent&&(j=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+X.parent.type.name+")"))}class nt extends I{constructor(P,H=P){F(P),F(H),super(P,H)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(P,H){let K=P.resolve(H.map(this.head));if(!K.parent.inlineContent)return I.near(K);let Mt=P.resolve(H.map(this.anchor));return new nt(Mt.parent.inlineContent?Mt:K,K)}replace(P,H=s.p2.empty){if(super.replace(P,H),H==s.p2.empty){let K=this.$from.marksAcross(this.$to);K&&P.ensureMarks(K)}}eq(P){return P instanceof nt&&P.anchor==this.anchor&&P.head==this.head}getBookmark(){return new Y(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(P,H){if("number"!=typeof H.anchor||"number"!=typeof H.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new nt(P.resolve(H.anchor),P.resolve(H.head))}static create(P,H,K=H){let Mt=P.resolve(H);return new this(Mt,K==H?Mt:P.resolve(K))}static between(P,H,K){let Mt=P.pos-H.pos;if((!K||Mt)&&(K=Mt>=0?1:-1),!H.parent.inlineContent){let Pt=I.findFrom(H,K,!0)||I.findFrom(H,-K,!0);if(!Pt)return I.near(H,K);H=Pt.$head}return P.parent.inlineContent||(0==Mt||(P=(I.findFrom(P,-K,!0)||I.findFrom(P,K,!0)).$anchor).pos<H.pos!=Mt<0)&&(P=H),new nt(P,H)}}I.jsonID("text",nt);class Y{constructor(P,H){this.anchor=P,this.head=H}map(P){return new Y(P.map(this.anchor),P.map(this.head))}resolve(P){return nt.between(P.resolve(this.anchor),P.resolve(this.head))}}class q extends I{constructor(P){let H=P.nodeAfter,K=P.node(0).resolve(P.pos+H.nodeSize);super(P,K),this.node=H}map(P,H){let{deleted:K,pos:Mt}=H.mapResult(this.anchor),Pt=P.resolve(Mt);return K?I.near(Pt):new q(Pt)}content(){return new s.p2(s.HY.from(this.node),0,0)}eq(P){return P instanceof q&&P.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new et(this.anchor)}static fromJSON(P,H){if("number"!=typeof H.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new q(P.resolve(H.anchor))}static create(P,H){return new q(P.resolve(H))}static isSelectable(P){return!P.isText&&!1!==P.type.spec.selectable}}q.prototype.visible=!1,I.jsonID("node",q);class et{constructor(P){this.anchor=P}map(P){let{deleted:H,pos:K}=P.mapResult(this.anchor);return H?new Y(K,K):new et(K)}resolve(P){let H=P.resolve(this.anchor),K=H.nodeAfter;return K&&q.isSelectable(K)?new q(H):I.near(H)}}class pt extends I{constructor(P){super(P.resolve(0),P.resolve(P.content.size))}replace(P,H=s.p2.empty){if(H==s.p2.empty){P.delete(0,P.doc.content.size);let K=I.atStart(P.doc);K.eq(P.selection)||P.setSelection(K)}else super.replace(P,H)}toJSON(){return{type:"all"}}static fromJSON(P){return new pt(P)}map(P){return new pt(P)}eq(P){return P instanceof pt}getBookmark(){return Ot}}I.jsonID("all",pt);const Ot={map(){return this},resolve:X=>new pt(X)};function ft(X,P,H,K,Mt,Pt=!1){if(P.inlineContent)return nt.create(X,H);for(let Kt=K-(Mt>0?0:1);Mt>0?Kt<P.childCount:Kt>=0;Kt+=Mt){let oe=P.child(Kt);if(oe.isAtom){if(!Pt&&q.isSelectable(oe))return q.create(X,H-(Mt<0?oe.nodeSize:0))}else{let Jt=ft(X,oe,H+Mt,Mt<0?oe.childCount:0,Mt,Pt);if(Jt)return Jt}H+=oe.nodeSize*Mt}return null}function st(X,P,H){let K=X.steps.length-1;if(K<P)return;let Kt,Mt=X.steps[K];(Mt instanceof c.Pu||Mt instanceof c.FC)&&(X.mapping.maps[K].forEach((oe,Jt,se,rt)=>{null==Kt&&(Kt=rt)}),X.setSelection(I.near(X.doc.resolve(Kt),H)))}class ut extends c.wx{constructor(P){super(P.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=P.selection,this.storedMarks=P.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(P){if(P.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=P,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(P){return this.storedMarks=P,this.updated|=2,this}ensureMarks(P){return s.vc.sameSet(this.storedMarks||this.selection.$from.marks(),P)||this.setStoredMarks(P),this}addStoredMark(P){return this.ensureMarks(P.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(P){return this.ensureMarks(P.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(P,H){super.addStep(P,H),this.updated=-3&this.updated,this.storedMarks=null}setTime(P){return this.time=P,this}replaceSelection(P){return this.selection.replace(this,P),this}replaceSelectionWith(P,H=!0){let K=this.selection;return H&&(P=P.mark(this.storedMarks||(K.empty?K.$from.marks():K.$from.marksAcross(K.$to)||s.vc.none))),K.replaceWith(this,P),this}deleteSelection(){return this.selection.replace(this),this}insertText(P,H,K){let Mt=this.doc.type.schema;if(null==H)return P?this.replaceSelectionWith(Mt.text(P),!0):this.deleteSelection();{if(null==K&&(K=H),K=null==K?H:K,!P)return this.deleteRange(H,K);let Pt=this.storedMarks;if(!Pt){let Kt=this.doc.resolve(H);Pt=K==H?Kt.marks():Kt.marksAcross(this.doc.resolve(K))}return this.replaceRangeWith(H,K,Mt.text(P,Pt)),this.selection.empty||this.setSelection(I.near(this.selection.$to)),this}}setMeta(P,H){return this.meta["string"==typeof P?P:P.key]=H,this}getMeta(P){return this.meta["string"==typeof P?P:P.key]}get isGeneric(){for(let P in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function ot(X,P){return P&&X?X.bind(P):X}class xt{constructor(P,H,K){this.name=P,this.init=ot(H.init,K),this.apply=ot(H.apply,K)}}const bt=[new xt("doc",{init:X=>X.doc||X.schema.topNodeType.createAndFill(),apply:X=>X.doc}),new xt("selection",{init:(X,P)=>X.selection||I.atStart(P.doc),apply:X=>X.selection}),new xt("storedMarks",{init:X=>X.storedMarks||null,apply:(X,P,H,K)=>K.selection.$cursor?X.storedMarks:null}),new xt("scrollToSelection",{init:()=>0,apply:(X,P)=>X.scrolledIntoView?P+1:P})];class lt{constructor(P,H){this.schema=P,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=bt.slice(),H&&H.forEach(K=>{if(this.pluginsByKey[K.key])throw new RangeError("Adding different instances of a keyed plugin ("+K.key+")");this.plugins.push(K),this.pluginsByKey[K.key]=K,K.spec.state&&this.fields.push(new xt(K.key,K.spec.state,K))})}}class Rt{constructor(P){this.config=P}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(P){return this.applyTransaction(P).state}filterTransaction(P,H=-1){for(let K=0;K<this.config.plugins.length;K++)if(K!=H){let Mt=this.config.plugins[K];if(Mt.spec.filterTransaction&&!Mt.spec.filterTransaction.call(Mt,P,this))return!1}return!0}applyTransaction(P){if(!this.filterTransaction(P))return{state:this,transactions:[]};let H=[P],K=this.applyInner(P),Mt=null;for(;;){let Pt=!1;for(let Kt=0;Kt<this.config.plugins.length;Kt++){let oe=this.config.plugins[Kt];if(oe.spec.appendTransaction){let Jt=Mt?Mt[Kt].n:0,se=Mt?Mt[Kt].state:this,rt=Jt<H.length&&oe.spec.appendTransaction.call(oe,Jt?H.slice(Jt):H,se,K);if(rt&&K.filterTransaction(rt,Kt)){if(rt.setMeta("appendedTransaction",P),!Mt){Mt=[];for(let It=0;It<this.config.plugins.length;It++)Mt.push(It<Kt?{state:K,n:H.length}:{state:this,n:0})}H.push(rt),K=K.applyInner(rt),Pt=!0}Mt&&(Mt[Kt]={state:K,n:H.length})}}if(!Pt)return{state:K,transactions:H}}}applyInner(P){if(!P.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let H=new Rt(this.config),K=this.config.fields;for(let Mt=0;Mt<K.length;Mt++){let Pt=K[Mt];H[Pt.name]=Pt.apply(P,this[Pt.name],this,H)}return H}get tr(){return new ut(this)}static create(P){let H=new lt(P.doc?P.doc.type.schema:P.schema,P.plugins),K=new Rt(H);for(let Mt=0;Mt<H.fields.length;Mt++)K[H.fields[Mt].name]=H.fields[Mt].init(P,K);return K}reconfigure(P){let H=new lt(this.schema,P.plugins),K=H.fields,Mt=new Rt(H);for(let Pt=0;Pt<K.length;Pt++){let Kt=K[Pt].name;Mt[Kt]=this.hasOwnProperty(Kt)?this[Kt]:K[Pt].init(P,Mt)}return Mt}toJSON(P){let H={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(H.storedMarks=this.storedMarks.map(K=>K.toJSON())),P&&"object"==typeof P)for(let K in P){if("doc"==K||"selection"==K)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let Mt=P[K],Pt=Mt.spec.state;Pt&&Pt.toJSON&&(H[K]=Pt.toJSON.call(Mt,this[Mt.key]))}return H}static fromJSON(P,H,K){if(!H)throw new RangeError("Invalid input for EditorState.fromJSON");if(!P.schema)throw new RangeError("Required config field 'schema' missing");let Mt=new lt(P.schema,P.plugins),Pt=new Rt(Mt);return Mt.fields.forEach(Kt=>{if("doc"==Kt.name)Pt.doc=s.NB.fromJSON(P.schema,H.doc);else if("selection"==Kt.name)Pt.selection=I.fromJSON(Pt.doc,H.selection);else if("storedMarks"==Kt.name)H.storedMarks&&(Pt.storedMarks=H.storedMarks.map(P.schema.markFromJSON));else{if(K)for(let oe in K){let Jt=K[oe],se=Jt.spec.state;if(Jt.key==Kt.name&&se&&se.fromJSON&&Object.prototype.hasOwnProperty.call(H,oe))return void(Pt[Kt.name]=se.fromJSON.call(Jt,P,H[oe],Pt))}Pt[Kt.name]=Kt.init(P,Pt)}}),Pt}}function Yt(X,P,H){for(let K in X){let Mt=X[K];Mt instanceof Function?Mt=Mt.bind(P):"handleDOMEvents"==K&&(Mt=Yt(Mt,P,{})),H[K]=Mt}return H}class Zt{constructor(P){this.spec=P,this.props={},P.props&&Yt(P.props,this,this.props),this.key=P.key?P.key.key:At("plugin")}getState(P){return P[this.key]}}const Ht=Object.create(null);function At(X){return X in Ht?X+"$"+ ++Ht[X]:(Ht[X]=0,X+"$")}class Et{constructor(P="key"){this.key=At(P)}get(P){return P.config.pluginsByKey[this.key]}getState(P){return P[this.key]}}},38480:(Gt,yt,a)=>{a.d(yt,{vs:()=>Ot,FC:()=>lt,Pu:()=>bt,wx:()=>Oe,Mn:()=>It,Ax:()=>se,nj:()=>Wt,nd:()=>P,GJ:()=>me,k9:()=>Et,dR:()=>Nt});var s=a(27439);const $=Math.pow(2,16);function I(ht,M){return ht+M*$}function _(ht){return 65535&ht}class et{constructor(M,x,b){this.pos=M,this.delInfo=x,this.recover=b}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class pt{constructor(M,x=!1){if(this.ranges=M,this.inverted=x,!M.length&&pt.empty)return pt.empty}recover(M){let x=0,b=_(M);if(!this.inverted)for(let B=0;B<b;B++)x+=this.ranges[3*B+2]-this.ranges[3*B+1];return this.ranges[3*b]+x+((ht=M)-(65535&ht))/$;var ht}mapResult(M,x=1){return this._map(M,x,!1)}map(M,x=1){return this._map(M,x,!0)}_map(M,x,b){let B=0,D=this.inverted?2:1,V=this.inverted?1:2;for(let mt=0;mt<this.ranges.length;mt+=3){let Dt=this.ranges[mt]-(this.inverted?B:0);if(Dt>M)break;let R=this.ranges[mt+D],l=this.ranges[mt+V],d=Dt+R;if(M<=d){let O=Dt+B+((R?M==Dt?-1:M==d?1:x:x)<0?0:l);if(b)return O;let w=M==(x<0?Dt:d)?null:I(mt/3,M-Dt),z=M==Dt?2:M==d?1:4;return(x<0?M!=Dt:M!=d)&&(z|=8),new et(O,z,w)}B+=l-R}return b?M+B:new et(M+B,0,null)}touches(M,x){let b=0,B=_(x),D=this.inverted?2:1,V=this.inverted?1:2;for(let mt=0;mt<this.ranges.length;mt+=3){let Dt=this.ranges[mt]-(this.inverted?b:0);if(Dt>M)break;let R=this.ranges[mt+D];if(M<=Dt+R&&mt==3*B)return!0;b+=this.ranges[mt+V]-R}return!1}forEach(M){let x=this.inverted?2:1,b=this.inverted?1:2;for(let B=0,D=0;B<this.ranges.length;B+=3){let V=this.ranges[B],mt=V-(this.inverted?D:0),Dt=V+(this.inverted?0:D),R=this.ranges[B+x],l=this.ranges[B+b];M(mt,mt+R,Dt,Dt+l),D+=l-R}}invert(){return new pt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(M){return 0==M?pt.empty:new pt(M<0?[0,-M,0]:[0,0,M])}}pt.empty=new pt([]);class Ot{constructor(M=[],x,b=0,B=M.length){this.maps=M,this.mirror=x,this.from=b,this.to=B}slice(M=0,x=this.maps.length){return new Ot(this.maps,this.mirror,M,x)}copy(){return new Ot(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(M,x){this.to=this.maps.push(M),null!=x&&this.setMirror(this.maps.length-1,x)}appendMapping(M){for(let x=0,b=this.maps.length;x<M.maps.length;x++){let B=M.getMirror(x);this.appendMap(M.maps[x],null!=B&&B<x?b+B:void 0)}}getMirror(M){if(this.mirror)for(let x=0;x<this.mirror.length;x++)if(this.mirror[x]==M)return this.mirror[x+(x%2?-1:1)]}setMirror(M,x){this.mirror||(this.mirror=[]),this.mirror.push(M,x)}appendMappingInverted(M){for(let x=M.maps.length-1,b=this.maps.length+M.maps.length;x>=0;x--){let B=M.getMirror(x);this.appendMap(M.maps[x].invert(),null!=B&&B>x?b-B-1:void 0)}}invert(){let M=new Ot;return M.appendMappingInverted(this),M}map(M,x=1){if(this.mirror)return this._map(M,x,!0);for(let b=this.from;b<this.to;b++)M=this.maps[b].map(M,x);return M}mapResult(M,x=1){return this._map(M,x,!1)}_map(M,x,b){let B=0;for(let D=this.from;D<this.to;D++){let mt=this.maps[D].mapResult(M,x);if(null!=mt.recover){let Dt=this.getMirror(D);if(null!=Dt&&Dt>D&&Dt<this.to){D=Dt,M=this.maps[Dt].recover(mt.recover);continue}}B|=mt.delInfo,M=mt.pos}return b?M:new et(M,B,null)}}const ft=Object.create(null);class st{getMap(){return pt.empty}merge(M){return null}static fromJSON(M,x){if(!x||!x.stepType)throw new RangeError("Invalid input for Step.fromJSON");let b=ft[x.stepType];if(!b)throw new RangeError(`No step type ${x.stepType} defined`);return b.fromJSON(M,x)}static jsonID(M,x){if(M in ft)throw new RangeError("Duplicate use of step JSON ID "+M);return ft[M]=x,x.prototype.jsonID=M,x}}class Q{constructor(M,x){this.doc=M,this.failed=x}static ok(M){return new Q(M,null)}static fail(M){return new Q(null,M)}static fromReplace(M,x,b,B){try{return Q.ok(M.replace(x,b,B))}catch(D){if(D instanceof s.e4)return Q.fail(D.message);throw D}}}function W(ht,M,x){let b=[];for(let B=0;B<ht.childCount;B++){let D=ht.child(B);D.content.size&&(D=D.copy(W(D.content,M,D))),D.isInline&&(D=M(D,x,B)),b.push(D)}return s.HY.fromArray(b)}class tt extends st{constructor(M,x,b){super(),this.from=M,this.to=x,this.mark=b}apply(M){let x=M.slice(this.from,this.to),b=M.resolve(this.from),B=b.node(b.sharedDepth(this.to)),D=new s.p2(W(x.content,(V,mt)=>V.isAtom&&mt.type.allowsMarkType(this.mark.type)?V.mark(this.mark.addToSet(V.marks)):V,B),x.openStart,x.openEnd);return Q.fromReplace(M,this.from,this.to,D)}invert(){return new ut(this.from,this.to,this.mark)}map(M){let x=M.mapResult(this.from,1),b=M.mapResult(this.to,-1);return x.deleted&&b.deleted||x.pos>=b.pos?null:new tt(x.pos,b.pos,this.mark)}merge(M){return M instanceof tt&&M.mark.eq(this.mark)&&this.from<=M.to&&this.to>=M.from?new tt(Math.min(this.from,M.from),Math.max(this.to,M.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(M,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new tt(x.from,x.to,M.markFromJSON(x.mark))}}st.jsonID("addMark",tt);class ut extends st{constructor(M,x,b){super(),this.from=M,this.to=x,this.mark=b}apply(M){let x=M.slice(this.from,this.to),b=new s.p2(W(x.content,B=>B.mark(this.mark.removeFromSet(B.marks)),M),x.openStart,x.openEnd);return Q.fromReplace(M,this.from,this.to,b)}invert(){return new tt(this.from,this.to,this.mark)}map(M){let x=M.mapResult(this.from,1),b=M.mapResult(this.to,-1);return x.deleted&&b.deleted||x.pos>=b.pos?null:new ut(x.pos,b.pos,this.mark)}merge(M){return M instanceof ut&&M.mark.eq(this.mark)&&this.from<=M.to&&this.to>=M.from?new ut(Math.min(this.from,M.from),Math.max(this.to,M.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(M,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ut(x.from,x.to,M.markFromJSON(x.mark))}}st.jsonID("removeMark",ut);class ot extends st{constructor(M,x){super(),this.pos=M,this.mark=x}apply(M){let x=M.nodeAt(this.pos);if(!x)return Q.fail("No node at mark step's position");let b=x.type.create(x.attrs,null,this.mark.addToSet(x.marks));return Q.fromReplace(M,this.pos,this.pos+1,new s.p2(s.HY.from(b),0,x.isLeaf?0:1))}invert(M){let x=M.nodeAt(this.pos);if(x){let b=this.mark.addToSet(x.marks);if(b.length==x.marks.length){for(let B=0;B<x.marks.length;B++)if(!x.marks[B].isInSet(b))return new ot(this.pos,x.marks[B]);return new ot(this.pos,this.mark)}}return new xt(this.pos,this.mark)}map(M){let x=M.mapResult(this.pos,1);return x.deletedAfter?null:new ot(x.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(M,x){if("number"!=typeof x.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ot(x.pos,M.markFromJSON(x.mark))}}st.jsonID("addNodeMark",ot);class xt extends st{constructor(M,x){super(),this.pos=M,this.mark=x}apply(M){let x=M.nodeAt(this.pos);if(!x)return Q.fail("No node at mark step's position");let b=x.type.create(x.attrs,null,this.mark.removeFromSet(x.marks));return Q.fromReplace(M,this.pos,this.pos+1,new s.p2(s.HY.from(b),0,x.isLeaf?0:1))}invert(M){let x=M.nodeAt(this.pos);return x&&this.mark.isInSet(x.marks)?new ot(this.pos,this.mark):this}map(M){let x=M.mapResult(this.pos,1);return x.deletedAfter?null:new xt(x.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(M,x){if("number"!=typeof x.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new xt(x.pos,M.markFromJSON(x.mark))}}st.jsonID("removeNodeMark",xt);class bt extends st{constructor(M,x,b,B=!1){super(),this.from=M,this.to=x,this.slice=b,this.structure=B}apply(M){return this.structure&&Rt(M,this.from,this.to)?Q.fail("Structure replace would overwrite content"):Q.fromReplace(M,this.from,this.to,this.slice)}getMap(){return new pt([this.from,this.to-this.from,this.slice.size])}invert(M){return new bt(this.from,this.from+this.slice.size,M.slice(this.from,this.to))}map(M){let x=M.mapResult(this.from,1),b=M.mapResult(this.to,-1);return x.deletedAcross&&b.deletedAcross?null:new bt(x.pos,Math.max(x.pos,b.pos),this.slice)}merge(M){if(!(M instanceof bt)||M.structure||this.structure)return null;if(this.from+this.slice.size!=M.from||this.slice.openEnd||M.slice.openStart){if(M.to!=this.from||this.slice.openStart||M.slice.openEnd)return null;{let x=this.slice.size+M.slice.size==0?s.p2.empty:new s.p2(M.slice.content.append(this.slice.content),M.slice.openStart,this.slice.openEnd);return new bt(M.from,this.to,x,this.structure)}}{let x=this.slice.size+M.slice.size==0?s.p2.empty:new s.p2(this.slice.content.append(M.slice.content),this.slice.openStart,M.slice.openEnd);return new bt(this.from,this.to+(M.to-M.from),x,this.structure)}}toJSON(){let M={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(M.slice=this.slice.toJSON()),this.structure&&(M.structure=!0),M}static fromJSON(M,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new bt(x.from,x.to,s.p2.fromJSON(M,x.slice),!!x.structure)}}st.jsonID("replace",bt);class lt extends st{constructor(M,x,b,B,D,V,mt=!1){super(),this.from=M,this.to=x,this.gapFrom=b,this.gapTo=B,this.slice=D,this.insert=V,this.structure=mt}apply(M){if(this.structure&&(Rt(M,this.from,this.gapFrom)||Rt(M,this.gapTo,this.to)))return Q.fail("Structure gap-replace would overwrite content");let x=M.slice(this.gapFrom,this.gapTo);if(x.openStart||x.openEnd)return Q.fail("Gap is not a flat range");let b=this.slice.insertAt(this.insert,x.content);return b?Q.fromReplace(M,this.from,this.to,b):Q.fail("Content does not fit in gap")}getMap(){return new pt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(M){let x=this.gapTo-this.gapFrom;return new lt(this.from,this.from+this.slice.size+x,this.from+this.insert,this.from+this.insert+x,M.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(M){let x=M.mapResult(this.from,1),b=M.mapResult(this.to,-1),B=M.map(this.gapFrom,-1),D=M.map(this.gapTo,1);return x.deletedAcross&&b.deletedAcross||B<x.pos||D>b.pos?null:new lt(x.pos,b.pos,B,D,this.slice,this.insert,this.structure)}toJSON(){let M={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(M.slice=this.slice.toJSON()),this.structure&&(M.structure=!0),M}static fromJSON(M,x){if("number"!=typeof x.from||"number"!=typeof x.to||"number"!=typeof x.gapFrom||"number"!=typeof x.gapTo||"number"!=typeof x.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new lt(x.from,x.to,x.gapFrom,x.gapTo,s.p2.fromJSON(M,x.slice),x.insert,!!x.structure)}}function Rt(ht,M,x){let b=ht.resolve(M),B=x-M,D=b.depth;for(;B>0&&D>0&&b.indexAfter(D)==b.node(D).childCount;)D--,B--;if(B>0){let V=b.node(D).maybeChild(b.indexAfter(D));for(;B>0;){if(!V||V.isLeaf)return!0;V=V.firstChild,B--}}return!1}function At(ht,M,x){return(0==M||ht.canReplace(M,ht.childCount))&&(x==ht.childCount||ht.canReplace(0,x))}function Et(ht){let x=ht.parent.content.cutByIndex(ht.startIndex,ht.endIndex);for(let b=ht.depth;;--b){let B=ht.$from.node(b),D=ht.$from.index(b),V=ht.$to.indexAfter(b);if(b<ht.depth&&B.canReplace(D,V,x))return b;if(0==b||B.type.spec.isolating||!At(B,D,V))break}return null}function P(ht,M,x=null,b=ht){let B=function(ht,M){let{parent:x,startIndex:b,endIndex:B}=ht,D=x.contentMatchAt(b).findWrapping(M);return D&&x.canReplaceWith(b,B,D.length?D[0]:M)?D:null}(ht,M),D=B&&function(ht,M){let{parent:x,startIndex:b,endIndex:B}=ht,D=x.child(b),V=M.contentMatch.findWrapping(D.type);if(!V)return null;let Dt=(V.length?V[V.length-1]:M).contentMatch;for(let R=b;Dt&&R<B;R++)Dt=Dt.matchType(x.child(R).type);return Dt&&Dt.validEnd?V:null}(b,M);return D?B.map(H).concat({type:M,attrs:x}).concat(D.map(H)):null}function H(ht){return{type:ht,attrs:null}}function se(ht,M,x=1,b){let B=ht.resolve(M),D=B.depth-x,V=b&&b[b.length-1]||B.parent;if(D<0||B.parent.type.spec.isolating||!B.parent.canReplace(B.index(),B.parent.childCount)||!V.type.validContent(B.parent.content.cutByIndex(B.index(),B.parent.childCount)))return!1;for(let R=B.depth-1,l=x-2;R>D;R--,l--){let d=B.node(R),y=B.index(R);if(d.type.spec.isolating)return!1;let O=d.content.cutByIndex(y,d.childCount),w=b&&b[l+1];w&&(O=O.replaceChild(0,w.type.create(w.attrs)));let z=b&&b[l]||d;if(!d.canReplace(y+1,d.childCount)||!z.type.validContent(O))return!1}let mt=B.indexAfter(D),Dt=b&&b[0];return B.node(D).canReplaceWith(mt,mt,Dt?Dt.type:B.node(D+1).type)}function It(ht,M){let x=ht.resolve(M),b=x.index();return Ut(x.nodeBefore,x.nodeAfter)&&x.parent.canReplace(b,b+1)}function Ut(ht,M){return!(!ht||!M||ht.isLeaf||!ht.canAppend(M))}function me(ht,M,x=-1){let b=ht.resolve(M);for(let B=b.depth;;B--){let D,V,mt=b.index(B);if(B==b.depth?(D=b.nodeBefore,V=b.nodeAfter):x>0?(D=b.node(B+1),mt++,V=b.node(B).maybeChild(mt)):(D=b.node(B).maybeChild(mt-1),V=b.node(B+1)),D&&!D.isTextblock&&Ut(D,V)&&b.node(B).canReplace(mt,mt+1))return M;if(0==B)break;M=x<0?b.before(B):b.after(B)}}function Wt(ht,M,x){let b=ht.resolve(M);if(!x.content.size)return M;let B=x.content;for(let D=0;D<x.openStart;D++)B=B.firstChild.content;for(let D=1;D<=(0==x.openStart&&x.size?2:1);D++)for(let V=b.depth;V>=0;V--){let mt=V==b.depth?0:b.pos<=(b.start(V+1)+b.end(V+1))/2?-1:1,Dt=b.index(V)+(mt>0?1:0),R=b.node(V),l=!1;if(1==D)l=R.canReplace(Dt,Dt,B);else{let d=R.contentMatchAt(Dt).findWrapping(B.firstChild.type);l=d&&R.canReplaceWith(Dt,Dt,d[0])}if(l)return 0==mt?b.pos:mt<0?b.before(V+1):b.after(V+1)}return null}function Nt(ht,M,x=M,b=s.p2.empty){if(M==x&&!b.size)return null;let B=ht.resolve(M),D=ht.resolve(x);return qt(B,D,b)?new bt(M,x,b):new kt(B,D,b).fit()}function qt(ht,M,x){return!x.openStart&&!x.openEnd&&ht.start()==M.start()&&ht.parent.canReplace(ht.index(),M.index(),x.content)}st.jsonID("replaceAround",lt);class kt{constructor(M,x,b){this.$from=M,this.$to=x,this.unplaced=b,this.frontier=[],this.placed=s.HY.empty;for(let B=0;B<=M.depth;B++){let D=M.node(B);this.frontier.push({type:D.type,match:D.contentMatchAt(M.indexAfter(B))})}for(let B=M.depth;B>0;B--)this.placed=s.HY.from(M.node(B).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let R=this.findFittable();R?this.placeNodes(R):this.openMore()||this.dropNode()}let M=this.mustMoveInline(),x=this.placed.size-this.depth-this.$from.depth,b=this.$from,B=this.close(M<0?this.$to:b.doc.resolve(M));if(!B)return null;let D=this.placed,V=b.depth,mt=B.depth;for(;V&&mt&&1==D.childCount;)D=D.firstChild.content,V--,mt--;let Dt=new s.p2(D,V,mt);return M>-1?new lt(b.pos,M,this.$to.pos,this.$to.end(),Dt,x):Dt.size||b.pos!=this.$to.pos?new bt(b.pos,B.pos,Dt):null}findFittable(){let M=this.unplaced.openStart;for(let x=this.unplaced.content,b=0,B=this.unplaced.openEnd;b<M;b++){let D=x.firstChild;if(x.childCount>1&&(B=0),D.type.spec.isolating&&B<=b){M=b;break}x=D.content}for(let x=1;x<=2;x++)for(let b=1==x?M:this.unplaced.openStart;b>=0;b--){let B,D=null;b?(D=ae(this.unplaced.content,b-1).firstChild,B=D.content):B=this.unplaced.content;let V=B.firstChild;for(let mt=this.depth;mt>=0;mt--){let l,{type:Dt,match:R}=this.frontier[mt],d=null;if(1==x&&(V?R.matchType(V.type)||(d=R.fillBefore(s.HY.from(V),!1)):D&&Dt.compatibleContent(D.type)))return{sliceDepth:b,frontierDepth:mt,parent:D,inject:d};if(2==x&&V&&(l=R.findWrapping(V.type)))return{sliceDepth:b,frontierDepth:mt,parent:D,wrap:l};if(D&&R.matchType(D.type))break}}}openMore(){let{content:M,openStart:x,openEnd:b}=this.unplaced,B=ae(M,x);return!(!B.childCount||B.firstChild.isLeaf||(this.unplaced=new s.p2(M,x+1,Math.max(b,B.size+x>=M.size-b?x+1:0)),0))}dropNode(){let{content:M,openStart:x,openEnd:b}=this.unplaced,B=ae(M,x);if(B.childCount<=1&&x>0){let D=M.size-x<=x+B.size;this.unplaced=new s.p2(jt(M,x-1,1),x-1,D?x-1:b)}else this.unplaced=new s.p2(jt(M,x,1),x,b)}placeNodes({sliceDepth:M,frontierDepth:x,parent:b,inject:B,wrap:D}){for(;this.depth>x;)this.closeFrontierNode();if(D)for(let z=0;z<D.length;z++)this.openFrontierNode(D[z]);let V=this.unplaced,mt=b?b.content:V.content,Dt=V.openStart-M,R=0,l=[],{match:d,type:y}=this.frontier[x];if(B){for(let z=0;z<B.childCount;z++)l.push(B.child(z));d=d.matchFragment(B)}let O=mt.size+M-(V.content.size-V.openEnd);for(;R<mt.childCount;){let z=mt.child(R),dt=d.matchType(z.type);if(!dt)break;R++,(R>1||0==Dt||z.content.size)&&(d=dt,l.push(Me(z.mark(y.allowedMarks(z.marks)),1==R?Dt:0,R==mt.childCount?O:-1)))}let w=R==mt.childCount;w||(O=-1),this.placed=re(this.placed,x,s.HY.from(l)),this.frontier[x].match=d,w&&O<0&&b&&b.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let z=0,dt=mt;z<O;z++){let St=dt.lastChild;this.frontier.push({type:St.type,match:St.contentMatchAt(St.childCount)}),dt=St.content}this.unplaced=w?0==M?s.p2.empty:new s.p2(jt(V.content,M-1,1),M-1,O<0?V.openEnd:M-1):new s.p2(jt(V.content,M,R),V.openStart,V.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let x,M=this.frontier[this.depth];if(!M.type.isTextblock||!Ne(this.$to,this.$to.depth,M.type,M.match,!1)||this.$to.depth==this.depth&&(x=this.findCloseLevel(this.$to))&&x.depth==this.depth)return-1;let{depth:b}=this.$to,B=this.$to.after(b);for(;b>1&&B==this.$to.end(--b);)++B;return B}findCloseLevel(M){t:for(let x=Math.min(this.depth,M.depth);x>=0;x--){let{match:b,type:B}=this.frontier[x],D=x<M.depth&&M.end(x+1)==M.pos+(M.depth-(x+1)),V=Ne(M,x,B,b,D);if(V){for(let mt=x-1;mt>=0;mt--){let{match:Dt,type:R}=this.frontier[mt],l=Ne(M,mt,R,Dt,!0);if(!l||l.childCount)continue t}return{depth:x,fit:V,move:D?M.doc.resolve(M.after(x+1)):M}}}}close(M){let x=this.findCloseLevel(M);if(!x)return null;for(;this.depth>x.depth;)this.closeFrontierNode();x.fit.childCount&&(this.placed=re(this.placed,x.depth,x.fit)),M=x.move;for(let b=x.depth+1;b<=M.depth;b++){let B=M.node(b),D=B.type.contentMatch.fillBefore(B.content,!0,M.index(b));this.openFrontierNode(B.type,B.attrs,D)}return M}openFrontierNode(M,x=null,b){let B=this.frontier[this.depth];B.match=B.match.matchType(M),this.placed=re(this.placed,this.depth,s.HY.from(M.create(x,b))),this.frontier.push({type:M,match:M.contentMatch})}closeFrontierNode(){let x=this.frontier.pop().match.fillBefore(s.HY.empty,!0);x.childCount&&(this.placed=re(this.placed,this.frontier.length,x))}}function jt(ht,M,x){return 0==M?ht.cutByIndex(x,ht.childCount):ht.replaceChild(0,ht.firstChild.copy(jt(ht.firstChild.content,M-1,x)))}function re(ht,M,x){return 0==M?ht.append(x):ht.replaceChild(ht.childCount-1,ht.lastChild.copy(re(ht.lastChild.content,M-1,x)))}function ae(ht,M){for(let x=0;x<M;x++)ht=ht.firstChild.content;return ht}function Me(ht,M,x){if(M<=0)return ht;let b=ht.content;return M>1&&(b=b.replaceChild(0,Me(b.firstChild,M-1,1==b.childCount?x-1:0))),M>0&&(b=ht.type.contentMatch.fillBefore(b).append(b),x<=0&&(b=b.append(ht.type.contentMatch.matchFragment(b).fillBefore(s.HY.empty,!0)))),ht.copy(b)}function Ne(ht,M,x,b,B){let D=ht.node(M),V=B?ht.indexAfter(M):ht.index(M);if(V==D.childCount&&!x.compatibleContent(D.type))return null;let mt=b.fillBefore(D.content,!0,V);return mt&&!function(ht,M,x){for(let b=x;b<M.childCount;b++)if(!ht.allowsMarks(M.child(b).marks))return!0;return!1}(x,D.content,V)?mt:null}function Ie(ht){return ht.spec.defining||ht.spec.definingForContent}function Fe(ht,M,x,b,B){if(M<x){let D=ht.firstChild;ht=ht.replaceChild(0,D.copy(Fe(D.content,M+1,x,b,D)))}if(M>b){let D=B.contentMatchAt(0),V=D.fillBefore(ht).append(ht);ht=V.append(D.matchFragment(V).fillBefore(s.HY.empty,!0))}return ht}function Te(ht,M){let x=[];for(let B=Math.min(ht.depth,M.depth);B>=0;B--){let D=ht.start(B);if(D<ht.pos-(ht.depth-B)||M.end(B)>M.pos+(M.depth-B)||ht.node(B).type.spec.isolating||M.node(B).type.spec.isolating)break;(D==M.start(B)||B==ht.depth&&B==M.depth&&ht.parent.inlineContent&&M.parent.inlineContent&&B&&M.start(B-1)==D-1)&&x.push(B)}return x}class Le extends st{constructor(M,x,b){super(),this.pos=M,this.attr=x,this.value=b}apply(M){let x=M.nodeAt(this.pos);if(!x)return Q.fail("No node at attribute step's position");let b=Object.create(null);for(let D in x.attrs)b[D]=x.attrs[D];b[this.attr]=this.value;let B=x.type.create(b,null,x.marks);return Q.fromReplace(M,this.pos,this.pos+1,new s.p2(s.HY.from(B),0,x.isLeaf?0:1))}getMap(){return pt.empty}invert(M){return new Le(this.pos,this.attr,M.nodeAt(this.pos).attrs[this.attr])}map(M){let x=M.mapResult(this.pos,1);return x.deletedAfter?null:new Le(x.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(M,x){if("number"!=typeof x.pos||"string"!=typeof x.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Le(x.pos,x.attr,x.value)}}st.jsonID("attr",Le);let be=class extends Error{};be=function ht(M){let x=Error.call(this,M);return x.__proto__=ht.prototype,x},(be.prototype=Object.create(Error.prototype)).constructor=be,be.prototype.name="TransformError";class Oe{constructor(M){this.doc=M,this.steps=[],this.docs=[],this.mapping=new Ot}get before(){return this.docs.length?this.docs[0]:this.doc}step(M){let x=this.maybeStep(M);if(x.failed)throw new be(x.failed);return this}maybeStep(M){let x=M.apply(this.doc);return x.failed||this.addStep(M,x.doc),x}get docChanged(){return this.steps.length>0}addStep(M,x){this.docs.push(this.doc),this.steps.push(M),this.mapping.appendMap(M.getMap()),this.doc=x}replace(M,x=M,b=s.p2.empty){let B=Nt(this.doc,M,x,b);return B&&this.step(B),this}replaceWith(M,x,b){return this.replace(M,x,new s.p2(s.HY.from(b),0,0))}delete(M,x){return this.replace(M,x,s.p2.empty)}insert(M,x){return this.replaceWith(M,M,x)}replaceRange(M,x,b){return function(ht,M,x,b){if(!b.size)return ht.deleteRange(M,x);let B=ht.doc.resolve(M),D=ht.doc.resolve(x);if(qt(B,D,b))return ht.step(new bt(M,x,b));let V=Te(B,ht.doc.resolve(x));0==V[V.length-1]&&V.pop();let mt=-(B.depth+1);V.unshift(mt);for(let y=B.depth,O=B.pos-1;y>0;y--,O--){let w=B.node(y).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;V.indexOf(y)>-1?mt=y:B.before(y)==O&&V.splice(1,0,-y)}let Dt=V.indexOf(mt),R=[],l=b.openStart;for(let y=b.content,O=0;;O++){let w=y.firstChild;if(R.push(w),O==b.openStart)break;y=w.content}for(let y=l-1;y>=0;y--){let O=R[y].type,w=Ie(O);if(w&&B.node(Dt).type!=O)l=y;else if(w||!O.isTextblock)break}for(let y=b.openStart;y>=0;y--){let O=(y+l+1)%(b.openStart+1),w=R[O];if(w)for(let z=0;z<V.length;z++){let dt=V[(z+Dt)%V.length],St=!0;dt<0&&(St=!1,dt=-dt);let ne=B.node(dt-1),te=B.index(dt-1);if(ne.canReplaceWith(te,te,w.type,w.marks))return ht.replace(B.before(dt),St?D.after(dt):x,new s.p2(Fe(b.content,0,b.openStart,O),O,b.openEnd))}}let d=ht.steps.length;for(let y=V.length-1;y>=0&&(ht.replace(M,x,b),!(ht.steps.length>d));y--){let O=V[y];O<0||(M=B.before(O),x=D.after(O))}}(this,M,x,b),this}replaceRangeWith(M,x,b){return function(ht,M,x,b){if(!b.isInline&&M==x&&ht.doc.resolve(M).parent.content.size){let B=function(ht,M,x){let b=ht.resolve(M);if(b.parent.canReplaceWith(b.index(),b.index(),x))return M;if(0==b.parentOffset)for(let B=b.depth-1;B>=0;B--){let D=b.index(B);if(b.node(B).canReplaceWith(D,D,x))return b.before(B+1);if(D>0)return null}if(b.parentOffset==b.parent.content.size)for(let B=b.depth-1;B>=0;B--){let D=b.indexAfter(B);if(b.node(B).canReplaceWith(D,D,x))return b.after(B+1);if(D<b.node(B).childCount)return null}return null}(ht.doc,M,b.type);null!=B&&(M=x=B)}ht.replaceRange(M,x,new s.p2(s.HY.from(b),0,0))}(this,M,x,b),this}deleteRange(M,x){return function(ht,M,x){let b=ht.doc.resolve(M),B=ht.doc.resolve(x),D=Te(b,B);for(let V=0;V<D.length;V++){let mt=D[V],Dt=V==D.length-1;if(Dt&&0==mt||b.node(mt).type.contentMatch.validEnd)return ht.delete(b.start(mt),B.end(mt));if(mt>0&&(Dt||b.node(mt-1).canReplace(b.index(mt-1),B.indexAfter(mt-1))))return ht.delete(b.before(mt),B.after(mt))}for(let V=1;V<=b.depth&&V<=B.depth;V++)if(M-b.start(V)==b.depth-V&&x>b.end(V)&&B.end(V)-x!=B.depth-V)return ht.delete(b.before(V),x);ht.delete(M,x)}(this,M,x),this}lift(M,x){return function(ht,M,x){let{$from:b,$to:B,depth:D}=M,V=b.before(D+1),mt=B.after(D+1),Dt=V,R=mt,l=s.HY.empty,d=0;for(let w=D,z=!1;w>x;w--)z||b.index(w)>0?(z=!0,l=s.HY.from(b.node(w).copy(l)),d++):Dt--;let y=s.HY.empty,O=0;for(let w=D,z=!1;w>x;w--)z||B.after(w+1)<B.end(w)?(z=!0,y=s.HY.from(B.node(w).copy(y)),O++):R++;ht.step(new lt(Dt,R,V,mt,new s.p2(l.append(y),d,O),l.size-d,!0))}(this,M,x),this}join(M,x=1){return function(ht,M,x){let b=new bt(M-x,M+x,s.p2.empty,!0);ht.step(b)}(this,M,x),this}wrap(M,x){return function(ht,M,x){let b=s.HY.empty;for(let V=x.length-1;V>=0;V--){if(b.size){let mt=x[V].type.contentMatch.matchFragment(b);if(!mt||!mt.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}b=s.HY.from(x[V].type.create(x[V].attrs,b))}let B=M.start,D=M.end;ht.step(new lt(B,D,B,D,new s.p2(b,0,0),x.length,!0))}(this,M,x),this}setBlockType(M,x=M,b,B=null){return function(ht,M,x,b,B){if(!b.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let D=ht.steps.length;ht.doc.nodesBetween(M,x,(V,mt)=>{if(V.isTextblock&&!V.hasMarkup(b,B)&&function(ht,M,x){let b=ht.resolve(M),B=b.index();return b.parent.canReplaceWith(B,B+1,x)}(ht.doc,ht.mapping.slice(D).map(mt),b)){ht.clearIncompatible(ht.mapping.slice(D).map(mt,1),b);let Dt=ht.mapping.slice(D),R=Dt.map(mt,1),l=Dt.map(mt+V.nodeSize,1);return ht.step(new lt(R,l,R+1,l-1,new s.p2(s.HY.from(b.create(B,null,V.marks)),0,0),1,!0)),!1}})}(this,M,x,b,B),this}setNodeMarkup(M,x,b=null,B){return function(ht,M,x,b,B){let D=ht.doc.nodeAt(M);if(!D)throw new RangeError("No node at given position");x||(x=D.type);let V=x.create(b,null,B||D.marks);if(D.isLeaf)return ht.replaceWith(M,M+D.nodeSize,V);if(!x.validContent(D.content))throw new RangeError("Invalid content for node type "+x.name);ht.step(new lt(M,M+D.nodeSize,M+1,M+D.nodeSize-1,new s.p2(s.HY.from(V),0,0),1,!0))}(this,M,x,b,B),this}setNodeAttribute(M,x,b){return this.step(new Le(M,x,b)),this}addNodeMark(M,x){return this.step(new ot(M,x)),this}removeNodeMark(M,x){if(!(x instanceof s.vc)){let b=this.doc.nodeAt(M);if(!b)throw new RangeError("No node at position "+M);if(!(x=x.isInSet(b.marks)))return this}return this.step(new xt(M,x)),this}split(M,x=1,b){return function(ht,M,x=1,b){let B=ht.doc.resolve(M),D=s.HY.empty,V=s.HY.empty;for(let mt=B.depth,Dt=B.depth-x,R=x-1;mt>Dt;mt--,R--){D=s.HY.from(B.node(mt).copy(D));let l=b&&b[R];V=s.HY.from(l?l.type.create(l.attrs,V):B.node(mt).copy(V))}ht.step(new bt(M,M,new s.p2(D.append(V),x,x),!0))}(this,M,x,b),this}addMark(M,x,b){return function(ht,M,x,b){let V,mt,B=[],D=[];ht.doc.nodesBetween(M,x,(Dt,R,l)=>{if(!Dt.isInline)return;let d=Dt.marks;if(!b.isInSet(d)&&l.type.allowsMarkType(b.type)){let y=Math.max(R,M),O=Math.min(R+Dt.nodeSize,x),w=b.addToSet(d);for(let z=0;z<d.length;z++)d[z].isInSet(w)||(V&&V.to==y&&V.mark.eq(d[z])?V.to=O:B.push(V=new ut(y,O,d[z])));mt&&mt.to==y?mt.to=O:D.push(mt=new tt(y,O,b))}}),B.forEach(Dt=>ht.step(Dt)),D.forEach(Dt=>ht.step(Dt))}(this,M,x,b),this}removeMark(M,x,b){return function(ht,M,x,b){let B=[],D=0;ht.doc.nodesBetween(M,x,(V,mt)=>{if(!V.isInline)return;D++;let Dt=null;if(b instanceof s.ZU){let l,R=V.marks;for(;l=b.isInSet(R);)(Dt||(Dt=[])).push(l),R=l.removeFromSet(R)}else b?b.isInSet(V.marks)&&(Dt=[b]):Dt=V.marks;if(Dt&&Dt.length){let R=Math.min(mt+V.nodeSize,x);for(let l=0;l<Dt.length;l++){let y,d=Dt[l];for(let O=0;O<B.length;O++){let w=B[O];w.step==D-1&&d.eq(B[O].style)&&(y=w)}y?(y.to=R,y.step=D):B.push({style:d,from:Math.max(mt,M),to:R,step:D})}}}),B.forEach(V=>ht.step(new ut(V.from,V.to,V.style)))}(this,M,x,b),this}clearIncompatible(M,x,b){return function(ht,M,x,b=x.contentMatch){let B=ht.doc.nodeAt(M),D=[],V=M+1;for(let mt=0;mt<B.childCount;mt++){let Dt=B.child(mt),R=V+Dt.nodeSize,l=b.matchType(Dt.type);if(l){b=l;for(let d=0;d<Dt.marks.length;d++)x.allowsMarkType(Dt.marks[d].type)||ht.step(new ut(V,R,Dt.marks[d]))}else D.push(new bt(V,R,s.p2.empty));V=R}if(!b.validEnd){let mt=b.fillBefore(s.HY.empty,!0);ht.replace(V,V,new s.p2(mt,0,0))}for(let mt=D.length-1;mt>=0;mt--)ht.step(D[mt])}(this,M,x,b),this}}},43594:(Gt,yt,a)=>{a.d(yt,{p:()=>en,EH:()=>Je,tk:()=>Wo});var s=a(62463),c=a(27439),$=a(38480);const I=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},_=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let j=null;const F=function(e,t,n){let o=j||(j=document.createRange());return o.setEnd(e,null==n?e.nodeValue.length:n),o.setStart(e,t||0),o},nt=function(e,t,n,o){return n&&(q(e,t,n,o,-1)||q(e,t,n,o,1))},Y=/^(img|br|input|textarea|hr)$/i;function q(e,t,n,o,i){for(;;){if(e==n&&t==o)return!0;if(t==(i<0?0:et(e))){let r=e.parentNode;if(!r||1!=r.nodeType||Ot(e)||Y.test(e.nodeName)||"false"==e.contentEditable)return!1;t=I(e)+(i<0?0:1),e=r}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?et(e):0}}}function et(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Ot(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const ft=function(e){return e.focusNode&&nt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function st(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const tt="undefined"!=typeof navigator?navigator:null,ut="undefined"!=typeof document?document:null,ot=tt&&tt.userAgent||"",xt=/Edge\/(\d+)/.exec(ot),bt=/MSIE \d/.exec(ot),lt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ot),Rt=!!(bt||lt||xt),Yt=bt?document.documentMode:lt?+lt[1]:xt?+xt[1]:0,Zt=!Rt&&/gecko\/(\d+)/i.test(ot);Zt&&/Firefox\/(\d+)/.exec(ot);const Ht=!Rt&&/Chrome\/(\d+)/.exec(ot),At=!!Ht,Et=Ht?+Ht[1]:0,X=!Rt&&!!tt&&/Apple Computer/.test(tt.vendor),P=X&&(/Mobile\/\w+/.test(ot)||!!tt&&tt.maxTouchPoints>2),H=P||!!tt&&/Mac/.test(tt.platform),K=!!tt&&/Win/.test(tt.platform),Mt=/Android \d/.test(ot),Pt=!!ut&&"webkitFontSmoothing"in ut.documentElement.style,Kt=Pt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function oe(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Jt(e,t){return"number"==typeof e?e:e[t]}function se(e){let t=e.getBoundingClientRect();return{left:t.left,right:t.left+e.clientWidth*(t.width/e.offsetWidth||1),top:t.top,bottom:t.top+e.clientHeight*(t.height/e.offsetHeight||1)}}function rt(e,t,n){let o=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,r=e.dom.ownerDocument;for(let u=n||e.dom;u;u=_(u)){if(1!=u.nodeType)continue;let f=u,C=f==r.body,k=C?oe(r):se(f),A=0,U=0;if(t.top<k.top+Jt(o,"top")?U=-(k.top-t.top+Jt(i,"top")):t.bottom>k.bottom-Jt(o,"bottom")&&(U=t.bottom-k.bottom+Jt(i,"bottom")),t.left<k.left+Jt(o,"left")?A=-(k.left-t.left+Jt(i,"left")):t.right>k.right-Jt(o,"right")&&(A=t.right-k.right+Jt(i,"right")),A||U)if(C)r.defaultView.scrollBy(A,U);else{let it=f.scrollLeft,ct=f.scrollTop;U&&(f.scrollTop+=U),A&&(f.scrollLeft+=A);let _t=f.scrollLeft-it,Bt=f.scrollTop-ct;t={left:t.left-_t,top:t.top-Bt,right:t.right-_t,bottom:t.bottom-Bt}}if(C)break}}function Ut(e){let t=[],n=e.ownerDocument;for(let o=e;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),e!=n);o=_(o));return t}function fe(e,t){for(let n=0;n<e.length;n++){let{dom:o,top:i,left:r}=e[n];o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=r&&(o.scrollLeft=r)}}let ee=null;function Nt(e,t){let n,i,C,k,o=2e8,r=0,u=t.top,f=t.top;for(let A=e.firstChild,U=0;A;A=A.nextSibling,U++){let it;if(1==A.nodeType)it=A.getClientRects();else{if(3!=A.nodeType)continue;it=F(A).getClientRects()}for(let ct=0;ct<it.length;ct++){let _t=it[ct];if(_t.top<=u&&_t.bottom>=f){u=Math.max(_t.bottom,u),f=Math.min(_t.top,f);let Bt=_t.left>t.left?_t.left-t.left:_t.right<t.left?t.left-_t.right:0;if(Bt<o){n=A,o=Bt,i=Bt&&3==n.nodeType?{left:_t.right<t.left?_t.right:_t.left,top:t.top}:t,1==A.nodeType&&Bt&&(r=U+(t.left>=(_t.left+_t.right)/2?1:0));continue}}else _t.top>t.top&&!C&&_t.left<=t.left&&_t.right>=t.left&&(C=A,k={left:Math.max(_t.left,Math.min(_t.right,t.left)),top:_t.top});!n&&(t.left>=_t.right&&t.top>=_t.top||t.left>=_t.left&&t.top>=_t.bottom)&&(r=U+1)}}return!n&&C&&(n=C,i=k,o=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,o=document.createRange();for(let i=0;i<n;i++){o.setEnd(e,i+1),o.setStart(e,i);let r=Ie(o,1);if(r.top!=r.bottom&&kt(t,r))return{node:e,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:e,offset:0}}(n,i):!n||o&&1==n.nodeType?{node:e,offset:r}:Nt(n,i)}function kt(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Me(e,t,n){let o=e.childNodes.length;if(o&&n.top<n.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-n.top)/(n.bottom-n.top))-2)),r=i;;){let u=e.childNodes[r];if(1==u.nodeType){let f=u.getClientRects();for(let C=0;C<f.length;C++){let k=f[C];if(kt(t,k))return Me(u,t,k)}}if((r=(r+1)%o)==i)break}return e}function Ne(e,t){let o,n=e.dom.ownerDocument,i=0,r=function(e,t,n){if(e.caretPositionFromPoint)try{let o=e.caretPositionFromPoint(t,n);if(o)return{node:o.offsetNode,offset:o.offset}}catch(o){}if(e.caretRangeFromPoint){let o=e.caretRangeFromPoint(t,n);if(o)return{node:o.startContainer,offset:o.startOffset}}}(n,t.left,t.top);r&&({node:o,offset:i}=r);let f,u=(e.root.elementFromPoint?e.root:n).elementFromPoint(t.left,t.top);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){let k=e.dom.getBoundingClientRect();if(!kt(t,k)||(u=Me(e.dom,t,k),!u))return null}if(X)for(let k=u;o&&k;k=_(k))k.draggable&&(o=void 0);if(u=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(u,t),o){if(Zt&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length),i<o.childNodes.length)){let A,k=o.childNodes[i];"IMG"==k.nodeName&&(A=k.getBoundingClientRect()).right<=t.left&&A.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?f=e.state.doc.content.size:(0==i||1!=o.nodeType||"BR"!=o.childNodes[i-1].nodeName)&&(f=function(e,t,n,o){let i=-1;for(let r=t,u=!1;r!=e.dom;){let f=e.docView.nearestDesc(r,!0);if(!f)return null;if(1==f.dom.nodeType&&(f.node.isBlock&&f.parent&&!u||!f.contentDOM)){let C=f.dom.getBoundingClientRect();if(f.node.isBlock&&f.parent&&!u&&(u=!0,C.left>o.left||C.top>o.top?i=f.posBefore:(C.right<o.left||C.bottom<o.top)&&(i=f.posAfter)),!f.contentDOM&&i<0)return(f.node.isBlock?o.top<(C.top+C.bottom)/2:o.left<(C.left+C.right)/2)?f.posBefore:f.posAfter}r=f.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}(e,o,i,t))}null==f&&(f=function(e,t,n){let{node:o,offset:i}=Nt(t,n),r=-1;if(1==o.nodeType&&!o.firstChild){let u=o.getBoundingClientRect();r=u.left!=u.right&&n.left>(u.left+u.right)/2?1:-1}return e.docView.posFromDOM(o,i,r)}(e,u,t));let C=e.docView.nearestDesc(u,!0);return{pos:f,inside:C?C.posAtStart-C.border:-1}}function xe(e){return e.top<e.bottom||e.left<e.right}function Ie(e,t){let n=e.getClientRects();if(n.length){let o=n[t<0?0:n.length-1];if(xe(o))return o}return Array.prototype.find.call(n,xe)||e.getBoundingClientRect()}const Ze=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Fe(e,t,n){let{node:o,offset:i,atom:r}=e.docView.domFromPos(t,n<0?-1:1),u=Pt||Zt;if(3==o.nodeType){if(!u||!Ze.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){let C=i,k=i,A=n<0?1:-1;return n<0&&!i?(k++,A=-1):n>=0&&i==o.nodeValue.length?(C--,A=1):n<0?C--:k++,De(Ie(F(o,C,k),A),A<0)}{let C=Ie(F(o,i,i),n);if(Zt&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){let k=Ie(F(o,i-1,i-1),-1);if(k.top==C.top){let A=Ie(F(o,i,i+1),-1);if(A.top!=C.top)return De(A,A.left<k.left)}}return C}}if(!e.state.doc.resolve(t-(r||0)).parent.inlineContent){if(null==r&&i&&(n<0||i==et(o))){let C=o.childNodes[i-1];if(1==C.nodeType)return Ue(C.getBoundingClientRect(),!1)}if(null==r&&i<et(o)){let C=o.childNodes[i];if(1==C.nodeType)return Ue(C.getBoundingClientRect(),!0)}return Ue(o.getBoundingClientRect(),n>=0)}if(null==r&&i&&(n<0||i==et(o))){let C=o.childNodes[i-1],k=3==C.nodeType?F(C,et(C)-(u?0:1)):1!=C.nodeType||"BR"==C.nodeName&&C.nextSibling?null:C;if(k)return De(Ie(k,1),!1)}if(null==r&&i<et(o)){let C=o.childNodes[i];for(;C.pmViewDesc&&C.pmViewDesc.ignoreForCoords;)C=C.nextSibling;let k=C?3==C.nodeType?F(C,0,u?0:1):1==C.nodeType?C:null:null;if(k)return De(Ie(k,-1),!0)}return De(Ie(3==o.nodeType?F(o):o,-n),n>=0)}function De(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Ue(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Te(e,t,n){let o=e.state,i=e.root.activeElement;o!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{o!=t&&e.updateState(o),i!=e.dom&&i&&i.focus()}}const be=/[\u0590-\u08ac]/;let ht=null,M=null,x=!1;class Dt{constructor(t,n,o,i){this.parent=t,this.children=n,this.dom=o,this.contentDOM=i,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,n,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let n=0;n<this.children.length;n++)t+=this.children[n].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let n=0,o=this.posAtStart;;n++){let i=this.children[n];if(i==t)return o;o+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,n,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let r,u;if(t==this.contentDOM)r=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(u=r.pmViewDesc)||u.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(u)+u.size:this.posAtStart}{let r,u;if(t==this.contentDOM)r=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&(!(u=r.pmViewDesc)||u.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(u):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=n>I(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!1;break}if(r.previousSibling)break}if(null==i&&n==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!0;break}if(r.nextSibling)break}}return(null==i?o>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,n=!1){for(let o=!0,i=t;i;i=i.parentNode){let u,r=this.getDesc(i);if(r&&(!n||r.node)){if(!o||!(u=r.nodeDOM)||(1==u.nodeType?u.contains(1==t.nodeType?t:t.parentNode):u==t))return r;o=!1}}}getDesc(t){let n=t.pmViewDesc;for(let o=n;o;o=o.parent)if(o==this)return n}posFromDOM(t,n,o){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,n,o)}return-1}descAt(t){for(let n=0,o=0;n<this.children.length;n++){let i=this.children[n],r=o+i.size;if(o==t&&r!=o){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-o-i.border);o=r}}domFromPos(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,o=0,i=0;for(let r=0;o<this.children.length;o++){let u=this.children[o],f=r+u.size;if(f>t||u instanceof z){i=t-r;break}r=f}if(i)return this.children[o].domFromPos(i-this.children[o].border,n);for(;o&&!(r=this.children[o-1]).size&&r instanceof R&&r.side>=0;o--);if(n<=0){let r,u=!0;for(;r=o?this.children[o-1]:null,r&&r.dom.parentNode!=this.contentDOM;o--,u=!1);return r&&n&&u&&!r.border&&!r.domAtom?r.domFromPos(r.size,n):{node:this.contentDOM,offset:r?I(r.dom)+1:0}}{let r,u=!0;for(;r=o<this.children.length?this.children[o]:null,r&&r.dom.parentNode!=this.contentDOM;o++,u=!1);return r&&u&&!r.border&&!r.domAtom?r.domFromPos(0,n):{node:this.contentDOM,offset:r?I(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,n,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let u=o,f=0;;f++){let C=this.children[f],k=u+C.size;if(-1==i&&t<=k){let A=u+C.border;if(t>=A&&n<=k-C.border&&C.node&&C.contentDOM&&this.contentDOM.contains(C.contentDOM))return C.parseRange(t,n,A);t=u;for(let U=f;U>0;U--){let it=this.children[U-1];if(it.size&&it.dom.parentNode==this.contentDOM&&!it.emptyChildAt(1)){i=I(it.dom)+1;break}t-=it.size}-1==i&&(i=0)}if(i>-1&&(k>n||f==this.children.length-1)){n=k;for(let A=f+1;A<this.children.length;A++){let U=this.children[A];if(U.size&&U.dom.parentNode==this.contentDOM&&!U.emptyChildAt(-1)){r=I(U.dom);break}n+=U.size}-1==r&&(r=this.contentDOM.childNodes.length);break}u=k}return{node:this.contentDOM,from:t,to:n,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[t<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(t)}domAfterPos(t){let{node:n,offset:o}=this.domFromPos(t,0);if(1!=n.nodeType||o==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[o]}setSelection(t,n,o,i=!1){let r=Math.min(t,n),u=Math.max(t,n);for(let it=0,ct=0;it<this.children.length;it++){let _t=this.children[it],Bt=ct+_t.size;if(r>ct&&u<Bt)return _t.setSelection(t-ct-_t.border,n-ct-_t.border,o,i);ct=Bt}let f=this.domFromPos(t,t?-1:1),C=n==t?f:this.domFromPos(n,n?-1:1),k=o.getSelection(),A=!1;if((Zt||X)&&t==n){let{node:it,offset:ct}=f;if(3==it.nodeType){if(A=!(!ct||"\n"!=it.nodeValue[ct-1]),A&&ct==it.nodeValue.length)for(let Bt,_t=it;_t;_t=_t.parentNode){if(Bt=_t.nextSibling){"BR"==Bt.nodeName&&(f=C={node:Bt.parentNode,offset:I(Bt)+1});break}let $t=_t.pmViewDesc;if($t&&$t.node&&$t.node.isBlock)break}}else{let _t=it.childNodes[ct-1];A=_t&&("BR"==_t.nodeName||"false"==_t.contentEditable)}}if(Zt&&k.focusNode&&k.focusNode!=C.node&&1==k.focusNode.nodeType){let it=k.focusNode.childNodes[k.focusOffset];it&&"false"==it.contentEditable&&(i=!0)}if(!(i||A&&X)&&nt(f.node,f.offset,k.anchorNode,k.anchorOffset)&&nt(C.node,C.offset,k.focusNode,k.focusOffset))return;let U=!1;if((k.extend||t==n)&&!A){k.collapse(f.node,f.offset);try{t!=n&&k.extend(C.node,C.offset),U=!0}catch(it){}}if(!U){if(t>n){let ct=f;f=C,C=ct}let it=document.createRange();it.setEnd(C.node,C.offset),it.setStart(f.node,f.offset),k.removeAllRanges(),k.addRange(it)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,n){for(let o=0,i=0;i<this.children.length;i++){let r=this.children[i],u=o+r.size;if(o==u?t<=u&&n>=o:t<u&&n>o){let f=o+r.border,C=u-r.border;if(t>=f&&n<=C)return this.dirty=t==o||n==u?2:1,void(t!=f||n!=C||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-f,n-f):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=u}this.dirty=2}markParentsDirty(){let t=1;for(let n=this.parent;n;n=n.parent,t++){let o=1==t?2:1;n.dirty<o&&(n.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class R extends Dt{constructor(t,n,o,i){let r,u=n.type.toDOM;if("function"==typeof u&&(u=u(o,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!n.type.spec.raw){if(1!=u.nodeType){let f=document.createElement("span");f.appendChild(u),u=f}u.contentEditable="false",u.classList.add("ProseMirror-widget")}super(t,[],u,null),this.widget=n,this.widget=n,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let n=this.widget.spec.stopEvent;return!!n&&n(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class l extends Dt{constructor(t,n,o,i){super(t,[],n,null),this.textDOM=o,this.text=i}get size(){return this.text.length}localPosFromDOM(t,n){return t!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class d extends Dt{constructor(t,n,o,i){super(t,[],o,i),this.mark=n}static create(t,n,o,i){let r=i.nodeViews[n.type.name],u=r&&r(n,i,o);return(!u||!u.dom)&&(u=c.PW.renderSpec(document,n.type.spec.toDOM(n,o))),new d(t,n,u.dom,u.contentDOM||u.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,n){if(super.markDirty(t,n),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,n,o){let i=d.create(this.parent,this.mark,!0,o),r=this.children,u=this.size;n<u&&(r=Ce(r,n,u,o)),t>0&&(r=Ce(r,0,t,o));for(let f=0;f<r.length;f++)r[f].parent=i;return i.children=r,i}}class y extends Dt{constructor(t,n,o,i,r,u,f,C,k){super(t,[],r,u),this.node=n,this.outerDeco=o,this.innerDeco=i,this.nodeDOM=f}static create(t,n,o,i,r,u){let C,f=r.nodeViews[n.type.name],k=f&&f(n,r,()=>C?C.parent?C.parent.posBeforeChild(C):void 0:u,o,i),A=k&&k.dom,U=k&&k.contentDOM;if(n.isText)if(A){if(3!=A.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else A=document.createTextNode(n.text);else A||({dom:A,contentDOM:U}=c.PW.renderSpec(document,n.type.spec.toDOM(n)));!U&&!n.isText&&"BR"!=A.nodeName&&(A.hasAttribute("contenteditable")||(A.contentEditable="false"),n.type.spec.draggable&&(A.draggable=!0));let it=A;return A=at(A,o,n),k?C=new dt(t,n,o,i,A,U||null,it,k,r,u+1):n.isText?new w(t,n,o,i,A,it,r):new y(t,n,o,i,A,U||null,it,r,u+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let o=this.children[n];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>c.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,n,o){return 0==this.dirty&&t.eq(this.node)&&vt(n,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,n){let o=this.node.inlineContent,i=n,r=t.composing?this.localCompositionInfo(t,n):null,u=r&&r.pos>-1?r:null,f=r&&r.pos<0,C=new zt(this,u&&u.node,t);(function(e,t,n,o){let i=t.locals(e),r=0;if(0==i.length){for(let k=0;k<e.childCount;k++){let A=e.child(k);o(A,i,t.forChild(r,A),k),r+=A.nodeSize}return}let u=0,f=[],C=null;for(let k=0;;){if(u<i.length&&i[u].to==r){let Bt,_t=i[u++];for(;u<i.length&&i[u].to==r;)(Bt||(Bt=[_t])).push(i[u++]);if(Bt){Bt.sort(Vt);for(let $t=0;$t<Bt.length;$t++)n(Bt[$t],k,!!C)}else n(_t,k,!!C)}let A,U;if(C)U=-1,A=C,C=null;else{if(!(k<e.childCount))break;U=k,A=e.child(k++)}for(let _t=0;_t<f.length;_t++)f[_t].to<=r&&f.splice(_t--,1);for(;u<i.length&&i[u].from<=r&&i[u].to>r;)f.push(i[u++]);let it=r+A.nodeSize;if(A.isText){let _t=it;u<i.length&&i[u].from<_t&&(_t=i[u].from);for(let Bt=0;Bt<f.length;Bt++)f[Bt].to<_t&&(_t=f[Bt].to);_t<it&&(C=A.cut(_t-r),A=A.cut(0,_t-r),it=_t,U=-1)}o(A,A.isInline&&!A.isLeaf?f.filter(_t=>!_t.inline):f.slice(),t.forChild(r,A),U),r=it}})(this.node,this.innerDeco,(k,A,U)=>{k.spec.marks?C.syncToMarks(k.spec.marks,o,t):k.type.side>=0&&!U&&C.syncToMarks(A==this.node.childCount?c.vc.none:this.node.child(A).marks,o,t),C.placeWidget(k,t,i)},(k,A,U,it)=>{let ct;C.syncToMarks(k.marks,o,t),C.findNodeMatch(k,A,U,it)||f&&t.state.selection.from>i&&t.state.selection.to<i+k.nodeSize&&(ct=C.findIndexWithChild(r.node))>-1&&C.updateNodeAt(k,A,U,ct,t)||C.updateNextNode(k,A,U,t,it,i)||C.addNode(k,A,U,t,i),i+=k.nodeSize}),C.syncToMarks([],o,t),this.node.isTextblock&&C.addTextblockHacks(),C.destroyRest(),(C.changed||2==this.dirty)&&(u&&this.protectLocalComposition(t,u),St(this.contentDOM,this.children,t),P&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e),e.style.cssText=t}}(this.dom))}localCompositionInfo(t,n){let{from:o,to:i}=t.state.selection;if(!(t.state.selection instanceof s.Bs)||o<n||i>n+this.node.content.size)return null;let r=t.domSelectionRange(),u=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=et(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!u||!this.dom.contains(u.parentNode))return null;if(this.node.inlineContent){let f=u.nodeValue,C=function(e,t,n,o){for(let i=0,r=0;i<e.childCount&&r<=o;){let u=e.child(i++),f=r;if(r+=u.nodeSize,!u.isText)continue;let C=u.text;for(;i<e.childCount;){let k=e.child(i++);if(r+=k.nodeSize,!k.isText)break;C+=k.text}if(r>=n){let k=f<o?C.lastIndexOf(t,o-f-1):-1;if(k>=0&&k+t.length+f>=n)return f+k;if(n==o&&C.length>=o+t.length-f&&C.slice(o-f,o-f+t.length)==t)return o}}return-1}(this.node.content,f,o-n,i-n);return C<0?null:{node:u,pos:C,text:f}}return{node:u,pos:-1,text:""}}protectLocalComposition(t,{node:n,pos:o,text:i}){if(this.getDesc(n))return;let r=n;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let u=new l(this,r,n,i);t.input.compositionNodes.push(u),this.children=Ce(this.children,o,o+i.length,t,u)}update(t,n,o,i){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,n,o,i),0))}updateInner(t,n,o,i){this.updateOuterDeco(n),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(vt(t,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=J(this.dom,this.nodeDOM,Pe(this.outerDeco,this.node,n),Pe(t,this.node,n)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function O(e,t,n,o,i){at(o,t,e);let r=new y(void 0,e,t,n,o,o,o,i,0);return r.contentDOM&&r.updateChildren(i,0),r}class w extends y{constructor(t,n,o,i,r,u,f){super(t,n,o,i,r,null,u,f,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,n,o,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,n,o){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(t,n,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,n,o){let i=this.node.cut(t,n),r=document.createTextNode(i.text);return new w(this.parent,i,this.outerDeco,this.innerDeco,r,r,o)}markDirty(t,n){super.markDirty(t,n),this.dom!=this.nodeDOM&&(0==t||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class z extends Dt{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class dt extends y{constructor(t,n,o,i,r,u,f,C,k,A){super(t,n,o,i,r,u,f,k,A),this.spec=C}update(t,n,o,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,n,o);return r&&this.updateInner(t,n,o,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,n,o,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,n,o,i){this.spec.setSelection?this.spec.setSelection(t,n,o):super.setSelection(t,n,o,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function St(e,t,n){let o=e.firstChild,i=!1;for(let r=0;r<t.length;r++){let u=t[r],f=u.dom;if(f.parentNode==e){for(;f!=o;)o=Ct(o),i=!0;o=o.nextSibling}else i=!0,e.insertBefore(f,o);if(u instanceof d){let C=o?o.previousSibling:e.lastChild;St(u.contentDOM,u.children,n),o=C?C.nextSibling:e.firstChild}}for(;o;)o=Ct(o),i=!0;i&&n.trackWrites==e&&(n.trackWrites=null)}const ne=function(e){e&&(this.nodeName=e)};ne.prototype=Object.create(null);const te=[new ne];function Pe(e,t,n){if(0==e.length)return te;let o=n?te[0]:new ne,i=[o];for(let r=0;r<e.length;r++){let u=e[r].type.attrs;if(u){u.nodeName&&i.push(o=new ne(u.nodeName));for(let f in u){let C=u[f];null!=C&&(n&&1==i.length&&i.push(o=new ne(t.isInline?"span":"div")),"class"==f?o.class=(o.class?o.class+" ":"")+C:"style"==f?o.style=(o.style?o.style+";":"")+C:"nodeName"!=f&&(o[f]=C))}}}return i}function J(e,t,n,o){if(n==te&&o==te)return t;let i=t;for(let r=0;r<o.length;r++){let u=o[r],f=n[r];if(r){let C;f&&f.nodeName==u.nodeName&&i!=e&&(C=i.parentNode)&&C.nodeName.toLowerCase()==u.nodeName||(C=document.createElement(u.nodeName),C.pmIsDeco=!0,C.appendChild(i),f=te[0]),i=C}S(i,f||te[0],u)}return i}function S(e,t,n){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in n)&&e.removeAttribute(o);for(let o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){let o=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let r=0;r<o.length;r++)-1==i.indexOf(o[r])&&e.classList.remove(o[r]);for(let r=0;r<i.length;r++)-1==o.indexOf(i[r])&&e.classList.add(i[r]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let i,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=o.exec(t.style);)e.style.removeProperty(i[1])}n.style&&(e.style.cssText+=n.style)}}function at(e,t,n){return J(e,e,te,Pe(t,n,1!=e.nodeType))}function vt(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Ct(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class zt{constructor(t,n,o){this.lock=n,this.view=o,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(e,t){let n=t,o=n.children.length,i=e.childCount,r=new Map,u=[];t:for(;i>0;){let f;for(;;)if(o){let k=n.children[o-1];if(!(k instanceof d)){f=k,o--;break}n=k,o=k.children.length}else{if(n==t)break t;o=n.parent.children.indexOf(n),n=n.parent}let C=f.node;if(C){if(C!=e.child(i-1))break;--i,r.set(f,i),u.push(f)}}return{index:i,matched:r,matches:u.reverse()}}(t.node.content,t)}destroyBetween(t,n){if(t!=n){for(let o=t;o<n;o++)this.top.children[o].destroy();this.top.children.splice(t,n-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,n,o){let i=0,r=this.stack.length>>1,u=Math.min(r,t.length);for(;i<u&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let f=-1;for(let C=this.index;C<Math.min(this.index+3,this.top.children.length);C++){let k=this.top.children[C];if(k.matchesMark(t[r])&&!this.isLocked(k.dom)){f=C;break}}if(f>-1)f>this.index&&(this.changed=!0,this.destroyBetween(this.index,f)),this.top=this.top.children[this.index];else{let C=d.create(this.top,t[r],n,o);this.top.children.splice(this.index,0,C),this.top=C,this.changed=!0}this.index=0,r++}}findNodeMatch(t,n,o,i){let u,r=-1;if(i>=this.preMatch.index&&(u=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&u.matchesNode(t,n,o))r=this.top.children.indexOf(u,this.index);else for(let f=this.index,C=Math.min(this.top.children.length,f+5);f<C;f++){let k=this.top.children[f];if(k.matchesNode(t,n,o)&&!this.preMatch.matched.has(k)){r=f;break}}return!(r<0||(this.destroyBetween(this.index,r),this.index++,0))}updateNodeAt(t,n,o,i,r){let u=this.top.children[i];return 3==u.dirty&&u.dom==u.contentDOM&&(u.dirty=2),!!u.update(t,n,o,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==o)return i;return-1}t=n}}updateNextNode(t,n,o,i,r,u){for(let f=this.index;f<this.top.children.length;f++){let C=this.top.children[f];if(C instanceof y){let k=this.preMatch.matched.get(C);if(null!=k&&k!=r)return!1;let U,A=C.dom,it=this.isLocked(A)&&!(t.isText&&C.node&&C.node.isText&&C.nodeDOM.nodeValue==t.text&&3!=C.dirty&&vt(n,C.outerDeco));if(!it&&C.update(t,n,o,i))return this.destroyBetween(this.index,f),C.dom!=A&&(this.changed=!0),this.index++,!0;if(!it&&(U=this.recreateWrapper(C,t,n,o,i,u)))return this.top.children[this.index]=U,U.dirty=2,U.updateChildren(i,u+1),U.dirty=0,this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,n,o,i,r,u){if(t.dirty||n.isAtom||!t.children.length||!t.node.content.eq(n.content))return null;let f=y.create(this.top,n,o,i,r,u);if(!f.contentDOM)return null;f.children=t.children,t.children=[],t.destroy();for(let C of f.children)C.parent=f;return f}addNode(t,n,o,i,r){let u=y.create(this.top,t,n,o,i,r);u.contentDOM&&u.updateChildren(i,r+1),this.top.children.splice(this.index++,0,u),this.changed=!0}placeWidget(t,n,o){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let r=new R(this.top,t,n,o);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],n=this.top;for(;t instanceof d;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof w)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((X||At)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let i=new z(this.top,[],o,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))}}function Vt(e,t){return e.type.side-t.type.side}function Ce(e,t,n,o,i){let r=[];for(let u=0,f=0;u<e.length;u++){let C=e[u],k=f,A=f+=C.size;k>=n||A<=t?r.push(C):(k<t&&r.push(C.slice(0,t-k,o)),i&&(r.push(i),i=void 0),A>n&&r.push(C.slice(n-k,C.size,o)))}return r}function _e(e,t=null){let n=e.domSelectionRange(),o=e.state.doc;if(!n.focusNode)return null;let i=e.docView.nearestDesc(n.focusNode),r=i&&0==i.size,u=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(u<0)return null;let C,k,f=o.resolve(u);if(ft(n)){for(C=f;i&&!i.node;)i=i.parent;let A=i.node;if(i&&A.isAtom&&s.qv.isSelectable(A)&&i.parent&&(!A.isInline||!function(e,t,n){for(let o=0==t,i=t==et(e);o||i;){if(e==n)return!0;let r=I(e);if(!(e=e.parentNode))return!1;o=o&&0==r,i=i&&r==et(e)}}(n.focusNode,n.focusOffset,i.dom))){let U=i.posBefore;k=new s.qv(u==U?f:o.resolve(U))}}else{let A=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(A<0)return null;C=o.resolve(A)}return k||(k=cn(e,C,f,"pointer"==t||e.state.selection.head<f.pos&&!r?1:-1)),k}function je(e){return e.editable?e.hasFocus():on(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Be(e,t=!1){let n=e.state.selection;if(On(e,n),je(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&At){let o=e.domSelectionRange(),i=e.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&nt(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange(),o=e.cursorWrapper.dom,i="IMG"==o.nodeName;i?n.setEnd(o.parentNode,I(o)+1):n.setEnd(o,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&Rt&&Yt<=11&&(o.disabled=!0,o.disabled=!1)}(e);else{let r,u,{anchor:o,head:i}=n;nn&&!(n instanceof s.Bs)&&(n.$from.parent.inlineContent||(r=ge(e,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(u=ge(e,n.to))),e.docView.setSelection(o,i,e.root,t),nn&&(r&&Rn(r),u&&Rn(u)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),o=n.anchorNode,i=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(n.anchorNode!=o||n.anchorOffset!=i)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!je(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const nn=X||At&&Et<63;function ge(e,t){let{node:n,offset:o}=e.docView.domFromPos(t,0),i=o<n.childNodes.length?n.childNodes[o]:null,r=o?n.childNodes[o-1]:null;if(X&&i&&"false"==i.contentEditable)return hn(i);if(!(i&&"false"!=i.contentEditable||r&&"false"!=r.contentEditable)){if(i)return hn(i);if(r)return hn(r)}}function hn(e){return e.contentEditable="true",X&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Rn(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function On(e,t){if(t instanceof s.qv){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(mn(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else mn(e)}function mn(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function cn(e,t,n,o){return e.someProp("createSelectionBetween",i=>i(e,t,n))||s.Bs.between(t,n,o)}function bn(e){return!(e.editable&&!e.hasFocus())&&on(e)}function on(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function sn(e,t){let{$anchor:n,$head:o}=e.selection,i=t>0?n.max(o):n.min(o),r=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return r&&s.Y1.findFrom(r,t)}function Qe(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function g(e,t,n){let o=e.state.selection;if(!(o instanceof s.Bs)){if(o instanceof s.qv&&o.node.isInline)return Qe(e,new s.Bs(t>0?o.$to:o.$from));{let i=sn(e.state,t);return!!i&&Qe(e,i)}}if(!o.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let i=sn(e.state,t);return!!(i&&i instanceof s.qv)&&Qe(e,i)}if(!(H&&n.indexOf("m")>-1)){let u,i=o.$head,r=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!r||r.isText)return!1;let f=t<0?i.pos-r.nodeSize:i.pos;return!!(r.isAtom||(u=e.docView.descAt(f))&&!u.contentDOM)&&(s.qv.isSelectable(r)?Qe(e,new s.qv(t<0?e.state.doc.resolve(i.pos-r.nodeSize):i)):!!Pt&&Qe(e,new s.Bs(e.state.doc.resolve(t<0?f:f+r.nodeSize))))}}function v(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function m(e){let t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function h(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let i,r,u=!1;for(Zt&&1==n.nodeType&&o<v(n)&&m(n.childNodes[o])&&(u=!0);;)if(o>0){if(1!=n.nodeType)break;{let f=n.childNodes[o-1];if(m(f))i=n,r=--o;else{if(3!=f.nodeType)break;n=f,o=n.nodeValue.length}}}else{if(N(n))break;{let f=n.previousSibling;for(;f&&m(f);)i=n.parentNode,r=I(f),f=f.previousSibling;if(f)n=f,o=v(n);else{if(n=n.parentNode,n==e.dom)break;o=0}}}u?Z(e,n,o):i&&Z(e,i,r)}(e):E(e)}function E(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let r,u,i=v(n);for(;;)if(o<i){if(1!=n.nodeType)break;if(!m(n.childNodes[o]))break;r=n,u=++o}else{if(N(n))break;{let f=n.nextSibling;for(;f&&m(f);)r=f.parentNode,u=I(f)+1,f=f.nextSibling;if(f)n=f,o=0,i=v(n);else{if(n=n.parentNode,n==e.dom)break;o=i=0}}}r&&Z(e,r,u)}function N(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Z(e,t,n){let o=e.domSelection();if(ft(o)){let r=document.createRange();r.setEnd(t,n),r.setStart(t,n),o.removeAllRanges(),o.addRange(r)}else o.extend&&o.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&Be(e)},50)}function L(e,t){let n=e.state.doc.resolve(t);if(!At&&!K&&n.parent.inlineContent){let i=e.coordsAtPos(t);if(t>n.start()){let r=e.coordsAtPos(t-1),u=(r.top+r.bottom)/2;if(u>i.top&&u<i.bottom&&Math.abs(r.left-i.left)>1)return r.left<i.left?"ltr":"rtl"}if(t<n.end()){let r=e.coordsAtPos(t+1),u=(r.top+r.bottom)/2;if(u>i.top&&u<i.bottom&&Math.abs(r.left-i.left)>1)return r.left>i.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function G(e,t,n){let o=e.state.selection;if(o instanceof s.Bs&&!o.empty||n.indexOf("s")>-1||H&&n.indexOf("m")>-1)return!1;let{$from:i,$to:r}=o;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let u=sn(e.state,t);if(u&&u instanceof s.qv)return Qe(e,u)}if(!i.parent.inlineContent){let u=t<0?i:r,f=o instanceof s.C1?s.Y1.near(u,t):s.Y1.findFrom(u,t);return!!f&&Qe(e,f)}return!1}function gt(e,t){if(!(e.state.selection instanceof s.Bs))return!0;let{$head:n,$anchor:o,empty:i}=e.state.selection;if(!n.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(r&&!r.isText){let u=e.state.tr;return t<0?u.delete(n.pos-r.nodeSize,n.pos):u.delete(n.pos,n.pos+r.nodeSize),e.dispatch(u),!0}return!1}function Tt(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function le(e,t){e.someProp("transformCopied",ct=>{t=ct(t,e)});let n=[],{content:o,openStart:i,openEnd:r}=t;for(;i>1&&r>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,r--;let ct=o.firstChild;n.push(ct.type.name,ct.attrs!=ct.type.defaultAttrs?ct.attrs:null),o=ct.content}let u=e.someProp("clipboardSerializer")||c.PW.fromSchema(e.state.schema),f=Mn(),C=f.createElement("div");C.appendChild(u.serializeFragment(o,{document:f}));let A,k=C.firstChild,U=0;for(;k&&1==k.nodeType&&(A=he[k.nodeName.toLowerCase()]);){for(let ct=A.length-1;ct>=0;ct--){let _t=f.createElement(A[ct]);for(;C.firstChild;)_t.appendChild(C.firstChild);C.appendChild(_t),U++}k=C.firstChild}return k&&1==k.nodeType&&k.setAttribute("data-pm-slice",`${i} ${r}${U?` -${U}`:""} ${JSON.stringify(n)}`),{dom:C,text:e.someProp("clipboardTextSerializer",ct=>ct(t,e))||t.content.textBetween(0,t.content.size,"\n\n")}}function ie(e,t,n,o,i){let u,f,r=i.parent.type.spec.code;if(!n&&!t)return null;let C=t&&(o||r||!n);if(C){if(e.someProp("transformPastedText",it=>{t=it(t,r||o,e)}),r)return t?new c.p2(c.HY.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):c.p2.empty;let U=e.someProp("clipboardTextParser",it=>it(t,i,o,e));if(U)f=U;else{let it=i.marks(),{schema:ct}=e.state,_t=c.PW.fromSchema(ct);u=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(Bt=>{let $t=u.appendChild(document.createElement("p"));Bt&&$t.appendChild(_t.serializeNode(ct.text(Bt,it)))})}}else e.someProp("transformPastedHTML",U=>{n=U(n,e)}),u=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let i,n=Mn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);if((i=o&&he[o[1].toLowerCase()])&&(e=i.map(r=>"<"+r+">").join("")+e+i.map(r=>"</"+r+">").reverse().join("")),n.innerHTML=e,i)for(let r=0;r<i.length;r++)n=n.querySelector(i[r])||n;return n}(n),Pt&&function(e){let t=e.querySelectorAll(At?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let o=t[n];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),o)}}(u);let k=u&&u.querySelector("[data-pm-slice]"),A=k&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(k.getAttribute("data-pm-slice")||"");if(A&&A[3])for(let U=+A[3];U>0;U--){let it=u.firstChild;for(;it&&1!=it.nodeType;)it=it.nextSibling;if(!it)break;u=it}if(f||(f=(e.someProp("clipboardParser")||e.someProp("domParser")||c.aw.fromSchema(e.state.schema)).parseSlice(u,{preserveWhitespace:!(!C&&!A),context:i,ruleFromNode:it=>"BR"!=it.nodeName||it.nextSibling||!it.parentNode||we.test(it.parentNode.nodeName)?null:{ignore:!0}})),A)f=function(e,t){if(!e.size)return e;let o,n=e.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(f){return e}let{content:i,openStart:r,openEnd:u}=e;for(let f=o.length-2;f>=0;f-=2){let C=n.nodes[o[f]];if(!C||C.hasRequiredAttrs())break;i=c.HY.from(C.create(o[f+1],i)),r++,u++}return new c.p2(i,r,u)}(Ge(f,+A[1],+A[2]),A[4]);else if(f=c.p2.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,i=t.node(n).contentMatchAt(t.index(n)),u=[];if(e.forEach(f=>{if(!u)return;let k,C=i.findWrapping(f.type);if(!C)return u=null;if(k=u.length&&r.length&&Ee(C,r,f,u[u.length-1],0))u[u.length-1]=k;else{u.length&&(u[u.length-1]=Ae(u[u.length-1],r.length));let A=Ke(f,C);u.push(A),i=i.matchType(A.type),r=C}}),u)return c.HY.from(u)}return e}(f.content,i),!0),f.openStart||f.openEnd){let U=0,it=0;for(let ct=f.content.firstChild;U<f.openStart&&!ct.type.spec.isolating;U++,ct=ct.firstChild);for(let ct=f.content.lastChild;it<f.openEnd&&!ct.type.spec.isolating;it++,ct=ct.lastChild);f=Ge(f,U,it)}return e.someProp("transformPasted",U=>{f=U(f,e)}),f}const we=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Ke(e,t,n=0){for(let o=t.length-1;o>=n;o--)e=t[o].create(null,c.HY.from(e));return e}function Ee(e,t,n,o,i){if(i<e.length&&i<t.length&&e[i]==t[i]){let r=Ee(e,t,n,o.lastChild,i+1);if(r)return o.copy(o.content.replaceChild(o.childCount-1,r));if(o.contentMatchAt(o.childCount).matchType(i==e.length-1?n.type:e[i+1]))return o.copy(o.content.append(c.HY.from(Ke(n,e,i+1))))}}function Ae(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,Ae(e.lastChild,t-1)),o=e.contentMatchAt(e.childCount).fillBefore(c.HY.empty,!0);return e.copy(n.append(o))}function tn(e,t,n,o,i,r){let u=t<0?e.firstChild:e.lastChild,f=u.content;return e.childCount>1&&(r=0),i<o-1&&(f=tn(f,t,n,o,i+1,r)),i>=n&&(f=t<0?u.contentMatchAt(0).fillBefore(f,r<=i).append(f):f.append(u.contentMatchAt(u.childCount).fillBefore(c.HY.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,u.copy(f))}function Ge(e,t,n){return t<e.openStart&&(e=new c.p2(tn(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new c.p2(tn(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const he={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Xe=null;function Mn(){return Xe||(Xe=document.implementation.createHTMLDocument("title"))}const Re={},We={},kn={touchstart:!0,touchmove:!0};class An{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Ve(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function rn(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=o=>pn(e,o))})}function pn(e,t){return e.someProp("handleDOMEvents",n=>{let o=n[t.type];return!!o&&(o(e,t)||t.defaultPrevented)})}function Cn(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function fn(e){return{left:e.clientX,top:e.clientY}}function jn(e,t,n,o,i){if(-1==o)return!1;let r=e.state.doc.resolve(o);for(let u=r.depth+1;u>0;u--)if(e.someProp(t,f=>u>r.depth?f(e,n,r.nodeAfter,r.before(u),i,!0):f(e,n,r.node(u),r.before(u),i,!1)))return!0;return!1}function In(e,t,n){e.focused||e.focus();let o=e.state.tr.setSelection(t);"pointer"==n&&o.setMeta("pointer",!0),e.dispatch(o)}function Un(e,t,n,o){return jn(e,"handleDoubleClickOn",t,n,o)||e.someProp("handleDoubleClick",i=>i(e,t,o))}function ko(e,t,n,o){return jn(e,"handleTripleClickOn",t,n,o)||e.someProp("handleTripleClick",i=>i(e,t,o))||function(e,t,n){if(0!=n.button)return!1;let o=e.state.doc;if(-1==t)return!!o.inlineContent&&(In(e,s.Bs.create(o,0,o.content.size),"pointer"),!0);let i=o.resolve(t);for(let r=i.depth+1;r>0;r--){let u=r>i.depth?i.nodeAfter:i.node(r),f=i.before(r);if(u.inlineContent)In(e,s.Bs.create(o,f+1,f+1+u.content.size),"pointer");else{if(!s.qv.isSelectable(u))continue;In(e,s.qv.create(o,f),"pointer")}return!0}}(e,n,o)}function Ln(e){return Bn(e)}We.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!Qn(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!Mt||!At||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!P||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",o=>o(e,n))||function(e,t){let n=t.keyCode,o=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||H&&72==n&&"c"==o)return gt(e,-1)||h(e,-1);if(46==n&&!t.shiftKey||H&&68==n&&"c"==o)return gt(e,1)||h(e,1);if(13==n||27==n)return!0;if(37==n||H&&66==n&&"c"==o){let i=37==n?"ltr"==L(e,e.state.selection.from)?-1:1:-1;return g(e,i,o)||h(e,i)}if(39==n||H&&70==n&&"c"==o){let i=39==n?"ltr"==L(e,e.state.selection.from)?1:-1:1;return g(e,i,o)||h(e,i)}return 38==n||H&&80==n&&"c"==o?G(e,-1,o)||h(e,-1):40==n||H&&78==n&&"c"==o?function(e){if(!X||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;Tt(e,o,"true"),setTimeout(()=>Tt(e,o,"false"),20)}return!1}(e)||G(e,1,o)||E(e):o==(H?"m":"c")&&(66==n||73==n||89==n||90==n)}(e,n)?n.preventDefault():Ve(e,"key");else{let o=Date.now();e.input.lastIOSEnter=o,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==o&&(e.someProp("handleKeyDown",i=>i(e,st(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},We.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},We.keypress=(e,t)=>{let n=t;if(Qn(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||H&&n.metaKey)return;if(e.someProp("handleKeyPress",i=>i(e,n)))return void n.preventDefault();let o=e.state.selection;if(!(o instanceof s.Bs&&o.$from.sameParent(o.$to))){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!e.someProp("handleTextInput",r=>r(e,o.$from.pos,o.$to.pos,i))&&e.dispatch(e.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};const lo=H?"metaKey":"ctrlKey";Re.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let o=Ln(e),i=Date.now(),r="singleClick";i-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,o=t.y-e.clientY;return n*n+o*o<100}(n,e.input.lastClick)&&!n[lo]&&("singleClick"==e.input.lastClick.type?r="doubleClick":"doubleClick"==e.input.lastClick.type&&(r="tripleClick")),e.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:r};let u=e.posAtCoords(fn(n));!u||("singleClick"==r?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Vn(e,u,n,!!o)):("doubleClick"==r?Un:ko)(e,u.pos,u.inside,n)?n.preventDefault():Ve(e,"pointer"))};class Vn{constructor(t,n,o,i){let r,u;if(this.view=t,this.pos=n,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[lo],this.allowDefault=o.shiftKey,n.inside>-1)r=t.state.doc.nodeAt(n.inside),u=n.inside;else{let A=t.state.doc.resolve(n.pos);r=A.parent,u=A.depth?A.before():0}const f=i?null:o.target,C=f?t.docView.nearestDesc(f,!0):null;this.target=C?C.dom:null;let{selection:k}=t.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||k instanceof s.qv&&k.from<=u&&k.to>u)&&(this.mightDrag={node:r,pos:u,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Zt||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ve(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Be(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(fn(t))),this.updateAllowDefault(t),this.allowDefault||!n?Ve(this.view,"pointer"):function(e,t,n,o,i){return jn(e,"handleClickOn",t,n,o)||e.someProp("handleClick",r=>r(e,t,o))||(i?function(e,t){if(-1==t)return!1;let o,i,n=e.state.selection;n instanceof s.qv&&(o=n.node);let r=e.state.doc.resolve(t);for(let u=r.depth+1;u>0;u--){let f=u>r.depth?r.nodeAfter:r.node(u);if(s.qv.isSelectable(f)){i=o&&n.$from.depth>0&&u>=n.$from.depth&&r.before(n.$from.depth+1)==n.$from.pos?r.before(n.$from.depth):r.before(u);break}}return null!=i&&(In(e,s.qv.create(e.state.doc,i),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),o=n.nodeAfter;return!!(o&&o.isAtom&&s.qv.isSelectable(o))&&(In(e,new s.qv(n),"pointer"),!0)}(e,n))}(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||X&&this.mightDrag&&!this.mightDrag.node.isAtom||At&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(In(this.view,s.Y1.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):Ve(this.view,"pointer")}move(t){this.updateAllowDefault(t),Ve(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function Qn(e,t){return!!e.composing||!!(X&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}Re.touchstart=e=>{e.input.lastTouch=Date.now(),Ln(e),Ve(e,"pointer")},Re.touchmove=e=>{e.input.lastTouch=Date.now(),Ve(e,"pointer")},Re.contextmenu=e=>Ln(e);const ao=Mt?5e3:-1;function Gn(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Bn(e),t))}function co(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Bn(e,t=!1){if(!(Mt&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),co(e),t||e.docView&&e.docView.dirty){let n=_e(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}}We.compositionstart=We.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),Bn(e,!0),e.markCursor=null;else if(Bn(e),Zt&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let o=e.domSelectionRange();for(let i=o.focusNode,r=o.focusOffset;i&&1==i.nodeType&&0!=r;){let u=r<0?i.lastChild:i.childNodes[r-1];if(!u)break;if(3==u.nodeType){e.domSelection().collapse(u,u.nodeValue.length);break}i=u,r=-1}}e.input.composing=!0}Gn(e,ao)},We.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionID++,Gn(e,20))};const ln=Rt&&Yt<15||P&&Kt<604;function xn(e,t,n,o,i){let r=ie(e,t,n,o,e.state.selection.$from);if(e.someProp("handlePaste",C=>C(e,i,r||c.p2.empty)))return!0;if(!r)return!1;let u=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(r),f=u?e.state.tr.replaceSelectionWith(u,o):e.state.tr.replaceSelection(r);return e.dispatch(f.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Re.copy=We.cut=(e,t)=>{let n=t,o=e.state.selection,i="cut"==n.type;if(o.empty)return;let r=ln?null:n.clipboardData,u=o.content(),{dom:f,text:C}=le(e,u);r?(n.preventDefault(),r.clearData(),r.setData("text/html",f.innerHTML),r.setData("text/plain",C)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,f),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},We.paste=(e,t)=>{let n=t;if(e.composing&&!Mt)return;let o=ln?null:n.clipboardData,i=e.input.shiftKey&&45!=e.input.lastKeyCode;o&&xn(e,o.getData("text/plain"),o.getData("text/html"),i,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,o=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),o.parentNode&&o.parentNode.removeChild(o),n?xn(e,o.value,null,i,t):xn(e,o.textContent,o.innerHTML,i,t)},50)}(e,n)};class po{constructor(t,n){this.slice=t,this.move=n}}const fo=H?"altKey":"ctrlKey";Re.dragstart=(e,t)=>{let n=t,o=e.input.mouseDown;if(o&&o.done(),!n.dataTransfer)return;let i=e.state.selection,r=i.empty?null:e.posAtCoords(fn(n));if(!(r&&r.pos>=i.from&&r.pos<=(i instanceof s.qv?i.to-1:i.to)))if(o&&o.mightDrag)e.dispatch(e.state.tr.setSelection(s.qv.create(e.state.doc,o.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let k=e.docView.nearestDesc(n.target,!0);k&&k.node.type.spec.draggable&&k!=e.docView&&e.dispatch(e.state.tr.setSelection(s.qv.create(e.state.doc,k.posBefore)))}let u=e.state.selection.content(),{dom:f,text:C}=le(e,u);n.dataTransfer.clearData(),n.dataTransfer.setData(ln?"Text":"text/html",f.innerHTML),n.dataTransfer.effectAllowed="copyMove",ln||n.dataTransfer.setData("text/plain",C),e.dragging=new po(u,!n[fo])},Re.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},We.dragover=We.dragenter=(e,t)=>t.preventDefault(),We.drop=(e,t)=>{let n=t,o=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let i=e.posAtCoords(fn(n));if(!i)return;let r=e.state.doc.resolve(i.pos),u=o&&o.slice;u?e.someProp("transformPasted",_t=>{u=_t(u,e)}):u=ie(e,n.dataTransfer.getData(ln?"Text":"text/plain"),ln?null:n.dataTransfer.getData("text/html"),!1,r);let f=!(!o||n[fo]);if(e.someProp("handleDrop",_t=>_t(e,n,u||c.p2.empty,f)))return void n.preventDefault();if(!u)return;n.preventDefault();let C=u?(0,$.nj)(e.state.doc,r.pos,u):r.pos;null==C&&(C=r.pos);let k=e.state.tr;f&&k.deleteSelection();let A=k.mapping.map(C),U=0==u.openStart&&0==u.openEnd&&1==u.content.childCount,it=k.doc;if(U?k.replaceRangeWith(A,A,u.content.firstChild):k.replaceRange(A,A,u),k.doc.eq(it))return;let ct=k.doc.resolve(A);if(U&&s.qv.isSelectable(u.content.firstChild)&&ct.nodeAfter&&ct.nodeAfter.sameMarkup(u.content.firstChild))k.setSelection(new s.qv(ct));else{let _t=k.mapping.map(C);k.mapping.maps[k.mapping.maps.length-1].forEach((Bt,$t,de,Se)=>_t=Se),k.setSelection(cn(e,ct,k.doc.resolve(_t)))}e.focus(),e.dispatch(k.setMeta("uiEvent","drop"))},Re.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Be(e)},20))},Re.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},Re.beforeinput=(e,t)=>{if(At&&Mt&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:o}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=o||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",r=>r(e,st(8,"Backspace")))))return;let{$cursor:i}=e.state.selection;i&&i.pos>0&&e.dispatch(e.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let e in We)Re[e]=We[e];function Hn(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class qn{constructor(t,n){this.toDOM=t,this.spec=n||En,this.side=this.spec.side||0}map(t,n,o,i){let{pos:r,deleted:u}=t.mapResult(n.from+i,this.side<0?-1:1);return u?null:new en(r-o,r-o,this)}valid(){return!0}eq(t){return this==t||t instanceof qn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Hn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class vn{constructor(t,n){this.attrs=t,this.spec=n||En}map(t,n,o,i){let r=t.map(n.from+i,this.spec.inclusiveStart?-1:1)-o,u=t.map(n.to+i,this.spec.inclusiveEnd?1:-1)-o;return r>=u?null:new en(r,u,this)}valid(t,n){return n.from<n.to}eq(t){return this==t||t instanceof vn&&Hn(this.attrs,t.attrs)&&Hn(this.spec,t.spec)}static is(t){return t.type instanceof vn}destroy(){}}class to{constructor(t,n){this.attrs=t,this.spec=n||En}map(t,n,o,i){let r=t.mapResult(n.from+i,1);if(r.deleted)return null;let u=t.mapResult(n.to+i,-1);return u.deleted||u.pos<=r.pos?null:new en(r.pos-o,u.pos-o,this)}valid(t,n){let r,{index:o,offset:i}=t.content.findIndex(n.from);return i==n.from&&!(r=t.child(o)).isText&&i+r.nodeSize==n.to}eq(t){return this==t||t instanceof to&&Hn(this.attrs,t.attrs)&&Hn(this.spec,t.spec)}destroy(){}}class en{constructor(t,n,o){this.from=t,this.to=n,this.type=o}copy(t,n){return new en(t,n,this.type)}eq(t,n=0){return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}map(t,n,o){return this.type.map(t,this,n,o)}static widget(t,n,o){return new en(t,t,new qn(n,o))}static inline(t,n,o,i){return new en(t,n,new vn(o,i))}static node(t,n,o,i){return new en(t,n,new to(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof vn}}const Dn=[],En={};class Je{constructor(t,n){this.local=t.length?t:Dn,this.children=n.length?n:Dn}static create(t,n){return n.length?no(n,t,0,En):Ye}find(t,n,o){let i=[];return this.findInner(null==t?0:t,null==n?1e9:n,i,0,o),i}findInner(t,n,o,i,r){for(let u=0;u<this.local.length;u++){let f=this.local[u];f.from<=n&&f.to>=t&&(!r||r(f.spec))&&o.push(f.copy(f.from+i,f.to+i))}for(let u=0;u<this.children.length;u+=3)if(this.children[u]<n&&this.children[u+1]>t){let f=this.children[u]+1;this.children[u+2].findInner(t-f,n-f,o,i+f,r)}}map(t,n,o){return this==Ye||0==t.maps.length?this:this.mapInner(t,n,0,0,o||En)}mapInner(t,n,o,i,r){let u;for(let f=0;f<this.local.length;f++){let C=this.local[f].map(t,o,i);C&&C.type.valid(n,C)?(u||(u=[])).push(C):r.onRemove&&r.onRemove(this.local[f].spec)}return this.children.length?function(e,t,n,o,i,r,u){let f=e.slice();for(let k=0,A=r;k<n.maps.length;k++){let U=0;n.maps[k].forEach((it,ct,_t,Bt)=>{let $t=Bt-_t-(ct-it);for(let de=0;de<f.length;de+=3){let Se=f[de+1];if(Se<0||it>Se+A-U)continue;let He=f[de]+A-U;ct>=He?f[de+1]=it<=He?-2:-1:_t>=i&&$t&&(f[de]+=$t,f[de+1]+=$t)}U+=$t}),A=n.maps[k].map(A,-1)}let C=!1;for(let k=0;k<f.length;k+=3)if(f[k+1]<0){if(-2==f[k+1]){C=!0,f[k+1]=-1;continue}let A=n.map(e[k]+r),U=A-i;if(U<0||U>=o.content.size){C=!0;continue}let ct=n.map(e[k+1]+r,-1)-i,{index:_t,offset:Bt}=o.content.findIndex(U),$t=o.maybeChild(_t);if($t&&Bt==U&&Bt+$t.nodeSize==ct){let de=f[k+2].mapInner(n,$t,A+1,e[k]+r+1,u);de!=Ye?(f[k]=U,f[k+1]=ct,f[k+2]=de):(f[k+1]=-2,C=!0)}else C=!0}if(C){let k=function(e,t,n,o,i,r,u){function f(C,k){for(let A=0;A<C.local.length;A++){let U=C.local[A].map(o,i,k);U?n.push(U):u.onRemove&&u.onRemove(C.local[A].spec)}for(let A=0;A<C.children.length;A+=3)f(C.children[A+2],C.children[A]+k+1)}for(let C=0;C<e.length;C+=3)-1==e[C+1]&&f(e[C+2],t[C]+r+1);return n}(f,e,t,n,i,r,u),A=no(k,o,0,u);t=A.local;for(let U=0;U<f.length;U+=3)f[U+1]<0&&(f.splice(U,3),U-=3);for(let U=0,it=0;U<A.children.length;U+=3){let ct=A.children[U];for(;it<f.length&&f[it]<ct;)it+=3;f.splice(it,0,A.children[U],A.children[U+1],A.children[U+2])}}return new Je(t.sort(wn),f)}(this.children,u||[],t,n,o,i,r):u?new Je(u.sort(wn),Dn):Ye}add(t,n){return n.length?this==Ye?Je.create(t,n):this.addInner(t,n,0):this}addInner(t,n,o){let i,r=0;t.forEach((f,C)=>{let A,k=C+o;if(A=Do(n,f,k)){for(i||(i=this.children.slice());r<i.length&&i[r]<C;)r+=3;i[r]==C?i[r+2]=i[r+2].addInner(f,A,k+1):i.splice(r,0,C,C+f.nodeSize,no(A,f,k+1,En)),r+=3}});let u=Jn(r?wo(n):n,-o);for(let f=0;f<u.length;f++)u[f].type.valid(t,u[f])||u.splice(f--,1);return new Je(u.length?this.local.concat(u).sort(wn):this.local,i||this.children)}remove(t){return 0==t.length||this==Ye?this:this.removeInner(t,0)}removeInner(t,n){let o=this.children,i=this.local;for(let r=0;r<o.length;r+=3){let u,f=o[r]+n,C=o[r+1]+n;for(let U,A=0;A<t.length;A++)(U=t[A])&&U.from>f&&U.to<C&&(t[A]=null,(u||(u=[])).push(U));if(!u)continue;o==this.children&&(o=this.children.slice());let k=o[r+2].removeInner(u,f+1);k!=Ye?o[r+2]=k:(o.splice(r,3),r-=3)}if(i.length)for(let u,r=0;r<t.length;r++)if(u=t[r])for(let f=0;f<i.length;f++)i[f].eq(u,n)&&(i==this.local&&(i=this.local.slice()),i.splice(f--,1));return o==this.children&&i==this.local?this:i.length||o.length?new Je(i,o):Ye}forChild(t,n){if(this==Ye)return this;if(n.isLeaf)return Je.empty;let o,i;for(let f=0;f<this.children.length;f+=3)if(this.children[f]>=t){this.children[f]==t&&(o=this.children[f+2]);break}let r=t+1,u=r+n.content.size;for(let f=0;f<this.local.length;f++){let C=this.local[f];if(C.from<u&&C.to>r&&C.type instanceof vn){let k=Math.max(r,C.from)-r,A=Math.min(u,C.to)-r;k<A&&(i||(i=[])).push(C.copy(k,A))}}if(i){let f=new Je(i.sort(wn),Dn);return o?new yn([f,o]):f}return o||Ye}eq(t){if(this==t)return!0;if(!(t instanceof Je)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0}locals(t){return ho(this.localsInner(t))}localsInner(t){if(this==Ye)return Dn;if(t.inlineContent||!this.local.some(vn.is))return this.local;let n=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof vn||n.push(this.local[o]);return n}}Je.empty=new Je([],[]),Je.removeOverlap=ho;const Ye=Je.empty;class yn{constructor(t){this.members=t}map(t,n){const o=this.members.map(i=>i.map(t,n,En));return yn.from(o)}forChild(t,n){if(n.isLeaf)return Je.empty;let o=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,n);r!=Ye&&(r instanceof yn?o=o.concat(r.members):o.push(r))}return yn.from(o)}eq(t){if(!(t instanceof yn)||t.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}locals(t){let n,o=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(n){o&&(n=n.slice(),o=!1);for(let u=0;u<r.length;u++)n.push(r[u])}else n=r}return n?ho(o?n:n.sort(wn)):Dn}static from(t){switch(t.length){case 0:return Ye;case 1:return t[0];default:return new yn(t.every(n=>n instanceof Je)?t:t.reduce((n,o)=>n.concat(o instanceof Je?o:o.members),[]))}}}function Jn(e,t){if(!t||!e.length)return e;let n=[];for(let o=0;o<e.length;o++){let i=e[o];n.push(new en(i.from+t,i.to+t,i.type))}return n}function Do(e,t,n){if(t.isLeaf)return null;let o=n+t.nodeSize,i=null;for(let u,r=0;r<e.length;r++)(u=e[r])&&u.from>n&&u.to<o&&((i||(i=[])).push(u),e[r]=null);return i}function wo(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function no(e,t,n,o){let i=[],r=!1;t.forEach((f,C)=>{let k=Do(e,f,C+n);if(k){r=!0;let A=no(k,f,n+C+1,o);A!=Ye&&i.push(C,C+f.nodeSize,A)}});let u=Jn(r?wo(e):e,-n).sort(wn);for(let f=0;f<u.length;f++)u[f].type.valid(t,u[f])||(o.onRemove&&o.onRemove(u[f].spec),u.splice(f--,1));return u.length||i.length?new Je(u,i):Ye}function wn(e,t){return e.from-t.from||e.to-t.to}function ho(e){let t=e;for(let n=0;n<t.length-1;n++){let o=t[n];if(o.from!=o.to)for(let i=n+1;i<t.length;i++){let r=t[i];if(r.from!=o.from){r.from<o.to&&(t==e&&(t=e.slice()),t[n]=o.copy(o.from,r.from),Po(t,i,o.copy(r.from,o.to)));break}r.to!=o.to&&(t==e&&(t=e.slice()),t[i]=r.copy(r.from,o.to),Po(t,i+1,r.copy(o.to,r.to)))}}return t}function Po(e,t,n){for(;t<e.length&&wn(n,e[t])>0;)t++;e.splice(t,0,n)}function mo(e){let t=[];return e.someProp("decorations",n=>{let o=n(e.state);o&&o!=Ye&&t.push(o)}),e.cursorWrapper&&t.push(Je.create(e.state.doc,[e.cursorWrapper.deco])),yn.from(t)}const Ko={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Zo=Rt&&Yt<=11;class jo{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class No{constructor(t,n){this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new jo,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let i=0;i<o.length;i++)this.queue.push(o[i]);Rt&&Yt<=11&&o.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Zo&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ko)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(bn(this.view)){if(this.suppressingSelectionUpdates)return Be(this.view);if(Rt&&Yt<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&nt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let o,n=new Set;for(let r=t.focusNode;r;r=_(r))n.add(r);for(let r=t.anchorNode;r;r=_(r))if(n.has(r)){o=r;break}let i=o&&this.view.docView.nearestDesc(o);return i&&i.ignoreMutation({type:"selection",target:3==o.nodeType?o.parentNode:o})?(this.setCurSelection(),!0):void 0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.observer?this.observer.takeRecords():[];this.queue.length&&(n=this.queue.concat(n),this.queue.length=0);let o=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(o)&&bn(t)&&!this.ignoreSelectionChange(o),r=-1,u=-1,f=!1,C=[];if(t.editable)for(let A=0;A<n.length;A++){let U=this.registerMutation(n[A],C);U&&(r=r<0?U.from:Math.min(U.from,r),u=u<0?U.to:Math.max(U.to,u),U.typeOver&&(f=!0))}if(Zt&&C.length>1){let A=C.filter(U=>"BR"==U.nodeName);if(2==A.length){let U=A[0],it=A[1];U.parentNode&&U.parentNode.parentNode==it.parentNode?it.remove():U.remove()}}let k=null;r<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&ft(o)&&(k=_e(t))&&k.eq(s.Y1.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Be(t),this.currentSelection.set(o),t.scrollToSelection()):(r>-1||i)&&(r>-1&&(t.docView.markDirty(r,u),function(e){if(!go.has(e)&&(go.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))){if(e.requiresGeckoHackNode=Zt,_o)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),_o=!0}}(t)),this.handleDOMChange(r,u,f,C),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(o)||Be(t),this.currentSelection.set(o))}registerMutation(t,n){if(n.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let A=0;A<t.addedNodes.length;A++)n.push(t.addedNodes[A]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let i=t.previousSibling,r=t.nextSibling;if(Rt&&Yt<=11&&t.addedNodes.length)for(let A=0;A<t.addedNodes.length;A++){let{previousSibling:U,nextSibling:it}=t.addedNodes[A];(!U||Array.prototype.indexOf.call(t.addedNodes,U)<0)&&(i=U),(!it||Array.prototype.indexOf.call(t.addedNodes,it)<0)&&(r=it)}let u=i&&i.parentNode==t.target?I(i)+1:0,f=o.localPosFromDOM(t.target,u,-1),C=r&&r.parentNode==t.target?I(r):t.target.childNodes.length;return{from:f,to:o.localPosFromDOM(t.target,C,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let go=new WeakMap,_o=!1;function Co(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(X&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||X&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Ho=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function yo(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:cn(e,t.resolve(n.anchor),t.resolve(n.head))}function oo(e,t,n){let o=e.depth,i=t?e.end():e.pos;for(;o>0&&(t||e.indexAfter(o)==e.node(o).childCount);)o--,i++,t=!1;if(n){let r=e.node(o).maybeChild(e.indexAfter(o));for(;r&&!r.isLeaf;)r=r.firstChild,i++}return i}class Wo{constructor(t,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new An,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(p),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Mo(this),bo(this),this.nodeViews=xo(this),this.docView=O(this.state.doc,To(this),mo(this),this.dom,this),this.domObserver=new No(this,(o,i,r,u)=>function(e,t,n,o,i){if(t<0){let ve=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,Nn=_e(e,ve);if(Nn&&!e.state.selection.eq(Nn)){if(At&&Mt&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",qo=>qo(e,st(13,"Enter"))))return;let Eo=e.state.tr.setSelection(Nn);"pointer"==ve?Eo.setMeta("pointer",!0):"key"==ve&&Eo.scrollIntoView(),e.composing&&Eo.setMeta("composition",e.input.compositionID),e.dispatch(Eo)}return}let r=e.state.doc.resolve(t),u=r.sharedDepth(n);t=r.before(u+1),n=e.state.doc.resolve(n).after(u+1);let U,it,f=e.state.selection,C=function(e,t,n){let k,{node:o,fromOffset:i,toOffset:r,from:u,to:f}=e.docView.parseRange(t,n),C=e.domSelectionRange(),A=C.anchorNode;if(A&&e.dom.contains(1==A.nodeType?A:A.parentNode)&&(k=[{node:A,offset:C.anchorOffset}],ft(C)||k.push({node:C.focusNode,offset:C.focusOffset})),At&&8===e.input.lastKeyCode)for(let $t=r;$t>i;$t--){let de=o.childNodes[$t-1],Se=de.pmViewDesc;if("BR"==de.nodeName&&!Se){r=$t;break}if(!Se||Se.size)break}let U=e.state.doc,it=e.someProp("domParser")||c.aw.fromSchema(e.state.schema),ct=U.resolve(u),_t=null,Bt=it.parse(o,{topNode:ct.parent,topMatch:ct.parent.contentMatchAt(ct.index()),topOpen:!0,from:i,to:r,preserveWhitespace:"pre"!=ct.parent.type.whitespace||"full",findPositions:k,ruleFromNode:Co,context:ct});if(k&&null!=k[0].pos){let $t=k[0].pos,de=k[1]&&k[1].pos;null==de&&(de=$t),_t={anchor:$t+u,head:de+u}}return{doc:Bt,sel:_t,from:u,to:f}}(e,t,n),k=e.state.doc,A=k.slice(C.from,C.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(U=e.state.selection.to,it="end"):(U=e.state.selection.from,it="start"),e.input.lastKeyCode=null;let ct=function(e,t,n,o,i){let r=e.findDiffStart(t,n);if(null==r)return null;let{a:u,b:f}=e.findDiffEnd(t,n+e.size,n+t.size);return"end"==i&&(o-=u+Math.max(0,r-Math.min(u,f))-r),u<r&&e.size<t.size?(r-=o<=r&&o>=u?r-o:0,f=r+(f-u),u=r):f<r&&(r-=o<=r&&o>=f?r-o:0,u=r+(u-f),f=r),{start:r,endA:u,endB:f}}(A.content,C.doc.content,C.from,U,it);if((P&&e.input.lastIOSEnter>Date.now()-225||Mt)&&i.some(ve=>1==ve.nodeType&&!Ho.test(ve.nodeName))&&(!ct||ct.endA>=ct.endB)&&e.someProp("handleKeyDown",ve=>ve(e,st(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!ct){if(!(o&&f instanceof s.Bs&&!f.empty&&f.$head.sameParent(f.$anchor))||e.composing||C.sel&&C.sel.anchor!=C.sel.head){if(C.sel){let ve=yo(e,e.state.doc,C.sel);if(ve&&!ve.eq(e.state.selection)){let Nn=e.state.tr.setSelection(ve);e.composing&&Nn.setMeta("composition",e.input.compositionID),e.dispatch(Nn)}}return}ct={start:f.from,endA:f.to,endB:f.to}}if(At&&e.cursorWrapper&&C.sel&&C.sel.anchor==e.cursorWrapper.deco.from&&C.sel.head==C.sel.anchor){let ve=ct.endB-ct.start;C.sel={anchor:C.sel.anchor+ve,head:C.sel.anchor+ve}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&ct.start==ct.endB&&e.state.selection instanceof s.Bs&&(ct.start>e.state.selection.from&&ct.start<=e.state.selection.from+2&&e.state.selection.from>=C.from?ct.start=e.state.selection.from:ct.endA<e.state.selection.to&&ct.endA>=e.state.selection.to-2&&e.state.selection.to<=C.to&&(ct.endB+=e.state.selection.to-ct.endA,ct.endA=e.state.selection.to)),Rt&&Yt<=11&&ct.endB==ct.start+1&&ct.endA==ct.start&&ct.start>C.from&&" \xa0"==C.doc.textBetween(ct.start-C.from-1,ct.start-C.from+1)&&(ct.start--,ct.endA--,ct.endB--);let Se,_t=C.doc.resolveNoCache(ct.start-C.from),Bt=C.doc.resolveNoCache(ct.endB-C.from),$t=k.resolve(ct.start),de=_t.sameParent(Bt)&&_t.parent.inlineContent&&$t.end()>=ct.endA;if((P&&e.input.lastIOSEnter>Date.now()-225&&(!de||i.some(ve=>"DIV"==ve.nodeName||"P"==ve.nodeName))||!de&&_t.pos<C.doc.content.size&&!_t.sameParent(Bt)&&(Se=s.Y1.findFrom(C.doc.resolve(_t.pos+1),1,!0))&&Se.head==Bt.pos)&&e.someProp("handleKeyDown",ve=>ve(e,st(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>ct.start&&function(e,t,n,o,i){if(!o.parent.isTextblock||n-t<=i.pos-o.pos||oo(o,!0,!1)<i.pos)return!1;let r=e.resolve(t);if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let u=e.resolve(oo(r,!0,!0));return!(!u.parent.isTextblock||u.pos>n||oo(u,!0,!1)<n)&&o.parent.content.cut(o.parentOffset).eq(u.parent.content)}(k,ct.start,ct.endA,_t,Bt)&&e.someProp("handleKeyDown",ve=>ve(e,st(8,"Backspace"))))return void(Mt&&At&&e.domObserver.suppressSelectionUpdates());At&&Mt&&ct.endB==ct.start&&(e.input.lastAndroidDelete=Date.now()),Mt&&!de&&_t.start()!=Bt.start()&&0==Bt.parentOffset&&_t.depth==Bt.depth&&C.sel&&C.sel.anchor==C.sel.head&&C.sel.head==ct.endA&&(ct.endB-=2,Bt=C.doc.resolveNoCache(ct.endB-C.from),setTimeout(()=>{e.someProp("handleKeyDown",function(ve){return ve(e,st(13,"Enter"))})},20));let ze,an,Pn,He=ct.start,$e=ct.endA;if(de)if(_t.pos==Bt.pos)Rt&&Yt<=11&&0==_t.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Be(e),20)),ze=e.state.tr.delete(He,$e),an=k.resolve(ct.start).marksAcross(k.resolve(ct.endA));else if(ct.endA==ct.endB&&(Pn=function(e,t){let u,f,C,n=e.firstChild.marks,o=t.firstChild.marks,i=n,r=o;for(let A=0;A<o.length;A++)i=o[A].removeFromSet(i);for(let A=0;A<n.length;A++)r=n[A].removeFromSet(r);if(1==i.length&&0==r.length)f=i[0],u="add",C=A=>A.mark(f.addToSet(A.marks));else{if(0!=i.length||1!=r.length)return null;f=r[0],u="remove",C=A=>A.mark(f.removeFromSet(A.marks))}let k=[];for(let A=0;A<t.childCount;A++)k.push(C(t.child(A)));if(c.HY.from(k).eq(e))return{mark:f,type:u}}(_t.parent.content.cut(_t.parentOffset,Bt.parentOffset),$t.parent.content.cut($t.parentOffset,ct.endA-$t.start()))))ze=e.state.tr,"add"==Pn.type?ze.addMark(He,$e,Pn.mark):ze.removeMark(He,$e,Pn.mark);else if(_t.parent.child(_t.index()).isText&&_t.index()==Bt.index()-(Bt.textOffset?0:1)){let ve=_t.parent.textBetween(_t.parentOffset,Bt.parentOffset);if(e.someProp("handleTextInput",Nn=>Nn(e,He,$e,ve)))return;ze=e.state.tr.insertText(ve,He,$e)}if(ze||(ze=e.state.tr.replace(He,$e,C.doc.slice(ct.start-C.from,ct.endB-C.from))),C.sel){let ve=yo(e,ze.doc,C.sel);ve&&!(At&&Mt&&e.composing&&ve.empty&&(ct.start!=ct.endB||e.input.lastAndroidDelete<Date.now()-100)&&(ve.head==He||ve.head==ze.mapping.map($e)-1)||Rt&&ve.empty&&ve.head==He)&&ze.setSelection(ve)}an&&ze.ensureMarks(an),e.composing&&ze.setMeta("composition",e.input.compositionID),e.dispatch(ze.scrollIntoView())}(this,o,i,r,u)),this.domObserver.start(),function(e){for(let t in Re){let n=Re[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=o=>{Cn(e,o)&&!pn(e,o)&&(e.editable||!(o.type in We))&&n(e,o)},kn[t]?{passive:!0}:void 0)}X&&e.dom.addEventListener("input",()=>null),rn(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&rn(this);let n=this._props;this._props=t,t.plugins&&(t.plugins.forEach(p),this.directPlugins=t.plugins),this.updateStateInner(t.state,n)}setProps(t){let n={};for(let o in this._props)n[o]=this._props[o];n.state=this.state;for(let o in t)n[o]=t[o];this.update(n)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,n){let o=this.state,i=!1,r=!1;t.storedMarks&&this.composing&&(co(this),r=!0),this.state=t;let u=o.plugins!=t.plugins||this._props.plugins!=n.plugins;if(u||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let it=xo(this);(function(e,t){let n=0,o=0;for(let i in e){if(e[i]!=t[i])return!0;n++}for(let i in t)o++;return n!=o})(it,this.nodeViews)&&(this.nodeViews=it,i=!0)}(u||n.handleDOMEvents!=this._props.handleDOMEvents)&&rn(this),this.editable=Mo(this),bo(this);let f=mo(this),C=To(this),k=o.plugins==t.plugins||o.doc.eq(t.doc)?t.scrollToSelection>o.scrollToSelection?"to selection":"preserve":"reset",A=i||!this.docView.matchesNode(t.doc,C,f);(A||!t.selection.eq(o.selection))&&(r=!0);let U="preserve"==k&&r&&null==this.dom.style.overflowAnchor&&function(e){let o,i,t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top);for(let r=(t.left+t.right)/2,u=n+1;u<Math.min(innerHeight,t.bottom);u+=5){let f=e.root.elementFromPoint(r,u);if(!f||f==e.dom||!e.dom.contains(f))continue;let C=f.getBoundingClientRect();if(C.top>=n-20){o=f,i=C.top;break}}return{refDOM:o,refTop:i,stack:Ut(e.dom)}}(this);if(r){this.domObserver.stop();let it=A&&(Rt||At)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(o.selection,t.selection);if(A){let ct=At?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(t.doc,C,f,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=O(t.doc,C,f,this.dom,this)),ct&&!this.trackWrites&&(it=!0)}it||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return nt(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?Be(this,it):(On(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),"reset"==k?this.dom.scrollTop=0:"to selection"==k?this.scrollToSelection():U&&function({refDOM:e,refTop:t,stack:n}){let o=e?e.getBoundingClientRect().top:0;fe(n,0==o?0:o-t)}(U)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof s.qv){let n=this.docView.domAfterPos(this.state.selection.from);1==n.nodeType&&rt(this,n.getBoundingClientRect(),t)}else rt(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let o=this.pluginViews[n];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let o=this.directPlugins[n];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let o=this.state.plugins[n];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,n){let i,o=this._props&&this._props[t];if(null!=o&&(i=n?n(o):o))return i;for(let u=0;u<this.directPlugins.length;u++){let f=this.directPlugins[u].props[t];if(null!=f&&(i=n?n(f):f))return i}let r=this.state.plugins;if(r)for(let u=0;u<r.length;u++){let f=r[u].props[t];if(null!=f&&(i=n?n(f):f))return i}}hasFocus(){if(Rt){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(ee)return e.focus(ee);let t=Ut(e);e.focus(null==ee?{get preventScroll(){return ee={preventScroll:!0},!0}}:void 0),ee||(ee=!1,fe(t,0))}(this.dom),Be(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return t||document}posAtCoords(t){return Ne(this,t)}coordsAtPos(t,n=1){return Fe(this,t,n)}domAtPos(t,n=0){return this.docView.domFromPos(t,n)}nodeDOM(t){let n=this.docView.descAt(t);return n?n.nodeDOM:null}posAtDOM(t,n,o=-1){let i=this.docView.posFromDOM(t,n,o);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,n){return function(e,t,n){return ht==t&&M==n?x:(ht=t,M=n,x="up"==n||"down"==n?function(e,t,n){let o=t.selection,i="up"==n?o.$from:o.$to;return Te(e,t,()=>{let{node:r}=e.docView.domFromPos(i.pos,"up"==n?-1:1);for(;;){let f=e.docView.nearestDesc(r,!0);if(!f)break;if(f.node.isBlock){r=f.contentDOM||f.dom;break}r=f.dom.parentNode}let u=Fe(e,i.pos,1);for(let f=r.firstChild;f;f=f.nextSibling){let C;if(1==f.nodeType)C=f.getClientRects();else{if(3!=f.nodeType)continue;C=F(f,0,f.nodeValue.length).getClientRects()}for(let k=0;k<C.length;k++){let A=C[k];if(A.bottom>A.top+1&&("up"==n?u.top-A.top>2*(A.bottom-u.top):A.bottom-u.bottom>2*(u.bottom-A.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let i=o.parentOffset,r=!i,u=i==o.parent.content.size,f=e.domSelection();return be.test(o.parent.textContent)&&f.modify?Te(e,t,()=>{let{focusNode:C,focusOffset:k,anchorNode:A,anchorOffset:U}=e.domSelectionRange(),it=f.caretBidiLevel;f.modify("move",n,"character");let ct=o.depth?e.docView.domAfterPos(o.before()):e.dom,{focusNode:_t,focusOffset:Bt}=e.domSelectionRange(),$t=_t&&!ct.contains(1==_t.nodeType?_t:_t.parentNode)||C==_t&&k==Bt;try{f.collapse(A,U),C&&(C!=A||k!=U)&&f.extend&&f.extend(C,k)}catch(de){}return null!=it&&(f.caretBidiLevel=it),$t}):"left"==n||"backward"==n?r:u}(e,t,n))}(this,n||this.state,t)}pasteHTML(t,n){return xn(this,"",t,!1,n||new ClipboardEvent("paste"))}pasteText(t,n){return xn(this,t,null,!0,n||new ClipboardEvent("paste"))}destroy(){!this.docView||(function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],mo(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(e,t){!pn(e,t)&&Re[t.type]&&(e.editable||!(t.type in We))&&Re[t.type](e,t)}(this,t)}dispatch(t){let n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return X&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function(e){let t;function n(C){C.preventDefault(),C.stopImmediatePropagation(),t=C.getTargetRanges()[0]}e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0);let o=t.startContainer,i=t.startOffset,r=t.endContainer,u=t.endOffset,f=e.domAtPos(e.state.selection.anchor);return nt(f.node,f.offset,r,u)&&([o,i,r,u]=[r,u,o,i]),{anchorNode:o,anchorOffset:i,focusNode:r,focusOffset:u}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function To(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let o in n)"class"==o?t.class+=" "+n[o]:"style"==o?t.style=(t.style?t.style+";":"")+n[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(n[o]))}),t.translate||(t.translate="no"),[en.node(0,e.state.doc.content.size,t)]}function bo(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:en.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Mo(e){return!e.someProp("editable",t=>!1===t(e.state))}function xo(e){let t=Object.create(null);function n(o){for(let i in o)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=o[i])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function p(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);