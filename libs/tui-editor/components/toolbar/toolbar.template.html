<button
    type="button"
    class="t-prevent-parent-label-behavior"
>
    <!-- @note: this is a html huck to avoid autofocus, if the parent element is a label  -->
</button>
<ng-container *ngIf="editor.stateChange$ | async"></ng-container>
<div
    [tuiFocusable]="focusable"
    (focus)="onTopFocus()"
></div>
<div
    [tuiFocusable]="focusable"
    (focus)="onBottomFocus()"
></div>
<!-- TODO: Change to `tuiHintDescribe` when figure tuiDriver order issue -->
<section
    *ngIf="texts$ | async as texts"
    tuiToolbarNavigationManager
    class="t-tools-wrapper"
>
    <div
        *ngIf="enabled(TuiEditorTool.Undo)"
        class="t-block"
    >
        <button
            appearance="icon"
            icon="tuiIconUndoLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [disabled]="undoDisabled"
            [focusable]="false"
            [tuiHint]="texts.undo"
            (click)="undo()"
        ></button>
        <button
            appearance="icon"
            icon="tuiIconRedoLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [disabled]="redoDisabled"
            [focusable]="false"
            [tuiHint]="texts.redo"
            (click)="redo()"
        ></button>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Size)"
        class="t-block"
    >
        <tui-font-size
            tuiItem
            class="t-tool t-wrapper"
        ></tui-font-size>
    </div>
    <div
        *ngIf="firstBigBlockEnabled"
        class="t-block"
    >
        <tui-font-style
            *ngIf="formatEnabled"
            tuiItem
            class="t-tool t-wrapper"
            [enabledTools]="toolsSet"
        ></tui-font-style>

        <tui-align-content
            *ngIf="enabled(TuiEditorTool.Align)"
            tuiItem
            class="t-tool t-wrapper"
        ></tui-align-content>

        <tui-list-configs
            *ngIf="enabled(TuiEditorTool.List)"
            tuiItem
            class="t-tool t-wrapper"
        ></tui-list-configs>

        <button
            *ngIf="enabled(TuiEditorTool.Quote)"
            #button
            appearance="icon"
            icon="tuiIconQuoteLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [disabled]="unorderedList || orderedList"
            [focusable]="false"
            [pseudoActive]="blockquote"
            [tuiHint]="texts.quote"
            (click)="toggleQuote()"
        ></button>
        <tui-hosted-dropdown
            *ngIf="enabled(TuiEditorTool.Link)"
            #link
            tuiItem
            class="t-wrapper"
            [canOpen]="canOpenAnchor"
            [content]="linkDropdown"
        >
            <button
                #button
                appearance="icon"
                icon="tuiIconLinkLarge"
                size="s"
                tuiHintDescribe
                tuiHintDirection="top-left"
                tuiIconButton
                type="button"
                class="t-tool"
                [focusable]="link.open"
                [pseudoActive]="link.open || a"
                [tuiHint]="texts.link"
            ></button>
            <ng-template #linkDropdown>
                <tui-edit-link
                    #dropdown
                    (addLink)="onLink(link, $event)"
                    (removeLink)="onLink(link)"
                ></tui-edit-link>
            </ng-template>
        </tui-hosted-dropdown>
        <tui-hosted-dropdown
            *ngIf="enabled(TuiEditorTool.Anchor)"
            #anchor
            class="t-wrapper"
            [canOpen]="canOpenAnchor"
            [content]="anchorDropdown"
        >
            <button
                appearance="icon"
                icon="tuiIconAnchorLarge"
                size="s"
                tuiHintDescribe
                tuiHintDirection="top-left"
                tuiIconButton
                type="button"
                [focusable]="false"
                [pseudoActive]="anchor.open || jumpAnchor"
                [tuiHint]="texts.insertAnchor"
            ></button>
            <ng-template #anchorDropdown>
                <tui-edit-link
                    [anchorMode]="true"
                    (addLink)="setAnchor(anchor, $event)"
                    (removeLink)="removeAnchor()"
                ></tui-edit-link>
            </ng-template>
        </tui-hosted-dropdown>
        <ng-container *ngIf="enabled(TuiEditorTool.Attach)">
            <button
                #button
                appearance="icon"
                icon="tuiIconPaperclipLarge"
                size="s"
                tuiHintDescribe
                tuiHintDirection="top-left"
                tuiIconButton
                tuiItem
                type="button"
                class="t-tool t-tool_margin"
                [focusable]="false"
                [tuiHint]="texts.attach"
                (click)="fileUpload.click()"
            ></button>

            <input
                #fileUpload
                type="file"
                class="t-file-upload"
                [accept]="attachOptions.accept"
                [multiple]="attachOptions.multiple"
                [tuiFocusable]="false"
                (change)="onAttach(fileUpload)"
            />
        </ng-container>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Sub) || enabled(TuiEditorTool.Sup)"
        class="t-block"
    >
        <button
            *ngIf="enabled(TuiEditorTool.Sub)"
            #button
            appearance="icon"
            icon="tuiIconSubscriptLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [focusable]="false"
            [pseudoActive]="subscript"
            [tuiHint]="texts.subscript"
            (click)="toggleSubscript()"
        ></button>
        <button
            *ngIf="enabled(TuiEditorTool.Sup)"
            #button
            appearance="icon"
            icon="tuiIconSuperscriptLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [focusable]="false"
            [pseudoActive]="superscript"
            [tuiHint]="texts.superscript"
            (click)="toggleSuperscript()"
        ></button>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Color) || enabled(TuiEditorTool.Hilite)"
        class="t-block"
    >
        <tui-text-color
            *ngIf="enabled(TuiEditorTool.Color)"
            tuiItem
            class="t-tool t-wrapper"
            [colors]="colors"
        ></tui-text-color>

        <tui-highlight-color
            *ngIf="enabled(TuiEditorTool.Hilite)"
            tuiItem
            class="t-tool t-wrapper"
            [colors]="colors"
        ></tui-highlight-color>
    </div>
    <div
        *ngIf="secondBigBlockEnabled"
        class="t-block"
    >
        <tui-code
            *ngIf="enabled(TuiEditorTool.Code)"
            tuiItem
            class="t-tool t-wrapper"
        ></tui-code>

        <button
            *ngIf="enabled(TuiEditorTool.Tex)"
            #button
            appearance="icon"
            icon="tuiIconTeXLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool"
            [focusable]="false"
            [tuiHint]="texts.tex"
            (click)="onTeX()"
        ></button>
        <div
            *ngIf="enabled(TuiEditorTool.Img)"
            tuiItem
            class="t-wrapper"
        >
            <button
                #button
                appearance="icon"
                icon="tuiIconImageLarge"
                size="s"
                tuiHintDescribe
                tuiHintDirection="top-left"
                tuiIconButton
                type="button"
                class="t-tool"
                [focusable]="false"
                [tuiHint]="texts.image"
                (click)="image.click()"
            ></button>

            <input
                #image
                accept="image/*"
                type="file"
                class="t-image"
                [tuiFocusable]="false"
                (change)="onImage(image)"
            />
        </div>
        <button
            *ngIf="enabled(TuiEditorTool.HR)"
            #button
            appearance="icon"
            icon="tuiIconHrLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [focusable]="false"
            [tuiHint]="texts.insertHorizontalRule"
            (click)="insertHorizontalRule()"
        ></button>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Clear)"
        class="t-block"
    >
        <button
            #button
            appearance="icon"
            icon="tuiIconClearFormatLarge"
            size="s"
            tuiHintDescribe
            tuiHintDirection="top-left"
            tuiIconButton
            tuiItem
            type="button"
            class="t-tool t-tool_margin"
            [focusable]="false"
            [tuiHint]="texts.clear"
            (click)="removeFormat()"
        ></button>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Details)"
        class="t-block"
    >
        <tui-details
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-details>

        <tui-details-remove
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-details-remove>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Group)"
        class="t-block"
    >
        <tui-editor-group-tool
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-editor-group-tool>
        <tui-table-cell-color
            *ngIf="!enabled(TuiEditorTool.Table)"
            tuiItem
            class="t-tool t-wrapper"
            [colors]="colors"
        ></tui-table-cell-color>
    </div>
    <div
        *ngIf="enabled(TuiEditorTool.Table)"
        class="t-block"
    >
        <tui-table-create
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-table-create>

        <tui-table-row-column-manager
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-table-row-column-manager>

        <tui-table-merge-cells
            tuiItem
            class="t-tool t-tool_margin"
        ></tui-table-merge-cells>

        <tui-table-cell-color
            tuiItem
            class="t-tool t-wrapper"
            [colors]="colors"
        ></tui-table-cell-color>
    </div>
    <div class="t-block">
        <ng-content></ng-content>
    </div>
</section>
