(self.webpackChunktui_editor=self.webpackChunktui_editor||[]).push([[5681],{5681:(e,t,a)=>{a.r(t),a.d(t,{TuiDetails:()=>r,TuiDetailsContent:()=>i,TuiSummary:()=>d});var n=a(86298),s=a(48178),o=a(46309);const r=o.Node.create({name:"details",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({opened:{default:!0,keepOnSplit:!1,parseHTML:e=>"true"===e.getAttribute("data-opened"),renderHTML:e=>({"data-opened":e.opened})}}),content:"summary detailsContent",group:"block",draggable:!0,allowGapCursor:!0,isolating:!0,parseHTML:()=>[{tag:"details"}],renderHTML({HTMLAttributes:e}){return["div",{class:"t-details-wrapper t-details-wrapper_rendered"},["details",(0,o.mergeAttributes)(this.options.HTMLAttributes,{...e,open:e["data-opened"]||void 0}),0],["button",{class:"t-details-arrow"}]]},addNodeView(){return({node:e,getPos:t})=>{if(globalThis.document){const a=document.createElement("div"),s=document.createElement("details"),o=document.createElement("button"),r=document.createElement("button");a.className="t-details-wrapper",o.className="t-details-arrow",o.type="button",r.className="t-details-delete",r.type="button",s.open=e.attrs.opened;const i=t=>{s.open=!s.open,e.attrs.opened=s.open,t.target?.dispatchEvent(new CustomEvent(n.m,{bubbles:!0}))};return o.addEventListener("click",i),r.addEventListener("click",(e=>{o.removeEventListener("click",i);const a=t?.()??0;this.editor.chain().focus().setTextSelection(t?.()).run();const n=this.editor.state.selection.$anchor.nodeAfter,s=a+(n?.nodeSize??0);this.editor.isActive("summary")?this.editor.commands.deleteNode(this.type):this.editor.commands.deleteRange({from:a,to:s}),e.preventDefault()}),{capture:!0,once:!0}),a.append(s,o,r),{dom:a,contentDOM:s}}}},addCommands(){return{setDetails:()=>({commands:e,editor:t,state:a})=>{let n="";const o=this.editor.state.selection.$anchor.pos;return globalThis.document&&(n=(document.defaultView?.window.getSelection()?.toString().trim().length??0)>0?(0,s.Ap)(a):"",setTimeout((()=>t.chain().focus().setTextSelection(o).run()))),e.insertContent(`<details data-opened="true"><summary><p></p></summary><div data-type="details-content"><p>${n}</p></div></details><p></p>`)},removeDetails:()=>({editor:e,state:t,dispatch:a})=>((0,s.yU)(t,a,this.name),e.commands.focus("end"))}}}),i=o.Node.create({name:"detailsContent",content:"block+",group:"block",allowGapCursor:!0,parseHTML:()=>[{tag:'div[data-type="details-content"]'}],renderHTML({HTMLAttributes:e}){return["div",(0,o.mergeAttributes)(this.options.HTMLAttributes,e,{"data-type":"details-content"}),0]}}),d=o.Node.create({name:"summary",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph",group:"block",parseHTML:()=>[{tag:"summary"}],renderHTML({HTMLAttributes:e}){return["summary",(0,o.mergeAttributes)(this.options.HTMLAttributes,e),0]}})}}]);